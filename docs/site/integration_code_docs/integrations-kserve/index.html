
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://apidocs.zenml.io/h/integration_code_docs/integrations-kserve/">
      
      <link rel="icon" href="../../_assets/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-8.5.10">
    
    
      
        <title>Kserve - ZenML API Reference</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.975780f9.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.2505c338.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    

<script>
  !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on","addSourceMiddleware","addIntegrationMiddleware","setAnonymousId","addDestinationMiddleware"];analytics.factory=function(e){return function(){var t=Array.prototype.slice.call(arguments);t.unshift(e);analytics.push(t);return analytics}};for(var e=0;e<analytics.methods.length;e++){var key=analytics.methods[e];analytics[key]=analytics.factory(key)}analytics.load=function(key,e){var t=document.createElement("script");t.type="text/javascript";t.async=!0;t.src="https://cdn.segment.com/analytics.js/v1/" + key + "/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n);analytics._loadOptions=e};analytics._writeKey="CaE5VaNjhyaUt48qXK4rLwwKJ0PdAOFM";;analytics.SNIPPET_VERSION="4.15.3";
  analytics.load("CaE5VaNjhyaUt48qXK4rLwwKJ0PdAOFM");
  analytics.page();
  }}();
</script>
<script defer data-domain="apidocs.zenml.io" src="https://plausible.io/js/plausible.js"></script>


  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="None" data-md-color-accent="None">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#kserve" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="ZenML API Reference" class="md-header__button md-logo" aria-label="ZenML API Reference" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ZenML API Reference
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Kserve
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/zenml-io/zenml" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="ZenML API Reference" class="md-nav__button md-logo" aria-label="ZenML API Reference" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    ZenML API Reference
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/zenml-io/zenml" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        ZenML
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../cli/" class="md-nav__link">
        CLI docs
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Core code docs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Core code docs" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Core code docs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-_hub/" class="md-nav__link">
        Hub
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-alerter/" class="md-nav__link">
        Alerter
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-analytics/" class="md-nav__link">
        Analytics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-annotators/" class="md-nav__link">
        Annotators
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-api/" class="md-nav__link">
        Api
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-artifact_stores/" class="md-nav__link">
        Artifact Stores
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-client/" class="md-nav__link">
        Client
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-code_repositories/" class="md-nav__link">
        Code Repositories
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-config/" class="md-nav__link">
        Config
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-console/" class="md-nav__link">
        Console
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-constants/" class="md-nav__link">
        Constants
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-container_registries/" class="md-nav__link">
        Container Registries
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-data_validators/" class="md-nav__link">
        Data Validators
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-entrypoints/" class="md-nav__link">
        Entrypoints
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-enums/" class="md-nav__link">
        Enums
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-environment/" class="md-nav__link">
        Environment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-exceptions/" class="md-nav__link">
        Exceptions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-experiment_trackers/" class="md-nav__link">
        Experiment Trackers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-feature_stores/" class="md-nav__link">
        Feature Stores
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-hooks/" class="md-nav__link">
        Hooks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-image_builders/" class="md-nav__link">
        Image Builders
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-io/" class="md-nav__link">
        Io
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-logger/" class="md-nav__link">
        Logger
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-materializers/" class="md-nav__link">
        Materializers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-metadata/" class="md-nav__link">
        Metadata
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-model_deployers/" class="md-nav__link">
        Model Deployers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-model_registries/" class="md-nav__link">
        Model Registries
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-models/" class="md-nav__link">
        Models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-new/" class="md-nav__link">
        New
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-orchestrators/" class="md-nav__link">
        Orchestrators
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-pipelines/" class="md-nav__link">
        Pipelines
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-post_execution/" class="md-nav__link">
        Post Execution
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-recipes/" class="md-nav__link">
        Recipes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-secret/" class="md-nav__link">
        Secret
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-secrets_managers/" class="md-nav__link">
        Secrets Managers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-service_connectors/" class="md-nav__link">
        Service Connectors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-services/" class="md-nav__link">
        Services
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-stack/" class="md-nav__link">
        Stack
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-step_operators/" class="md-nav__link">
        Step Operators
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-steps/" class="md-nav__link">
        Steps
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-types/" class="md-nav__link">
        Types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-utils/" class="md-nav__link">
        Utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-zen_server/" class="md-nav__link">
        Zen Server
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core_code_docs/core-zen_stores/" class="md-nav__link">
        Zen Stores
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Integration code docs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Integration code docs" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Integration code docs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-airflow/" class="md-nav__link">
        Airflow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-aws/" class="md-nav__link">
        Aws
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-azure/" class="md-nav__link">
        Azure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-bentoml/" class="md-nav__link">
        Bentoml
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-constants/" class="md-nav__link">
        Constants
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-deepchecks/" class="md-nav__link">
        Deepchecks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-evidently/" class="md-nav__link">
        Evidently
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-facets/" class="md-nav__link">
        Facets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-feast/" class="md-nav__link">
        Feast
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-gcp/" class="md-nav__link">
        Gcp
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-github/" class="md-nav__link">
        Github
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-gitlab/" class="md-nav__link">
        Gitlab
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-great_expectations/" class="md-nav__link">
        Great Expectations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-huggingface/" class="md-nav__link">
        Huggingface
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-integration/" class="md-nav__link">
        Integration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-kaniko/" class="md-nav__link">
        Kaniko
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Kserve
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Kserve
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#zenml.integrations.kserve" class="md-nav__link">
    kserve
  </a>
  
    <nav class="md-nav" aria-label="kserve">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.KServeIntegration" class="md-nav__link">
    KServeIntegration
  </a>
  
    <nav class="md-nav" aria-label="KServeIntegration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.KServeIntegration.activate" class="md-nav__link">
    activate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.KServeIntegration.flavors" class="md-nav__link">
    flavors()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.constants" class="md-nav__link">
    constants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.custom_deployer" class="md-nav__link">
    custom_deployer
  </a>
  
    <nav class="md-nav" aria-label="custom_deployer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.custom_deployer.zenml_custom_model" class="md-nav__link">
    zenml_custom_model
  </a>
  
    <nav class="md-nav" aria-label="zenml_custom_model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.custom_deployer.zenml_custom_model.ZenMLCustomModel" class="md-nav__link">
    ZenMLCustomModel
  </a>
  
    <nav class="md-nav" aria-label="ZenMLCustomModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.custom_deployer.zenml_custom_model.ZenMLCustomModel.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.custom_deployer.zenml_custom_model.ZenMLCustomModel.load" class="md-nav__link">
    load()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.custom_deployer.zenml_custom_model.ZenMLCustomModel.predict" class="md-nav__link">
    predict()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.flavors" class="md-nav__link">
    flavors
  </a>
  
    <nav class="md-nav" aria-label="flavors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.flavors.kserve_model_deployer_flavor" class="md-nav__link">
    kserve_model_deployer_flavor
  </a>
  
    <nav class="md-nav" aria-label="kserve_model_deployer_flavor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.flavors.kserve_model_deployer_flavor.KServeModelDeployerConfig" class="md-nav__link">
    KServeModelDeployerConfig
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.flavors.kserve_model_deployer_flavor.KServeModelDeployerFlavor" class="md-nav__link">
    KServeModelDeployerFlavor
  </a>
  
    <nav class="md-nav" aria-label="KServeModelDeployerFlavor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.flavors.kserve_model_deployer_flavor.KServeModelDeployerFlavor.config_class" class="md-nav__link">
    config_class
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.flavors.kserve_model_deployer_flavor.KServeModelDeployerFlavor.docs_url" class="md-nav__link">
    docs_url
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.flavors.kserve_model_deployer_flavor.KServeModelDeployerFlavor.implementation_class" class="md-nav__link">
    implementation_class
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.flavors.kserve_model_deployer_flavor.KServeModelDeployerFlavor.logo_url" class="md-nav__link">
    logo_url
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.flavors.kserve_model_deployer_flavor.KServeModelDeployerFlavor.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.flavors.kserve_model_deployer_flavor.KServeModelDeployerFlavor.sdk_docs_url" class="md-nav__link">
    sdk_docs_url
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.flavors.kserve_model_deployer_flavor.KServeModelDeployerFlavor.service_connector_requirements" class="md-nav__link">
    service_connector_requirements
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers" class="md-nav__link">
    model_deployers
  </a>
  
    <nav class="md-nav" aria-label="model_deployers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer" class="md-nav__link">
    kserve_model_deployer
  </a>
  
    <nav class="md-nav" aria-label="kserve_model_deployer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer" class="md-nav__link">
    KServeModelDeployer
  </a>
  
    <nav class="md-nav" aria-label="KServeModelDeployer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.config" class="md-nav__link">
    config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.kserve_client" class="md-nav__link">
    kserve_client
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.validator" class="md-nav__link">
    validator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.FLAVOR" class="md-nav__link">
    FLAVOR
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.create_or_update_k8s_secret" class="md-nav__link">
    create_or_update_k8s_secret()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.create_or_update_k8s_service_account" class="md-nav__link">
    create_or_update_k8s_service_account()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.delete_k8s_secret" class="md-nav__link">
    delete_k8s_secret()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.delete_k8s_service_account" class="md-nav__link">
    delete_k8s_service_account()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.delete_model_server" class="md-nav__link">
    delete_model_server()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.deploy_model" class="md-nav__link">
    deploy_model()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.find_model_server" class="md-nav__link">
    find_model_server()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.get_docker_builds" class="md-nav__link">
    get_docker_builds()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.get_kserve_deployments" class="md-nav__link">
    get_kserve_deployments()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.get_model_server_info" class="md-nav__link">
    get_model_server_info()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.start_model_server" class="md-nav__link">
    start_model_server()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.stop_model_server" class="md-nav__link">
    stop_model_server()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KubeClientKServeClient" class="md-nav__link">
    KubeClientKServeClient
  </a>
  
    <nav class="md-nav" aria-label="KubeClientKServeClient">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KubeClientKServeClient.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.secret_schemas" class="md-nav__link">
    secret_schemas
  </a>
  
    <nav class="md-nav" aria-label="secret_schemas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.secret_schemas.secret_schemas" class="md-nav__link">
    secret_schemas
  </a>
  
    <nav class="md-nav" aria-label="secret_schemas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.secret_schemas.secret_schemas.KServeAzureSecretSchema" class="md-nav__link">
    KServeAzureSecretSchema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.secret_schemas.secret_schemas.KServeGSSecretSchema" class="md-nav__link">
    KServeGSSecretSchema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.secret_schemas.secret_schemas.KServeS3SecretSchema" class="md-nav__link">
    KServeS3SecretSchema
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.services" class="md-nav__link">
    services
  </a>
  
    <nav class="md-nav" aria-label="services">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.services.kserve_deployment" class="md-nav__link">
    kserve_deployment
  </a>
  
    <nav class="md-nav" aria-label="kserve_deployment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentConfig" class="md-nav__link">
    KServeDeploymentConfig
  </a>
  
    <nav class="md-nav" aria-label="KServeDeploymentConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentConfig.create_from_deployment" class="md-nav__link">
    create_from_deployment()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentConfig.get_kubernetes_annotations" class="md-nav__link">
    get_kubernetes_annotations()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentConfig.get_kubernetes_labels" class="md-nav__link">
    get_kubernetes_labels()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentConfig.sanitize_labels" class="md-nav__link">
    sanitize_labels()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentService" class="md-nav__link">
    KServeDeploymentService
  </a>
  
    <nav class="md-nav" aria-label="KServeDeploymentService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentService.crd_name" class="md-nav__link">
    crd_name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentService.prediction_hostname" class="md-nav__link">
    prediction_hostname
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentService.prediction_url" class="md-nav__link">
    prediction_url
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentService.check_status" class="md-nav__link">
    check_status()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentService.create_from_deployment" class="md-nav__link">
    create_from_deployment()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentService.deprovision" class="md-nav__link">
    deprovision()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentService.get_logs" class="md-nav__link">
    get_logs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentService.predict" class="md-nav__link">
    predict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentService.provision" class="md-nav__link">
    provision()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps" class="md-nav__link">
    steps
  </a>
  
    <nav class="md-nav" aria-label="steps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_deployer" class="md-nav__link">
    kserve_deployer
  </a>
  
    <nav class="md-nav" aria-label="kserve_deployer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_deployer.CustomDeployParameters" class="md-nav__link">
    CustomDeployParameters
  </a>
  
    <nav class="md-nav" aria-label="CustomDeployParameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_deployer.CustomDeployParameters.predict_function_validate" class="md-nav__link">
    predict_function_validate()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_deployer.KServeDeployerStepParameters" class="md-nav__link">
    KServeDeployerStepParameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_deployer.TorchServeParameters" class="md-nav__link">
    TorchServeParameters
  </a>
  
    <nav class="md-nav" aria-label="TorchServeParameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_deployer.TorchServeParameters.extra_files_validate" class="md-nav__link">
    extra_files_validate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_deployer.TorchServeParameters.handler_validate" class="md-nav__link">
    handler_validate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_deployer.TorchServeParameters.model_class_validate" class="md-nav__link">
    model_class_validate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_deployer.TorchServeParameters.torch_config_validate" class="md-nav__link">
    torch_config_validate()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_deployer.kserve_custom_model_deployer_step" class="md-nav__link">
    kserve_custom_model_deployer_step
  </a>
  
    <nav class="md-nav" aria-label="kserve_custom_model_deployer_step">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_deployer.kserve_custom_model_deployer_step.entrypoint" class="md-nav__link">
    entrypoint()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_deployer.kserve_model_deployer_step" class="md-nav__link">
    kserve_model_deployer_step
  </a>
  
    <nav class="md-nav" aria-label="kserve_model_deployer_step">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_deployer.kserve_model_deployer_step.entrypoint" class="md-nav__link">
    entrypoint()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_step_utils" class="md-nav__link">
    kserve_step_utils
  </a>
  
    <nav class="md-nav" aria-label="kserve_step_utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_step_utils.TorchModelArchiver" class="md-nav__link">
    TorchModelArchiver
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_step_utils.generate_model_deployer_config" class="md-nav__link">
    generate_model_deployer_config()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_step_utils.is_valid_model_name" class="md-nav__link">
    is_valid_model_name()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_step_utils.prepare_service_config" class="md-nav__link">
    prepare_service_config()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_step_utils.prepare_torch_service_config" class="md-nav__link">
    prepare_torch_service_config()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-kubeflow/" class="md-nav__link">
        Kubeflow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-kubernetes/" class="md-nav__link">
        Kubernetes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-label_studio/" class="md-nav__link">
        Label Studio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-langchain/" class="md-nav__link">
        Langchain
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-lightgbm/" class="md-nav__link">
        Lightgbm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-llama_index/" class="md-nav__link">
        Llama Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-mlflow/" class="md-nav__link">
        Mlflow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-neptune/" class="md-nav__link">
        Neptune
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-neural_prophet/" class="md-nav__link">
        Neural Prophet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-openai/" class="md-nav__link">
        Openai
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-pillow/" class="md-nav__link">
        Pillow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-pycaret/" class="md-nav__link">
        Pycaret
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-pytorch/" class="md-nav__link">
        Pytorch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-pytorch_lightning/" class="md-nav__link">
        Pytorch Lightning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-registry/" class="md-nav__link">
        Registry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-s3/" class="md-nav__link">
        S3
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-scipy/" class="md-nav__link">
        Scipy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-seldon/" class="md-nav__link">
        Seldon
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-sklearn/" class="md-nav__link">
        Sklearn
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-slack/" class="md-nav__link">
        Slack
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-spark/" class="md-nav__link">
        Spark
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-tekton/" class="md-nav__link">
        Tekton
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-tensorboard/" class="md-nav__link">
        Tensorboard
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-tensorflow/" class="md-nav__link">
        Tensorflow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-utils/" class="md-nav__link">
        Utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-vault/" class="md-nav__link">
        Vault
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-wandb/" class="md-nav__link">
        Wandb
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-whylogs/" class="md-nav__link">
        Whylogs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../integrations-xgboost/" class="md-nav__link">
        Xgboost
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#zenml.integrations.kserve" class="md-nav__link">
    kserve
  </a>
  
    <nav class="md-nav" aria-label="kserve">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.KServeIntegration" class="md-nav__link">
    KServeIntegration
  </a>
  
    <nav class="md-nav" aria-label="KServeIntegration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.KServeIntegration.activate" class="md-nav__link">
    activate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.KServeIntegration.flavors" class="md-nav__link">
    flavors()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.constants" class="md-nav__link">
    constants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.custom_deployer" class="md-nav__link">
    custom_deployer
  </a>
  
    <nav class="md-nav" aria-label="custom_deployer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.custom_deployer.zenml_custom_model" class="md-nav__link">
    zenml_custom_model
  </a>
  
    <nav class="md-nav" aria-label="zenml_custom_model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.custom_deployer.zenml_custom_model.ZenMLCustomModel" class="md-nav__link">
    ZenMLCustomModel
  </a>
  
    <nav class="md-nav" aria-label="ZenMLCustomModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.custom_deployer.zenml_custom_model.ZenMLCustomModel.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.custom_deployer.zenml_custom_model.ZenMLCustomModel.load" class="md-nav__link">
    load()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.custom_deployer.zenml_custom_model.ZenMLCustomModel.predict" class="md-nav__link">
    predict()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.flavors" class="md-nav__link">
    flavors
  </a>
  
    <nav class="md-nav" aria-label="flavors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.flavors.kserve_model_deployer_flavor" class="md-nav__link">
    kserve_model_deployer_flavor
  </a>
  
    <nav class="md-nav" aria-label="kserve_model_deployer_flavor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.flavors.kserve_model_deployer_flavor.KServeModelDeployerConfig" class="md-nav__link">
    KServeModelDeployerConfig
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.flavors.kserve_model_deployer_flavor.KServeModelDeployerFlavor" class="md-nav__link">
    KServeModelDeployerFlavor
  </a>
  
    <nav class="md-nav" aria-label="KServeModelDeployerFlavor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.flavors.kserve_model_deployer_flavor.KServeModelDeployerFlavor.config_class" class="md-nav__link">
    config_class
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.flavors.kserve_model_deployer_flavor.KServeModelDeployerFlavor.docs_url" class="md-nav__link">
    docs_url
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.flavors.kserve_model_deployer_flavor.KServeModelDeployerFlavor.implementation_class" class="md-nav__link">
    implementation_class
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.flavors.kserve_model_deployer_flavor.KServeModelDeployerFlavor.logo_url" class="md-nav__link">
    logo_url
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.flavors.kserve_model_deployer_flavor.KServeModelDeployerFlavor.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.flavors.kserve_model_deployer_flavor.KServeModelDeployerFlavor.sdk_docs_url" class="md-nav__link">
    sdk_docs_url
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.flavors.kserve_model_deployer_flavor.KServeModelDeployerFlavor.service_connector_requirements" class="md-nav__link">
    service_connector_requirements
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers" class="md-nav__link">
    model_deployers
  </a>
  
    <nav class="md-nav" aria-label="model_deployers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer" class="md-nav__link">
    kserve_model_deployer
  </a>
  
    <nav class="md-nav" aria-label="kserve_model_deployer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer" class="md-nav__link">
    KServeModelDeployer
  </a>
  
    <nav class="md-nav" aria-label="KServeModelDeployer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.config" class="md-nav__link">
    config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.kserve_client" class="md-nav__link">
    kserve_client
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.validator" class="md-nav__link">
    validator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.FLAVOR" class="md-nav__link">
    FLAVOR
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.create_or_update_k8s_secret" class="md-nav__link">
    create_or_update_k8s_secret()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.create_or_update_k8s_service_account" class="md-nav__link">
    create_or_update_k8s_service_account()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.delete_k8s_secret" class="md-nav__link">
    delete_k8s_secret()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.delete_k8s_service_account" class="md-nav__link">
    delete_k8s_service_account()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.delete_model_server" class="md-nav__link">
    delete_model_server()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.deploy_model" class="md-nav__link">
    deploy_model()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.find_model_server" class="md-nav__link">
    find_model_server()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.get_docker_builds" class="md-nav__link">
    get_docker_builds()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.get_kserve_deployments" class="md-nav__link">
    get_kserve_deployments()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.get_model_server_info" class="md-nav__link">
    get_model_server_info()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.start_model_server" class="md-nav__link">
    start_model_server()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.stop_model_server" class="md-nav__link">
    stop_model_server()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KubeClientKServeClient" class="md-nav__link">
    KubeClientKServeClient
  </a>
  
    <nav class="md-nav" aria-label="KubeClientKServeClient">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.model_deployers.kserve_model_deployer.KubeClientKServeClient.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.secret_schemas" class="md-nav__link">
    secret_schemas
  </a>
  
    <nav class="md-nav" aria-label="secret_schemas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.secret_schemas.secret_schemas" class="md-nav__link">
    secret_schemas
  </a>
  
    <nav class="md-nav" aria-label="secret_schemas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.secret_schemas.secret_schemas.KServeAzureSecretSchema" class="md-nav__link">
    KServeAzureSecretSchema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.secret_schemas.secret_schemas.KServeGSSecretSchema" class="md-nav__link">
    KServeGSSecretSchema
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.secret_schemas.secret_schemas.KServeS3SecretSchema" class="md-nav__link">
    KServeS3SecretSchema
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.services" class="md-nav__link">
    services
  </a>
  
    <nav class="md-nav" aria-label="services">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.services.kserve_deployment" class="md-nav__link">
    kserve_deployment
  </a>
  
    <nav class="md-nav" aria-label="kserve_deployment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentConfig" class="md-nav__link">
    KServeDeploymentConfig
  </a>
  
    <nav class="md-nav" aria-label="KServeDeploymentConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentConfig.create_from_deployment" class="md-nav__link">
    create_from_deployment()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentConfig.get_kubernetes_annotations" class="md-nav__link">
    get_kubernetes_annotations()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentConfig.get_kubernetes_labels" class="md-nav__link">
    get_kubernetes_labels()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentConfig.sanitize_labels" class="md-nav__link">
    sanitize_labels()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentService" class="md-nav__link">
    KServeDeploymentService
  </a>
  
    <nav class="md-nav" aria-label="KServeDeploymentService">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentService.crd_name" class="md-nav__link">
    crd_name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentService.prediction_hostname" class="md-nav__link">
    prediction_hostname
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentService.prediction_url" class="md-nav__link">
    prediction_url
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentService.check_status" class="md-nav__link">
    check_status()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentService.create_from_deployment" class="md-nav__link">
    create_from_deployment()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentService.deprovision" class="md-nav__link">
    deprovision()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentService.get_logs" class="md-nav__link">
    get_logs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentService.predict" class="md-nav__link">
    predict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentService.provision" class="md-nav__link">
    provision()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps" class="md-nav__link">
    steps
  </a>
  
    <nav class="md-nav" aria-label="steps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_deployer" class="md-nav__link">
    kserve_deployer
  </a>
  
    <nav class="md-nav" aria-label="kserve_deployer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_deployer.CustomDeployParameters" class="md-nav__link">
    CustomDeployParameters
  </a>
  
    <nav class="md-nav" aria-label="CustomDeployParameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_deployer.CustomDeployParameters.predict_function_validate" class="md-nav__link">
    predict_function_validate()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_deployer.KServeDeployerStepParameters" class="md-nav__link">
    KServeDeployerStepParameters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_deployer.TorchServeParameters" class="md-nav__link">
    TorchServeParameters
  </a>
  
    <nav class="md-nav" aria-label="TorchServeParameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_deployer.TorchServeParameters.extra_files_validate" class="md-nav__link">
    extra_files_validate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_deployer.TorchServeParameters.handler_validate" class="md-nav__link">
    handler_validate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_deployer.TorchServeParameters.model_class_validate" class="md-nav__link">
    model_class_validate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_deployer.TorchServeParameters.torch_config_validate" class="md-nav__link">
    torch_config_validate()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_deployer.kserve_custom_model_deployer_step" class="md-nav__link">
    kserve_custom_model_deployer_step
  </a>
  
    <nav class="md-nav" aria-label="kserve_custom_model_deployer_step">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_deployer.kserve_custom_model_deployer_step.entrypoint" class="md-nav__link">
    entrypoint()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_deployer.kserve_model_deployer_step" class="md-nav__link">
    kserve_model_deployer_step
  </a>
  
    <nav class="md-nav" aria-label="kserve_model_deployer_step">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_deployer.kserve_model_deployer_step.entrypoint" class="md-nav__link">
    entrypoint()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_step_utils" class="md-nav__link">
    kserve_step_utils
  </a>
  
    <nav class="md-nav" aria-label="kserve_step_utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_step_utils.TorchModelArchiver" class="md-nav__link">
    TorchModelArchiver
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_step_utils.generate_model_deployer_config" class="md-nav__link">
    generate_model_deployer_config()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_step_utils.is_valid_model_name" class="md-nav__link">
    is_valid_model_name()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_step_utils.prepare_service_config" class="md-nav__link">
    prepare_service_config()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zenml.integrations.kserve.steps.kserve_step_utils.prepare_torch_service_config" class="md-nav__link">
    prepare_torch_service_config()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/zenml-io/zenml/docs/integration_code_docs/integrations-kserve.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


<h1 id="kserve">Kserve</h1>


  <div class="doc doc-object doc-module">



<h2 id="zenml.integrations.kserve" class="doc doc-heading">
        <code>zenml.integrations.kserve</code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h2>

    <div class="doc doc-contents first">

      <p>Initialization of the KServe integration for ZenML.</p>
<p>The KServe integration allows you to use the KServe model serving
platform to implement continuous model deployment.</p>



  <div class="doc doc-children">








  <div class="doc doc-object doc-class">



<h3 id="zenml.integrations.kserve.KServeIntegration" class="doc doc-heading">
        <code>
KServeIntegration            (<a class="autorefs autorefs-internal" title="zenml.integrations.integration.Integration" href="../integrations-integration/#zenml.integrations.integration.Integration">Integration</a>)
        </code>



</h3>

    <div class="doc doc-contents ">

      <p>Definition of KServe integration for ZenML.</p>

        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">KServeIntegration</span><span class="p">(</span><span class="n">Integration</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Definition of KServe integration for ZenML.&quot;&quot;&quot;</span>

    <span class="n">NAME</span> <span class="o">=</span> <span class="n">KSERVE</span>
    <span class="n">REQUIREMENTS</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;kserve&gt;=0.9.0,&lt;=10&quot;</span><span class="p">,</span>
        <span class="s2">&quot;torch-model-archiver&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">activate</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Activate the Seldon Core integration.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">zenml.integrations.kserve</span> <span class="kn">import</span> <span class="n">model_deployers</span>  <span class="c1"># noqa</span>
        <span class="kn">from</span> <span class="nn">zenml.integrations.kserve</span> <span class="kn">import</span> <span class="n">secret_schemas</span>  <span class="c1"># noqa</span>
        <span class="kn">from</span> <span class="nn">zenml.integrations.kserve</span> <span class="kn">import</span> <span class="n">services</span>  <span class="c1"># noqa</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">flavors</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">Flavor</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Declare the stack component flavors for KServe.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of stack component flavors for this integration.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">zenml.integrations.kserve.flavors</span> <span class="kn">import</span> <span class="n">KServeModelDeployerFlavor</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">KServeModelDeployerFlavor</span><span class="p">]</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">











  <div class="doc doc-object doc-method">



<h4 id="zenml.integrations.kserve.KServeIntegration.activate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">activate</span><span class="p">()</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h4>

    <div class="doc doc-contents ">

      <p>Activate the Seldon Core integration.</p>

        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">activate</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Activate the Seldon Core integration.&quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">zenml.integrations.kserve</span> <span class="kn">import</span> <span class="n">model_deployers</span>  <span class="c1"># noqa</span>
    <span class="kn">from</span> <span class="nn">zenml.integrations.kserve</span> <span class="kn">import</span> <span class="n">secret_schemas</span>  <span class="c1"># noqa</span>
    <span class="kn">from</span> <span class="nn">zenml.integrations.kserve</span> <span class="kn">import</span> <span class="n">services</span>  <span class="c1"># noqa</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="zenml.integrations.kserve.KServeIntegration.flavors" class="doc doc-heading">
<code class="highlight language-python"><span class="n">flavors</span><span class="p">()</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h4>

    <div class="doc doc-contents ">

      <p>Declare the stack component flavors for KServe.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[Type[zenml.stack.flavor.Flavor]]</code></td>
      <td><p>List of stack component flavors for this integration.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/__init__.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">flavors</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">Flavor</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Declare the stack component flavors for KServe.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of stack component flavors for this integration.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">zenml.integrations.kserve.flavors</span> <span class="kn">import</span> <span class="n">KServeModelDeployerFlavor</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">KServeModelDeployerFlavor</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>






  <div class="doc doc-object doc-module">



<h3 id="zenml.integrations.kserve.constants" class="doc doc-heading">
        <code>constants</code>



</h3>

    <div class="doc doc-contents ">

      <p>KServe constants.</p>



  <div class="doc doc-children">













  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="zenml.integrations.kserve.custom_deployer" class="doc doc-heading">
        <code>custom_deployer</code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Initialization of ZenML custom deployer.</p>



  <div class="doc doc-children">










  <div class="doc doc-object doc-module">



<h4 id="zenml.integrations.kserve.custom_deployer.zenml_custom_model" class="doc doc-heading">
        <code>zenml_custom_model</code>



</h4>

    <div class="doc doc-contents ">

      <p>Implements a custom model for the Kserve integration.</p>



  <div class="doc doc-children">










  <div class="doc doc-object doc-class">



<h5 id="zenml.integrations.kserve.custom_deployer.zenml_custom_model.ZenMLCustomModel" class="doc doc-heading">
        <code>
ZenMLCustomModel            (<span title="kserve.model.Model">Model</span>)
        </code>



</h5>

    <div class="doc doc-contents ">

      <p>Custom model class for ZenML and Kserve.</p>
<p>This class is used to implement a custom model for the Kserve integration,
which is used as the main entry point for custom code execution.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>model_name</code></td>
        <td></td>
        <td><p>The name of the model.</p></td>
      </tr>
      <tr>
        <td><code>model_uri</code></td>
        <td></td>
        <td><p>The URI of the model.</p></td>
      </tr>
      <tr>
        <td><code>predict_func</code></td>
        <td></td>
        <td><p>The predict function of the model.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/custom_deployer/zenml_custom_model.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">ZenMLCustomModel</span><span class="p">(</span><span class="n">kserve</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>  <span class="c1"># type: ignore[misc]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Custom model class for ZenML and Kserve.</span>

<span class="sd">    This class is used to implement a custom model for the Kserve integration,</span>
<span class="sd">    which is used as the main entry point for custom code execution.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        model_name: The name of the model.</span>
<span class="sd">        model_uri: The URI of the model.</span>
<span class="sd">        predict_func: The predict function of the model.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">model_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">predict_func</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes a ZenMLCustomModel object.</span>

<span class="sd">        Args:</span>
<span class="sd">            model_name: The name of the model.</span>
<span class="sd">            model_uri: The URI of the model.</span>
<span class="sd">            predict_func: The predict function of the model.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">model_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_uri</span> <span class="o">=</span> <span class="n">model_uri</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">predict_func</span> <span class="o">=</span> <span class="n">source_utils</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">predict_func</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ready</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load the model.</span>

<span class="sd">        This function loads the model into memory and sets the ready flag to True.</span>

<span class="sd">        The model is loaded using the materializer, by saving the information of</span>
<span class="sd">        the artifact to a YAML file in the same path as the model artifacts at</span>
<span class="sd">        the preparing time and loading it again at the prediction time by</span>
<span class="sd">        the materializer.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if the model was loaded successfully, False otherwise.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">zenml.utils.artifact_utils</span> <span class="kn">import</span> <span class="n">load_model_from_metadata</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">load_model_from_metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_uri</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to load model: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ready</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ready</span>

    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict the given request.</span>

<span class="sd">        The main predict function of the model. This function is called by the</span>
<span class="sd">        KServe server when a request is received. Then inside this function,</span>
<span class="sd">        the user-defined predict function is called.</span>

<span class="sd">        Args:</span>
<span class="sd">            request: The request to predict in a dictionary. e.g. {&quot;instances&quot;: []}</span>

<span class="sd">        Returns:</span>
<span class="sd">            The prediction dictionary.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: If function could not be called.</span>
<span class="sd">            NotImplementedError: If the model is not ready.</span>
<span class="sd">            TypeError: If the request is not a dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">prediction</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;predictions&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_func</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">request</span><span class="p">[</span><span class="s2">&quot;instances&quot;</span><span class="p">]</span>
                    <span class="p">)</span>
                <span class="p">}</span>
            <span class="k">except</span> <span class="ne">RuntimeError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Failed to predict: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prediction</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">prediction</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Prediction is not a dictionary. Expecting a dictionary but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Predict function is not implemented&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.kserve.custom_deployer.zenml_custom_model.ZenMLCustomModel.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">model_uri</span><span class="p">,</span> <span class="n">predict_func</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Initializes a ZenMLCustomModel object.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>model_name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the model.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>model_uri</code></td>
        <td><code>str</code></td>
        <td><p>The URI of the model.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>predict_func</code></td>
        <td><code>str</code></td>
        <td><p>The predict function of the model.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/custom_deployer/zenml_custom_model.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">model_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">predict_func</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes a ZenMLCustomModel object.</span>

<span class="sd">    Args:</span>
<span class="sd">        model_name: The name of the model.</span>
<span class="sd">        model_uri: The URI of the model.</span>
<span class="sd">        predict_func: The predict function of the model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">model_name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">model_uri</span> <span class="o">=</span> <span class="n">model_uri</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">predict_func</span> <span class="o">=</span> <span class="n">source_utils</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">predict_func</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ready</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.kserve.custom_deployer.zenml_custom_model.ZenMLCustomModel.load" class="doc doc-heading">
<code class="highlight language-python"><span class="n">load</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Load the model.</p>
<p>This function loads the model into memory and sets the ready flag to True.</p>
<p>The model is loaded using the materializer, by saving the information of
the artifact to a YAML file in the same path as the model artifacts at
the preparing time and loading it again at the prediction time by
the materializer.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>bool</code></td>
      <td><p>True if the model was loaded successfully, False otherwise.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/custom_deployer/zenml_custom_model.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load the model.</span>

<span class="sd">    This function loads the model into memory and sets the ready flag to True.</span>

<span class="sd">    The model is loaded using the materializer, by saving the information of</span>
<span class="sd">    the artifact to a YAML file in the same path as the model artifacts at</span>
<span class="sd">    the preparing time and loading it again at the prediction time by</span>
<span class="sd">    the materializer.</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if the model was loaded successfully, False otherwise.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">zenml.utils.artifact_utils</span> <span class="kn">import</span> <span class="n">load_model_from_metadata</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">load_model_from_metadata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_uri</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Failed to load model: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ready</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ready</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.kserve.custom_deployer.zenml_custom_model.ZenMLCustomModel.predict" class="doc doc-heading">
<code class="highlight language-python"><span class="n">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Predict the given request.</p>
<p>The main predict function of the model. This function is called by the
KServe server when a request is received. Then inside this function,
the user-defined predict function is called.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>request</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>The request to predict in a dictionary. e.g. {"instances": []}</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Dict[str, Any]</code></td>
      <td><p>The prediction dictionary.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>RuntimeError</code></td>
        <td><p>If function could not be called.</p></td>
      </tr>
      <tr>
        <td><code>NotImplementedError</code></td>
        <td><p>If the model is not ready.</p></td>
      </tr>
      <tr>
        <td><code>TypeError</code></td>
        <td><p>If the request is not a dictionary.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/custom_deployer/zenml_custom_model.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Predict the given request.</span>

<span class="sd">    The main predict function of the model. This function is called by the</span>
<span class="sd">    KServe server when a request is received. Then inside this function,</span>
<span class="sd">    the user-defined predict function is called.</span>

<span class="sd">    Args:</span>
<span class="sd">        request: The request to predict in a dictionary. e.g. {&quot;instances&quot;: []}</span>

<span class="sd">    Returns:</span>
<span class="sd">        The prediction dictionary.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: If function could not be called.</span>
<span class="sd">        NotImplementedError: If the model is not ready.</span>
<span class="sd">        TypeError: If the request is not a dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">prediction</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;predictions&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_func</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">request</span><span class="p">[</span><span class="s2">&quot;instances&quot;</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="k">except</span> <span class="ne">RuntimeError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Failed to predict: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prediction</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">prediction</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Prediction is not a dictionary. Expecting a dictionary but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Predict function is not implemented&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>







  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="zenml.integrations.kserve.flavors" class="doc doc-heading">
        <code>flavors</code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>KServe integration flavors.</p>



  <div class="doc doc-children">











  <div class="doc doc-object doc-module">



<h4 id="zenml.integrations.kserve.flavors.kserve_model_deployer_flavor" class="doc doc-heading">
        <code>kserve_model_deployer_flavor</code>



</h4>

    <div class="doc doc-contents ">

      <p>KServe model deployer flavor.</p>



  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h5 id="zenml.integrations.kserve.flavors.kserve_model_deployer_flavor.KServeModelDeployerConfig" class="doc doc-heading">
        <code>
KServeModelDeployerConfig            (<a class="autorefs autorefs-internal" title="zenml.model_deployers.base_model_deployer.BaseModelDeployerConfig" href="../../core_code_docs/core-model_deployers/#zenml.model_deployers.base_model_deployer.BaseModelDeployerConfig">BaseModelDeployerConfig</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-model"><code>pydantic-model</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Configuration for the KServeModelDeployer.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>kubernetes_context</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>the Kubernetes context to use to contact the remote
KServe installation. If not specified, the current
configuration is used. Depending on where the KServe model deployer
is being used, this can be either a locally active context or an
in-cluster Kubernetes configuration (if running inside a pod).
If the model deployer stack component is linked to a Kubernetes
service connector, this field is ignored.</p></td>
      </tr>
      <tr>
        <td><code>kubernetes_namespace</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>the Kubernetes namespace where the KServe
inference service CRDs are provisioned and managed by ZenML. If not
specified, the namespace set in the current configuration is used.
Depending on where the KServe model deployer is being used, this can
be either the current namespace configured in the locally active
context or the namespace in the context of which the pod is running
(if running inside a pod).</p></td>
      </tr>
      <tr>
        <td><code>base_url</code></td>
        <td><code>str</code></td>
        <td><p>the base URL of the Kubernetes ingress used to expose the
KServe inference services.</p></td>
      </tr>
      <tr>
        <td><code>secret</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>the name of the secret containing the credentials for the
KServe inference services.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/flavors/kserve_model_deployer_flavor.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">KServeModelDeployerConfig</span><span class="p">(</span><span class="n">BaseModelDeployerConfig</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configuration for the KServeModelDeployer.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        kubernetes_context: the Kubernetes context to use to contact the remote</span>
<span class="sd">            KServe installation. If not specified, the current</span>
<span class="sd">            configuration is used. Depending on where the KServe model deployer</span>
<span class="sd">            is being used, this can be either a locally active context or an</span>
<span class="sd">            in-cluster Kubernetes configuration (if running inside a pod).</span>
<span class="sd">            If the model deployer stack component is linked to a Kubernetes</span>
<span class="sd">            service connector, this field is ignored.</span>
<span class="sd">        kubernetes_namespace: the Kubernetes namespace where the KServe</span>
<span class="sd">            inference service CRDs are provisioned and managed by ZenML. If not</span>
<span class="sd">            specified, the namespace set in the current configuration is used.</span>
<span class="sd">            Depending on where the KServe model deployer is being used, this can</span>
<span class="sd">            be either the current namespace configured in the locally active</span>
<span class="sd">            context or the namespace in the context of which the pod is running</span>
<span class="sd">            (if running inside a pod).</span>
<span class="sd">        base_url: the base URL of the Kubernetes ingress used to expose the</span>
<span class="sd">            KServe inference services.</span>
<span class="sd">        secret: the name of the secret containing the credentials for the</span>
<span class="sd">            KServe inference services.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">kubernetes_context</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">kubernetes_namespace</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">base_url</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># TODO: unused?</span>
    <span class="n">secret</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">custom_domain</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>  <span class="c1"># TODO: unused?</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">



















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="zenml.integrations.kserve.flavors.kserve_model_deployer_flavor.KServeModelDeployerFlavor" class="doc doc-heading">
        <code>
KServeModelDeployerFlavor            (<a class="autorefs autorefs-internal" title="zenml.model_deployers.base_model_deployer.BaseModelDeployerFlavor" href="../../core_code_docs/core-model_deployers/#zenml.model_deployers.base_model_deployer.BaseModelDeployerFlavor">BaseModelDeployerFlavor</a>)
        </code>



</h5>

    <div class="doc doc-contents ">

      <p>Flavor for the KServe model deployer.</p>

        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/flavors/kserve_model_deployer_flavor.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">KServeModelDeployerFlavor</span><span class="p">(</span><span class="n">BaseModelDeployerFlavor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Flavor for the KServe model deployer.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Name of the flavor.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Name of the flavor.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">KSERVE_MODEL_DEPLOYER_FLAVOR</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">service_connector_requirements</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ServiceConnectorRequirements</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Service connector resource requirements for service connectors.</span>

<span class="sd">        Specifies resource requirements that are used to filter the available</span>
<span class="sd">        service connector types that are compatible with this flavor.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Requirements for compatible service connectors, if a service</span>
<span class="sd">            connector is required for this flavor.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ServiceConnectorRequirements</span><span class="p">(</span>
            <span class="n">resource_type</span><span class="o">=</span><span class="n">KUBERNETES_CLUSTER_RESOURCE_TYPE</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">docs_url</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A url to point at docs explaining this flavor.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A flavor docs url.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_default_docs_url</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sdk_docs_url</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A url to point at SDK docs explaining this flavor.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A flavor SDK docs url.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_default_sdk_docs_url</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">logo_url</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A url to represent the flavor in the dashboard.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The flavor logo.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;https://public-flavor-logos.s3.eu-central-1.amazonaws.com/model_deployer/kserve.png&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">config_class</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">KServeModelDeployerConfig</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns `KServeModelDeployerConfig` config class.</span>

<span class="sd">        Returns:</span>
<span class="sd">                The config class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">KServeModelDeployerConfig</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">implementation_class</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;KServeModelDeployer&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Implementation class for this flavor.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The implementation class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">zenml.integrations.kserve.model_deployers</span> <span class="kn">import</span> <span class="p">(</span>
            <span class="n">KServeModelDeployer</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">KServeModelDeployer</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h6 id="zenml.integrations.kserve.flavors.kserve_model_deployer_flavor.KServeModelDeployerFlavor.config_class" class="doc doc-heading">
<code class="highlight language-python"><span class="n">config_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">zenml</span><span class="o">.</span><span class="n">integrations</span><span class="o">.</span><span class="n">kserve</span><span class="o">.</span><span class="n">flavors</span><span class="o">.</span><span class="n">kserve_model_deployer_flavor</span><span class="o">.</span><span class="n">KServeModelDeployerConfig</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Returns <code>KServeModelDeployerConfig</code> config class.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Type[zenml.integrations.kserve.flavors.kserve_model_deployer_flavor.KServeModelDeployerConfig]</code></td>
      <td><p>The config class.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 id="zenml.integrations.kserve.flavors.kserve_model_deployer_flavor.KServeModelDeployerFlavor.docs_url" class="doc doc-heading">
<code class="highlight language-python"><span class="n">docs_url</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>A url to point at docs explaining this flavor.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[str]</code></td>
      <td><p>A flavor docs url.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 id="zenml.integrations.kserve.flavors.kserve_model_deployer_flavor.KServeModelDeployerFlavor.implementation_class" class="doc doc-heading">
<code class="highlight language-python"><span class="n">implementation_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">KServeModelDeployer</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Implementation class for this flavor.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Type[KServeModelDeployer]</code></td>
      <td><p>The implementation class.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 id="zenml.integrations.kserve.flavors.kserve_model_deployer_flavor.KServeModelDeployerFlavor.logo_url" class="doc doc-heading">
<code class="highlight language-python"><span class="n">logo_url</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>A url to represent the flavor in the dashboard.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The flavor logo.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 id="zenml.integrations.kserve.flavors.kserve_model_deployer_flavor.KServeModelDeployerFlavor.name" class="doc doc-heading">
<code class="highlight language-python"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Name of the flavor.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>Name of the flavor.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 id="zenml.integrations.kserve.flavors.kserve_model_deployer_flavor.KServeModelDeployerFlavor.sdk_docs_url" class="doc doc-heading">
<code class="highlight language-python"><span class="n">sdk_docs_url</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>A url to point at SDK docs explaining this flavor.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[str]</code></td>
      <td><p>A flavor SDK docs url.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 id="zenml.integrations.kserve.flavors.kserve_model_deployer_flavor.KServeModelDeployerFlavor.service_connector_requirements" class="doc doc-heading">
<code class="highlight language-python"><span class="n">service_connector_requirements</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">zenml</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">service_connector_models</span><span class="o">.</span><span class="n">ServiceConnectorRequirements</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Service connector resource requirements for service connectors.</p>
<p>Specifies resource requirements that are used to filter the available
service connector types that are compatible with this flavor.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[zenml.models.service_connector_models.ServiceConnectorRequirements]</code></td>
      <td><p>Requirements for compatible service connectors, if a service
connector is required for this flavor.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>








  </div>

    </div>

  </div>







  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="zenml.integrations.kserve.model_deployers" class="doc doc-heading">
        <code>model_deployers</code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Initialization of the KServe Model Deployer.</p>



  <div class="doc doc-children">











  <div class="doc doc-object doc-module">



<h4 id="zenml.integrations.kserve.model_deployers.kserve_model_deployer" class="doc doc-heading">
        <code>kserve_model_deployer</code>



</h4>

    <div class="doc doc-contents ">

      <p>Implementation of the KServe Model Deployer.</p>



  <div class="doc doc-children">









  <div class="doc doc-object doc-class">



<h5 id="zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer" class="doc doc-heading">
        <code>
KServeModelDeployer            (<a class="autorefs autorefs-internal" title="zenml.model_deployers.base_model_deployer.BaseModelDeployer" href="../../core_code_docs/core-model_deployers/#zenml.model_deployers.base_model_deployer.BaseModelDeployer">BaseModelDeployer</a>)
        </code>



</h5>

    <div class="doc doc-contents ">

      <p>KServe model deployer stack component implementation.</p>

        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/model_deployers/kserve_model_deployer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">KServeModelDeployer</span><span class="p">(</span><span class="n">BaseModelDeployer</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;KServe model deployer stack component implementation.&quot;&quot;&quot;</span>

    <span class="n">NAME</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;KServe&quot;</span>
    <span class="n">FLAVOR</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">BaseModelDeployerFlavor</span><span class="p">]]</span> <span class="o">=</span> <span class="n">KServeModelDeployerFlavor</span>

    <span class="n">_client</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">KServeClient</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">KServeModelDeployerConfig</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the `KServeModelDeployerConfig` config.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The configuration.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">KServeModelDeployerConfig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">validator</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">StackValidator</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Ensures there is a container registry and image builder in the stack.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A `StackValidator` instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">StackValidator</span><span class="p">(</span>
            <span class="n">required_components</span><span class="o">=</span><span class="p">{</span>
                <span class="n">StackComponentType</span><span class="o">.</span><span class="n">IMAGE_BUILDER</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_model_server_info</span><span class="p">(</span>  <span class="c1"># type: ignore[override]</span>
        <span class="n">service_instance</span><span class="p">:</span> <span class="s2">&quot;KServeDeploymentService&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return implementation specific information on the model server.</span>

<span class="sd">        Args:</span>
<span class="sd">            service_instance: KServe deployment service object</span>

<span class="sd">        Returns:</span>
<span class="sd">            A dictionary containing the model server information.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;PREDICTION_URL&quot;</span><span class="p">:</span> <span class="n">service_instance</span><span class="o">.</span><span class="n">prediction_url</span><span class="p">,</span>
            <span class="s2">&quot;PREDICTION_HOSTNAME&quot;</span><span class="p">:</span> <span class="n">service_instance</span><span class="o">.</span><span class="n">prediction_hostname</span><span class="p">,</span>
            <span class="s2">&quot;MODEL_URI&quot;</span><span class="p">:</span> <span class="n">service_instance</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">model_uri</span><span class="p">,</span>
            <span class="s2">&quot;MODEL_NAME&quot;</span><span class="p">:</span> <span class="n">service_instance</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">model_name</span><span class="p">,</span>
            <span class="s2">&quot;KSERVE_INFERENCE_SERVICE&quot;</span><span class="p">:</span> <span class="n">service_instance</span><span class="o">.</span><span class="n">crd_name</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">kserve_client</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">KServeClient</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the KServe client associated with this model deployer.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The KServeclient.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: If the Kubernetes namespace is not configured in the</span>
<span class="sd">                stack component when using a service connector to deploy models</span>
<span class="sd">                with KServe.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Refresh the client also if the connector has expired</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">connector_has_expired</span><span class="p">():</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span>

        <span class="n">connector</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_connector</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">connector</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">kubernetes_namespace</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="s2">&quot;The Kubernetes namespace must be explicitly configured in &quot;</span>
                    <span class="s2">&quot;the stack component when using a service connector to &quot;</span>
                    <span class="s2">&quot;deploy models with KServe.&quot;</span>
                <span class="p">)</span>
            <span class="n">client</span> <span class="o">=</span> <span class="n">connector</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">k8s_client</span><span class="o">.</span><span class="n">ApiClient</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Expected a k8s_client.ApiClient while trying to use the &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;linked connector, but got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">client</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_client</span> <span class="o">=</span> <span class="n">KubeClientKServeClient</span><span class="p">(</span>
                <span class="n">kube_client</span><span class="o">=</span><span class="n">client</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_client</span> <span class="o">=</span> <span class="n">KServeClient</span><span class="p">(</span>
                <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">kubernetes_context</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span>

    <span class="k">def</span> <span class="nf">get_docker_builds</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">deployment</span><span class="p">:</span> <span class="s2">&quot;PipelineDeploymentBaseModel&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;BuildConfiguration&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets the Docker builds required for the component.</span>

<span class="sd">        Args:</span>
<span class="sd">            deployment: The pipeline deployment for which to get the builds.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The required Docker builds.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">builds</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">step_name</span><span class="p">,</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">deployment</span><span class="o">.</span><span class="n">step_configurations</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">step</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">extra</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">KSERVE_CUSTOM_DEPLOYMENT</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">build</span> <span class="o">=</span> <span class="n">BuildConfiguration</span><span class="p">(</span>
                    <span class="n">key</span><span class="o">=</span><span class="n">KSERVE_DOCKER_IMAGE_KEY</span><span class="p">,</span>
                    <span class="n">settings</span><span class="o">=</span><span class="n">step</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">docker_settings</span><span class="p">,</span>
                    <span class="n">step_name</span><span class="o">=</span><span class="n">step_name</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">builds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">build</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">builds</span>

    <span class="k">def</span> <span class="nf">deploy_model</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">config</span><span class="p">:</span> <span class="n">ServiceConfig</span><span class="p">,</span>
        <span class="n">replace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">DEFAULT_KSERVE_DEPLOYMENT_START_STOP_TIMEOUT</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaseService</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new KServe deployment or update an existing one.</span>

<span class="sd">        This method has two modes of operation, depending on the `replace`</span>
<span class="sd">        argument value:</span>

<span class="sd">          * if `replace` is False, calling this method will create a new KServe</span>
<span class="sd">            deployment server to reflect the model and other configuration</span>
<span class="sd">            parameters specified in the supplied KServe deployment `config`.</span>

<span class="sd">          * if `replace` is True, this method will first attempt to find an</span>
<span class="sd">            existing KServe deployment that is *equivalent* to the supplied</span>
<span class="sd">            configuration parameters. Two or more KServe deployments are</span>
<span class="sd">            considered equivalent if they have the same `pipeline_name`,</span>
<span class="sd">            `pipeline_step_name` and `model_name` configuration parameters. To</span>
<span class="sd">            put it differently, two KServe deployments are equivalent if</span>
<span class="sd">            they serve versions of the same model deployed by the same pipeline</span>
<span class="sd">            step. If an equivalent KServe deployment is found, it will be</span>
<span class="sd">            updated in place to reflect the new configuration parameters. This</span>
<span class="sd">            allows an existing KServe deployment to retain its prediction</span>
<span class="sd">            URL while performing a rolling update to serve a new model version.</span>

<span class="sd">        Callers should set `replace` to True if they want a continuous model</span>
<span class="sd">        deployment workflow that doesn&#39;t spin up a new KServe deployment</span>
<span class="sd">        server for each new model version. If multiple equivalent KServe</span>
<span class="sd">        deployments are found, the most recently created deployment is selected</span>
<span class="sd">        to be updated and the others are deleted.</span>

<span class="sd">        Args:</span>
<span class="sd">            config: the configuration of the model to be deployed with KServe.</span>
<span class="sd">            replace: set this flag to True to find and update an equivalent</span>
<span class="sd">                KServeDeployment server with the new model instead of</span>
<span class="sd">                starting a new deployment server.</span>
<span class="sd">            timeout: the timeout in seconds to wait for the KServe server</span>
<span class="sd">                to be provisioned and successfully started or updated. If set</span>
<span class="sd">                to 0, the method will return immediately after the KServe</span>
<span class="sd">                server is provisioned, without waiting for it to fully start.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The ZenML KServe deployment service object that can be used to</span>
<span class="sd">            interact with the remote KServe server.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: if the KServe deployment server could not be stopped.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">event_handler</span><span class="p">(</span>
            <span class="n">event</span><span class="o">=</span><span class="n">AnalyticsEvent</span><span class="o">.</span><span class="n">MODEL_DEPLOYED</span><span class="p">,</span> <span class="n">v2</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span> <span class="k">as</span> <span class="n">analytics_handler</span><span class="p">:</span>
            <span class="n">config</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">KServeDeploymentConfig</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
            <span class="n">service</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="c1"># if replace is True, find equivalent KServe deployments</span>
            <span class="k">if</span> <span class="n">replace</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">equivalent_services</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_model_server</span><span class="p">(</span>
                    <span class="n">running</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">pipeline_name</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">pipeline_name</span><span class="p">,</span>
                    <span class="n">pipeline_step_name</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">pipeline_step_name</span><span class="p">,</span>
                    <span class="n">model_name</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">model_name</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="k">for</span> <span class="n">equivalent_service</span> <span class="ow">in</span> <span class="n">equivalent_services</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">service</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="c1"># keep the most recently created service</span>
                        <span class="n">service</span> <span class="o">=</span> <span class="n">equivalent_service</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="c1"># delete the older services and don&#39;t wait for</span>
                            <span class="c1"># them to be deprovisioned</span>
                            <span class="n">service</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
                        <span class="k">except</span> <span class="ne">RuntimeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                                <span class="s2">&quot;Failed to stop the KServe deployment &quot;</span>
                                <span class="s2">&quot;server:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;Please stop it manually and try again.&quot;</span><span class="p">,</span>
                            <span class="p">)</span>

            <span class="k">if</span> <span class="n">service</span><span class="p">:</span>
                <span class="c1"># Reuse the service account and secret from the existing</span>
                <span class="c1"># service.</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">service</span><span class="p">,</span> <span class="n">KServeDeploymentService</span><span class="p">)</span>
                <span class="n">config</span><span class="o">.</span><span class="n">k8s_service_account</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">k8s_service_account</span>
                <span class="n">config</span><span class="o">.</span><span class="n">k8s_secret</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">k8s_secret</span>

            <span class="c1"># configure the credentials for the KServe model server</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_create_or_update_kserve_credentials</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">service</span><span class="p">:</span>
                <span class="c1"># update an equivalent service in place</span>
                <span class="n">service</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Updating an existing KServe deployment service: </span><span class="si">{</span><span class="n">service</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># create a new service</span>
                <span class="n">service</span> <span class="o">=</span> <span class="n">KServeDeploymentService</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Creating a new KServe deployment service: </span><span class="si">{</span><span class="n">service</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

            <span class="c1"># start the service which in turn provisions the KServe</span>
            <span class="c1"># deployment server and waits for it to reach a ready state</span>
            <span class="n">service</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>

            <span class="c1"># Add telemetry with metadata that gets the stack metadata and</span>
            <span class="c1"># differentiates between pure model and custom code deployments</span>
            <span class="n">stack</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">active_stack</span>
            <span class="n">stack_metadata</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">component_type</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="n">component</span><span class="o">.</span><span class="n">flavor</span>
                <span class="k">for</span> <span class="n">component_type</span><span class="p">,</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">stack</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">}</span>
            <span class="n">analytics_handler</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;store_type&quot;</span><span class="p">:</span> <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">zen_store</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                <span class="o">**</span><span class="n">stack_metadata</span><span class="p">,</span>
                <span class="s2">&quot;is_custom_code_deployment&quot;</span><span class="p">:</span> <span class="n">config</span><span class="o">.</span><span class="n">container</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="k">return</span> <span class="n">service</span>

    <span class="k">def</span> <span class="nf">get_kserve_deployments</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">V1beta1InferenceService</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a list of KServe deployments that match the supplied labels.</span>

<span class="sd">        Args:</span>
<span class="sd">            labels: a dictionary of labels to match against KServe deployments.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of KServe deployments that match the supplied labels.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: if an operational failure is encountered while</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">label_selector</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">())</span> <span class="k">if</span> <span class="n">labels</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="p">)</span>

        <span class="n">namespace</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">kubernetes_namespace</span>
            <span class="ow">or</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_default_target_namespace</span><span class="p">()</span>
        <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">kserve_client</span><span class="o">.</span><span class="n">api_instance</span><span class="o">.</span><span class="n">list_namespaced_custom_object</span><span class="p">(</span>
                    <span class="n">constants</span><span class="o">.</span><span class="n">KSERVE_GROUP</span><span class="p">,</span>
                    <span class="n">constants</span><span class="o">.</span><span class="n">KSERVE_V1BETA1_VERSION</span><span class="p">,</span>
                    <span class="n">namespace</span><span class="p">,</span>
                    <span class="n">constants</span><span class="o">.</span><span class="n">KSERVE_PLURAL</span><span class="p">,</span>
                    <span class="n">label_selector</span><span class="o">=</span><span class="n">label_selector</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="n">k8s_client</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">ApiException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;Exception when retrieving KServe inference services</span><span class="se">\</span>
<span class="s2">                </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="o">%</span> <span class="n">e</span>
            <span class="p">)</span>

        <span class="c1"># TODO[CRITICAL]: de-serialize each item into a complete</span>
        <span class="c1">#   V1beta1InferenceService object recursively using the OpenApi</span>
        <span class="c1">#   schema (this doesn&#39;t work right now)</span>
        <span class="n">inference_services</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">V1beta1InferenceService</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;items&quot;</span><span class="p">,</span> <span class="p">[]):</span>
            <span class="n">snake_case_item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_camel_to_snake</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="n">inference_service</span> <span class="o">=</span> <span class="n">V1beta1InferenceService</span><span class="p">(</span><span class="o">**</span><span class="n">snake_case_item</span><span class="p">)</span>
            <span class="n">inference_services</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inference_service</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">inference_services</span>

    <span class="k">def</span> <span class="nf">_camel_to_snake</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert a camelCase dictionary to snake_case.</span>

<span class="sd">        Args:</span>
<span class="sd">            obj: a dictionary with camelCase keys</span>

<span class="sd">        Returns:</span>
<span class="sd">            a dictionary with snake_case keys</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">obj</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">assert</span> <span class="n">obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="n">new</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">new</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_convert_to_snake</span><span class="p">(</span><span class="n">k</span><span class="p">)]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_camel_to_snake</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">set</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="k">assert</span> <span class="n">obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="n">new</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_camel_to_snake</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">obj</span>
        <span class="k">return</span> <span class="n">new</span>

    <span class="k">def</span> <span class="nf">_convert_to_snake</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?&lt;!^)(?=[A-Z])&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">find_model_server</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">running</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">service_uuid</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">UUID</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">pipeline_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">run_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">pipeline_step_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">model_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">model_uri</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">predictor</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">BaseService</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Find one or more KServe model services that match the given criteria.</span>

<span class="sd">        Args:</span>
<span class="sd">            running: If true, only running services will be returned.</span>
<span class="sd">            service_uuid: The UUID of the service that was originally used</span>
<span class="sd">                to deploy the model.</span>
<span class="sd">            pipeline_name: name of the pipeline that the deployed model was part</span>
<span class="sd">                of.</span>
<span class="sd">            run_name: name of the pipeline run which the deployed model was</span>
<span class="sd">                part of.</span>
<span class="sd">            pipeline_step_name: the name of the pipeline model deployment step</span>
<span class="sd">                that deployed the model.</span>
<span class="sd">            model_name: the name of the deployed model.</span>
<span class="sd">            model_uri: URI of the deployed model.</span>
<span class="sd">            predictor: the name of the predictor that was used to deploy the model.</span>

<span class="sd">        Returns:</span>
<span class="sd">            One or more Service objects representing model servers that match</span>
<span class="sd">            the input search criteria.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">KServeDeploymentConfig</span><span class="p">(</span>
            <span class="n">pipeline_name</span><span class="o">=</span><span class="n">pipeline_name</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">run_name</span><span class="o">=</span><span class="n">run_name</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">pipeline_run_id</span><span class="o">=</span><span class="n">run_name</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">pipeline_step_name</span><span class="o">=</span><span class="n">pipeline_step_name</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">model_uri</span><span class="o">=</span><span class="n">model_uri</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">model_name</span><span class="o">=</span><span class="n">model_name</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">predictor</span><span class="o">=</span><span class="n">predictor</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">resources</span><span class="o">=</span><span class="p">{},</span>
        <span class="p">)</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get_kubernetes_labels</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">service_uuid</span><span class="p">:</span>
            <span class="n">labels</span><span class="p">[</span><span class="s2">&quot;zenml.service_uuid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">service_uuid</span><span class="p">)</span>

        <span class="n">deployments</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_kserve_deployments</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>

        <span class="n">services</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">BaseService</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">deployment</span> <span class="ow">in</span> <span class="n">deployments</span><span class="p">:</span>
            <span class="c1"># recreate the KServe deployment service object from the KServe</span>
            <span class="c1"># deployment resource</span>
            <span class="n">service</span> <span class="o">=</span> <span class="n">KServeDeploymentService</span><span class="o">.</span><span class="n">create_from_deployment</span><span class="p">(</span>
                <span class="n">deployment</span><span class="o">=</span><span class="n">deployment</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">running</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">service</span><span class="o">.</span><span class="n">is_running</span><span class="p">:</span>
                <span class="c1"># skip non-running services</span>
                <span class="k">continue</span>
            <span class="n">services</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">service</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">services</span>

    <span class="k">def</span> <span class="nf">stop_model_server</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">uuid</span><span class="p">:</span> <span class="n">UUID</span><span class="p">,</span>
        <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">DEFAULT_KSERVE_DEPLOYMENT_START_STOP_TIMEOUT</span><span class="p">,</span>
        <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stop a KServe model server.</span>

<span class="sd">        Args:</span>
<span class="sd">            uuid: UUID of the model server to stop.</span>
<span class="sd">            timeout: timeout in seconds to wait for the service to stop.</span>
<span class="sd">            force: if True, force the service to stop.</span>

<span class="sd">        Raises:</span>
<span class="sd">            NotImplementedError: stopping on KServe model servers is not</span>
<span class="sd">                supported.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s2">&quot;Stopping KServe model servers is not implemented. Try &quot;</span>
            <span class="s2">&quot;deleting the KServe model server instead.&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">start_model_server</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">uuid</span><span class="p">:</span> <span class="n">UUID</span><span class="p">,</span>
        <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">DEFAULT_KSERVE_DEPLOYMENT_START_STOP_TIMEOUT</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Start a KServe model deployment server.</span>

<span class="sd">        Args:</span>
<span class="sd">            uuid: UUID of the model server to start.</span>
<span class="sd">            timeout: timeout in seconds to wait for the service to become</span>
<span class="sd">                active. . If set to 0, the method will return immediately after</span>
<span class="sd">                provisioning the service, without waiting for it to become</span>
<span class="sd">                active.</span>

<span class="sd">        Raises:</span>
<span class="sd">            NotImplementedError: since we don&#39;t support starting KServe</span>
<span class="sd">                model servers</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="s2">&quot;Starting KServe model servers is not implemented&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">delete_model_server</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">uuid</span><span class="p">:</span> <span class="n">UUID</span><span class="p">,</span>
        <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">DEFAULT_KSERVE_DEPLOYMENT_START_STOP_TIMEOUT</span><span class="p">,</span>
        <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete a KServe model deployment server.</span>

<span class="sd">        Args:</span>
<span class="sd">            uuid: UUID of the model server to delete.</span>
<span class="sd">            timeout: timeout in seconds to wait for the service to stop. If</span>
<span class="sd">                set to 0, the method will return immediately after</span>
<span class="sd">                deprovisioning the service, without waiting for it to stop.</span>
<span class="sd">            force: if True, force the service to stop.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">services</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_model_server</span><span class="p">(</span><span class="n">service_uuid</span><span class="o">=</span><span class="n">uuid</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">services</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">service</span> <span class="o">=</span> <span class="n">services</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">service</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">service</span><span class="p">,</span> <span class="n">KServeDeploymentService</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">service</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">k8s_service_account</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delete_k8s_service_account</span><span class="p">(</span><span class="n">service</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">k8s_service_account</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">service</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">k8s_secret</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delete_k8s_secret</span><span class="p">(</span><span class="n">service</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">k8s_secret</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_create_or_update_kserve_credentials</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">KServeDeploymentConfig</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create or update the KServe credentials used to access the artifact store.</span>

<span class="sd">        The way KServe allows configured credentials to be passed to the</span>
<span class="sd">        model servers is a bit convoluted:</span>

<span class="sd">          * we need to create a Kubernetes secret object with credentials</span>
<span class="sd">            in the correct format supported by KServe (only AWS, GCP, Azure are</span>
<span class="sd">            supported)</span>
<span class="sd">          * we need to create a Kubernetes service account object that</span>
<span class="sd">            references the secret object</span>
<span class="sd">          * we need to use the service account object in the KServe</span>
<span class="sd">            deployment configuration</span>

<span class="sd">        This method will use a random name for every model server. This ensures</span>
<span class="sd">        that we can create multiple KServe deployments with different</span>
<span class="sd">        credentials without running into naming conflicts.</span>

<span class="sd">        If a ZenML secret is not explicitly configured for the model deployment</span>
<span class="sd">        or the model deployer, this method attempts to fetch credentials from</span>
<span class="sd">        the active artifact store and convert them into the appropriate secret</span>
<span class="sd">        format expected by KServe.</span>

<span class="sd">        Args:</span>
<span class="sd">            config: KServe deployment configuration.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: if the configured secret object is not found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">secret_name</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">secret_name</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">secret</span>

        <span class="k">if</span> <span class="n">secret_name</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">secret_name</span><span class="p">:</span>
                <span class="n">secret_source</span> <span class="o">=</span> <span class="s2">&quot;model deployment&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">secret_source</span> <span class="o">=</span> <span class="s2">&quot;Model Deployer&quot;</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Your KServe </span><span class="si">{</span><span class="n">secret_source</span><span class="si">}</span><span class="s2"> is configured to use a &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;ZenML secret `</span><span class="si">{</span><span class="n">secret_name</span><span class="si">}</span><span class="s2">` that holds credentials needed &quot;</span>
                <span class="s2">&quot;to access the artifact store. The recommended authentication &quot;</span>
                <span class="s2">&quot;method is to configure credentials for the artifact store &quot;</span>
                <span class="s2">&quot;stack component instead. The KServe model deployer will use &quot;</span>
                <span class="s2">&quot;those credentials to authenticate to the artifact store &quot;</span>
                <span class="s2">&quot;automatically.&quot;</span>
            <span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">zenml_secret</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">get_secret_by_name_and_scope</span><span class="p">(</span>
                    <span class="n">secret_name</span>
                <span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;The ZenML secret &#39;</span><span class="si">{</span><span class="n">secret_name</span><span class="si">}</span><span class="s2">&#39; specified in the &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;KServe </span><span class="si">{</span><span class="n">secret_source</span><span class="si">}</span><span class="s2"> configuration was not found &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;in the secrets store: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>

            <span class="n">credentials</span> <span class="o">=</span> <span class="n">zenml_secret</span><span class="o">.</span><span class="n">secret_values</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># if no secret is configured, try to fetch credentials from the</span>
            <span class="c1"># active artifact store and convert them into the appropriate format</span>
            <span class="c1"># expected by KServe</span>
            <span class="n">converted_secret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_artifact_store_secret</span><span class="p">()</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">converted_secret</span><span class="p">:</span>
                <span class="c1"># If a secret and service account were previously configured, we</span>
                <span class="c1"># need to delete them before we can proceed</span>
                <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">k8s_service_account</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">delete_k8s_service_account</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">k8s_service_account</span><span class="p">)</span>
                    <span class="n">config</span><span class="o">.</span><span class="n">k8s_service_account</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">k8s_secret</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">delete_k8s_secret</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">k8s_secret</span><span class="p">)</span>
                    <span class="n">config</span><span class="o">.</span><span class="n">k8s_secret</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">return</span>

            <span class="n">credentials</span> <span class="o">=</span> <span class="n">converted_secret</span><span class="o">.</span><span class="n">content</span>

        <span class="c1"># S3 credentials are special because part of them need to be passed</span>
        <span class="c1"># as annotations</span>
        <span class="n">annotations</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="s2">&quot;aws_access_key_id&quot;</span> <span class="ow">in</span> <span class="n">credentials</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">credentials</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;s3_region&quot;</span><span class="p">):</span>
                <span class="n">annotations</span><span class="p">[</span>
                    <span class="s2">&quot;serving.kubeflow.org/s3-region&quot;</span>
                <span class="p">]</span> <span class="o">=</span> <span class="n">credentials</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;s3_region&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">credentials</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;s3_endpoint&quot;</span><span class="p">):</span>
                <span class="n">annotations</span><span class="p">[</span>
                    <span class="s2">&quot;serving.kubeflow.org/s3-endpoint&quot;</span>
                <span class="p">]</span> <span class="o">=</span> <span class="n">credentials</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;s3_endpoint&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">credentials</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;s3_use_https&quot;</span><span class="p">):</span>
                <span class="n">annotations</span><span class="p">[</span>
                    <span class="s2">&quot;serving.kubeflow.org/s3-usehttps&quot;</span>
                <span class="p">]</span> <span class="o">=</span> <span class="n">credentials</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;s3_use_https&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">credentials</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;s3_verify_ssl&quot;</span><span class="p">):</span>
                <span class="n">annotations</span><span class="p">[</span>
                    <span class="s2">&quot;serving.kubeflow.org/s3-verifyssl&quot;</span>
                <span class="p">]</span> <span class="o">=</span> <span class="n">credentials</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;s3_verify_ssl&quot;</span><span class="p">)</span>

        <span class="c1"># Convert all keys to uppercase</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="o">.</span><span class="n">upper</span><span class="p">():</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">credentials</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

        <span class="c1"># The GCP credentials need to use a specific key name</span>
        <span class="k">if</span> <span class="s2">&quot;GOOGLE_APPLICATION_CREDENTIALS&quot;</span> <span class="ow">in</span> <span class="n">credentials</span><span class="p">:</span>
            <span class="n">credentials</span><span class="p">[</span>
                <span class="s2">&quot;gcloud-application-credentials.json&quot;</span>
            <span class="p">]</span> <span class="o">=</span> <span class="n">credentials</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;GOOGLE_APPLICATION_CREDENTIALS&quot;</span><span class="p">)</span>

        <span class="c1"># Create or update the Kubernetes secret object</span>
        <span class="n">config</span><span class="o">.</span><span class="n">k8s_secret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_or_update_k8s_secret</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">k8s_secret</span><span class="p">,</span>
            <span class="n">annotations</span><span class="o">=</span><span class="n">annotations</span><span class="p">,</span>
            <span class="n">secret_values</span><span class="o">=</span><span class="n">credentials</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Create or update the Kubernetes service account object</span>
        <span class="n">config</span><span class="o">.</span><span class="n">k8s_service_account</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_or_update_k8s_service_account</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">k8s_service_account</span><span class="p">,</span>
            <span class="n">secret_name</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">k8s_secret</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_convert_artifact_store_secret</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BaseSecretSchema</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert the credentials configured for the artifact store into a ZenML secret.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The KServe credentials in the format expected by KServe or None if</span>
<span class="sd">            no credentials are configured for the artifact store or if they</span>
<span class="sd">            cannot be converted into the KServe format.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">artifact_store</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">active_stack</span><span class="o">.</span><span class="n">artifact_store</span>

        <span class="n">zenml_secret</span><span class="p">:</span> <span class="n">BaseSecretSchema</span>

        <span class="k">if</span> <span class="n">artifact_store</span><span class="o">.</span><span class="n">flavor</span> <span class="o">==</span> <span class="s2">&quot;s3&quot;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">zenml.integrations.s3.artifact_stores</span> <span class="kn">import</span> <span class="n">S3ArtifactStore</span>

            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">artifact_store</span><span class="p">,</span> <span class="n">S3ArtifactStore</span><span class="p">)</span>

            <span class="p">(</span>
                <span class="n">aws_access_key_id</span><span class="p">,</span>
                <span class="n">aws_secret_access_key</span><span class="p">,</span>
                <span class="n">_</span><span class="p">,</span>
            <span class="p">)</span> <span class="o">=</span> <span class="n">artifact_store</span><span class="o">.</span><span class="n">get_credentials</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">aws_access_key_id</span> <span class="ow">and</span> <span class="n">aws_secret_access_key</span><span class="p">:</span>
                <span class="c1"># Convert the credentials into the format expected by KServe</span>
                <span class="n">zenml_secret</span> <span class="o">=</span> <span class="n">KServeS3SecretSchema</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                    <span class="n">aws_access_key_id</span><span class="o">=</span><span class="n">aws_access_key_id</span><span class="p">,</span>
                    <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="n">aws_secret_access_key</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">artifact_store</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">client_kwargs</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s2">&quot;endpoint_url&quot;</span> <span class="ow">in</span> <span class="n">artifact_store</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">client_kwargs</span><span class="p">:</span>
                        <span class="n">zenml_secret</span><span class="o">.</span><span class="n">s3_endpoint</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span>
                            <span class="n">artifact_store</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">client_kwargs</span><span class="p">[</span><span class="s2">&quot;endpoint_url&quot;</span><span class="p">]</span>
                        <span class="p">)</span>
                    <span class="k">if</span> <span class="s2">&quot;region_name&quot;</span> <span class="ow">in</span> <span class="n">artifact_store</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">client_kwargs</span><span class="p">:</span>
                        <span class="n">zenml_secret</span><span class="o">.</span><span class="n">s3_region</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span>
                            <span class="n">artifact_store</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">client_kwargs</span><span class="p">[</span><span class="s2">&quot;region_name&quot;</span><span class="p">]</span>
                        <span class="p">)</span>
                    <span class="k">if</span> <span class="s2">&quot;use_ssl&quot;</span> <span class="ow">in</span> <span class="n">artifact_store</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">client_kwargs</span><span class="p">:</span>
                        <span class="n">zenml_secret</span><span class="o">.</span><span class="n">s3_use_https</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span>
                            <span class="n">artifact_store</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">client_kwargs</span><span class="p">[</span><span class="s2">&quot;use_ssl&quot;</span><span class="p">]</span>
                        <span class="p">)</span>

                <span class="k">return</span> <span class="n">zenml_secret</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;No credentials are configured for the active S3 artifact &quot;</span>
                <span class="s2">&quot;store. The KServe model deployer will assume an &quot;</span>
                <span class="s2">&quot;implicit form of authentication is available in the &quot;</span>
                <span class="s2">&quot;target Kubernetes cluster, but the served model may not &quot;</span>
                <span class="s2">&quot;be able to access the model artifacts.&quot;</span>
            <span class="p">)</span>

            <span class="c1"># Assume implicit in-cluster IAM authentication</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">elif</span> <span class="n">artifact_store</span><span class="o">.</span><span class="n">flavor</span> <span class="o">==</span> <span class="s2">&quot;gcp&quot;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">zenml.integrations.gcp.artifact_stores</span> <span class="kn">import</span> <span class="n">GCPArtifactStore</span>

            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">artifact_store</span><span class="p">,</span> <span class="n">GCPArtifactStore</span><span class="p">)</span>

            <span class="n">gcp_credentials</span> <span class="o">=</span> <span class="n">artifact_store</span><span class="o">.</span><span class="n">get_credentials</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">gcp_credentials</span><span class="p">:</span>
                <span class="c1"># Convert the credentials into the format expected by KServe</span>
                <span class="k">return</span> <span class="n">KServeGSSecretSchema</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                    <span class="n">google_application_credentials</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">gcp_credentials</span><span class="p">),</span>
                <span class="p">)</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;No credentials are configured for the active GCS artifact &quot;</span>
                <span class="s2">&quot;store. The KServe model deployer will assume an &quot;</span>
                <span class="s2">&quot;implicit form of authentication is available in the &quot;</span>
                <span class="s2">&quot;target Kubernetes cluster, but the served model may not &quot;</span>
                <span class="s2">&quot;be able to access the model artifacts.&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">elif</span> <span class="n">artifact_store</span><span class="o">.</span><span class="n">flavor</span> <span class="o">==</span> <span class="s2">&quot;azure&quot;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">zenml.integrations.azure.artifact_stores</span> <span class="kn">import</span> <span class="p">(</span>
                <span class="n">AzureArtifactStore</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">artifact_store</span><span class="p">,</span> <span class="n">AzureArtifactStore</span><span class="p">)</span>

            <span class="n">azure_credentials</span> <span class="o">=</span> <span class="n">artifact_store</span><span class="o">.</span><span class="n">get_credentials</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">azure_credentials</span><span class="p">:</span>
                <span class="c1"># Convert the credentials into the format expected by KServe</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">azure_credentials</span><span class="o">.</span><span class="n">client_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                    <span class="ow">and</span> <span class="n">azure_credentials</span><span class="o">.</span><span class="n">client_secret</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                    <span class="ow">and</span> <span class="n">azure_credentials</span><span class="o">.</span><span class="n">tenant_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="p">):</span>
                    <span class="k">return</span> <span class="n">KServeAzureSecretSchema</span><span class="p">(</span>
                        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                        <span class="n">azure_client_id</span><span class="o">=</span><span class="n">azure_credentials</span><span class="o">.</span><span class="n">client_id</span><span class="p">,</span>
                        <span class="n">azure_client_secret</span><span class="o">=</span><span class="n">azure_credentials</span><span class="o">.</span><span class="n">client_secret</span><span class="p">,</span>
                        <span class="n">azure_tenant_id</span><span class="o">=</span><span class="n">azure_credentials</span><span class="o">.</span><span class="n">tenant_id</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                        <span class="s2">&quot;The KServe model deployer could not use the &quot;</span>
                        <span class="s2">&quot;credentials currently configured in the active Azure &quot;</span>
                        <span class="s2">&quot;artifact store because it only supports service &quot;</span>
                        <span class="s2">&quot;principal Azure credentials. &quot;</span>
                        <span class="s2">&quot;Please configure Azure principal credentials for your &quot;</span>
                        <span class="s2">&quot;artifact store or specify a custom ZenML secret in &quot;</span>
                        <span class="s2">&quot;the model deployer configuration that holds the &quot;</span>
                        <span class="s2">&quot;credentials required to access the model artifacts. &quot;</span>
                        <span class="s2">&quot;The KServe model deployer will assume an implicit &quot;</span>
                        <span class="s2">&quot;form of authentication is available in the target &quot;</span>
                        <span class="s2">&quot;Kubernetes cluster, but the served model &quot;</span>
                        <span class="s2">&quot;may not be able to access the model artifacts.&quot;</span>
                    <span class="p">)</span>

                    <span class="k">return</span> <span class="kc">None</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;No credentials are configured for the active Azure &quot;</span>
                <span class="s2">&quot;artifact store. The Seldon Core model deployer will &quot;</span>
                <span class="s2">&quot;assume an implicit form of authentication is available &quot;</span>
                <span class="s2">&quot;in the target Kubernetes cluster, but the served model &quot;</span>
                <span class="s2">&quot;may not be able to access the model artifacts.&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;The KServe model deployer doesn&#39;t know how to configure &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;credentials automatically for the `</span><span class="si">{</span><span class="n">artifact_store</span><span class="o">.</span><span class="n">flavor</span><span class="si">}</span><span class="s2">` &quot;</span>
            <span class="s2">&quot;active artifact store flavor. &quot;</span>
            <span class="s2">&quot;Please use one of the supported artifact stores (S3 or GCP) &quot;</span>
            <span class="s2">&quot;or specify a ZenML secret in the model deployer &quot;</span>
            <span class="s2">&quot;configuration that holds the credentials required to access &quot;</span>
            <span class="s2">&quot;the model artifacts. The KServe model deployer will &quot;</span>
            <span class="s2">&quot;assume an implicit form of authentication is available &quot;</span>
            <span class="s2">&quot;in the target Kubernetes cluster, but the served model &quot;</span>
            <span class="s2">&quot;may not be able to access the model artifacts.&quot;</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">create_or_update_k8s_secret</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">secret_values</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span>
        <span class="n">annotations</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create or update a Kubernetes Secret resource.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: the name of the Secret resource to create. If not</span>
<span class="sd">                specified, a random name will be generated.</span>
<span class="sd">            secret_values: secret key-values that should be</span>
<span class="sd">                stored in the Secret resource.</span>
<span class="sd">            annotations: optional annotations to add to the Secret resource.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The name of the created Secret resource.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: if an unknown error occurs during the creation of</span>
<span class="sd">                the secret.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="sa">f</span><span class="s2">&quot;zenml-kserve-</span><span class="si">{</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating Secret resource: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">core_api</span> <span class="o">=</span> <span class="n">k8s_client</span><span class="o">.</span><span class="n">CoreV1Api</span><span class="p">()</span>

            <span class="n">secret_data</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">k</span><span class="p">:</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;ascii&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">secret_values</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="p">}</span>

            <span class="n">secret</span> <span class="o">=</span> <span class="n">k8s_client</span><span class="o">.</span><span class="n">V1Secret</span><span class="p">(</span>
                <span class="n">metadata</span><span class="o">=</span><span class="n">k8s_client</span><span class="o">.</span><span class="n">V1ObjectMeta</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;app&quot;</span><span class="p">:</span> <span class="s2">&quot;zenml&quot;</span><span class="p">},</span>
                    <span class="n">annotations</span><span class="o">=</span><span class="n">annotations</span><span class="p">,</span>
                <span class="p">),</span>
                <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;Opaque&quot;</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="n">secret_data</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># check if the secret is already present</span>
                <span class="n">core_api</span><span class="o">.</span><span class="n">read_namespaced_secret</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">kubernetes_namespace</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="c1"># if we got this far, the secret is already present, update it</span>
                <span class="c1"># in place</span>
                <span class="n">response</span> <span class="o">=</span> <span class="n">core_api</span><span class="o">.</span><span class="n">replace_namespaced_secret</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">kubernetes_namespace</span><span class="p">,</span>
                    <span class="n">body</span><span class="o">=</span><span class="n">secret</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">except</span> <span class="n">k8s_client</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">ApiException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">404</span><span class="p">:</span>
                    <span class="c1"># if an error other than 404 is raised here, treat it</span>
                    <span class="c1"># as an unexpected error</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                        <span class="s2">&quot;Exception when reading Secret resource: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="n">response</span> <span class="o">=</span> <span class="n">core_api</span><span class="o">.</span><span class="n">create_namespaced_secret</span><span class="p">(</span>
                    <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">kubernetes_namespace</span><span class="p">,</span>
                    <span class="n">body</span><span class="o">=</span><span class="n">secret</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Kubernetes API response: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">k8s_client</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">ApiException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;Exception when creating Secret resource </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">name</span>

    <span class="k">def</span> <span class="nf">delete_k8s_secret</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete a Kubernetes Secret resource managed by ZenML.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: the name of the Kubernetes Secret resource to delete.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: if an unknown error occurs during the removal</span>
<span class="sd">                of the secret.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Deleting Secret resource: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">core_api</span> <span class="o">=</span> <span class="n">k8s_client</span><span class="o">.</span><span class="n">CoreV1Api</span><span class="p">()</span>

            <span class="n">response</span> <span class="o">=</span> <span class="n">core_api</span><span class="o">.</span><span class="n">delete_namespaced_secret</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">kubernetes_namespace</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Kubernetes API response: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">k8s_client</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">ApiException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
                <span class="c1"># the secret is no longer present, nothing to do</span>
                <span class="k">return</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Exception when deleting Secret resource </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_or_update_k8s_service_account</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">secret_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create or update a Kubernetes ServiceAccount resource with a secret managed by ZenML.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: the name of the ServiceAccount resource to create. If not</span>
<span class="sd">                specified, a random name will be generated.</span>
<span class="sd">            secret_name: the name of a secret to attach to the ServiceAccount.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The name of the created ServiceAccount resource.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: if an unknown error occurs during the creation of</span>
<span class="sd">                the service account.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="sa">f</span><span class="s2">&quot;zenml-kserve-</span><span class="si">{</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="n">service_account</span> <span class="o">=</span> <span class="n">k8s_client</span><span class="o">.</span><span class="n">V1ServiceAccount</span><span class="p">(</span>
            <span class="n">metadata</span><span class="o">=</span><span class="n">k8s_client</span><span class="o">.</span><span class="n">V1ObjectMeta</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">secret_name</span><span class="p">:</span>
            <span class="n">service_account</span><span class="o">.</span><span class="n">secrets</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">k8s_client</span><span class="o">.</span><span class="n">V1ObjectReference</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;Secret&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">secret_name</span><span class="p">)</span>
            <span class="p">]</span>

        <span class="n">core_api</span> <span class="o">=</span> <span class="n">k8s_client</span><span class="o">.</span><span class="n">CoreV1Api</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># check if the service account is already present</span>
            <span class="n">core_api</span><span class="o">.</span><span class="n">read_namespaced_service_account</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">kubernetes_namespace</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="c1"># if we got this far, the service account is already present, update</span>
            <span class="c1"># it in place</span>
            <span class="n">core_api</span><span class="o">.</span><span class="n">replace_namespaced_service_account</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">kubernetes_namespace</span><span class="p">,</span>
                <span class="n">body</span><span class="o">=</span><span class="n">service_account</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="n">k8s_client</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">ApiException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">404</span><span class="p">:</span>
                <span class="c1"># if an error other than 404 is raised here, treat it</span>
                <span class="c1"># as an unexpected error</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="s2">&quot;Exception when reading ServiceAccount resource: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="n">core_api</span><span class="o">.</span><span class="n">create_namespaced_service_account</span><span class="p">(</span>
                <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">kubernetes_namespace</span><span class="p">,</span>
                <span class="n">body</span><span class="o">=</span><span class="n">service_account</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">name</span>

    <span class="k">def</span> <span class="nf">delete_k8s_service_account</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete a Kubernetes ServiceAccount resource managed by ZenML.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: the name of the Kubernetes ServiceAccount resource to delete.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: if an unknown error occurs during the removal</span>
<span class="sd">                of the service account.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Deleting ServiceAccount resource: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">core_api</span> <span class="o">=</span> <span class="n">k8s_client</span><span class="o">.</span><span class="n">CoreV1Api</span><span class="p">()</span>

            <span class="n">response</span> <span class="o">=</span> <span class="n">core_api</span><span class="o">.</span><span class="n">delete_namespaced_service_account</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">kubernetes_namespace</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Kubernetes API response: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">k8s_client</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">ApiException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
                <span class="c1"># the service account is no longer present, nothing to do</span>
                <span class="k">return</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Exception when deleting ServiceAccount resource </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">







  <div class="doc doc-object doc-attribute">



<h6 id="zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.config" class="doc doc-heading">
<code class="highlight language-python"><span class="n">config</span><span class="p">:</span> <span class="n">KServeModelDeployerConfig</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Returns the <code>KServeModelDeployerConfig</code> config.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>KServeModelDeployerConfig</code></td>
      <td><p>The configuration.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 id="zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.kserve_client" class="doc doc-heading">
<code class="highlight language-python"><span class="n">kserve_client</span><span class="p">:</span> <span class="n">KServeClient</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Get the KServe client associated with this model deployer.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>KServeClient</code></td>
      <td><p>The KServeclient.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>RuntimeError</code></td>
        <td><p>If the Kubernetes namespace is not configured in the
stack component when using a service connector to deploy models
with KServe.</p></td>
      </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 id="zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.validator" class="doc doc-heading">
<code class="highlight language-python"><span class="n">validator</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">zenml</span><span class="o">.</span><span class="n">stack</span><span class="o">.</span><span class="n">stack_validator</span><span class="o">.</span><span class="n">StackValidator</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Ensures there is a container registry and image builder in the stack.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[zenml.stack.stack_validator.StackValidator]</code></td>
      <td><p>A <code>StackValidator</code> instance.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>




  <div class="doc doc-object doc-class">



<h6 id="zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.FLAVOR" class="doc doc-heading">
        <code>
FLAVOR            (<a class="autorefs autorefs-internal" title="zenml.model_deployers.base_model_deployer.BaseModelDeployerFlavor" href="../../core_code_docs/core-model_deployers/#zenml.model_deployers.base_model_deployer.BaseModelDeployerFlavor">BaseModelDeployerFlavor</a>)
        </code>



</h6>

    <div class="doc doc-contents ">

      <p>Flavor for the KServe model deployer.</p>

        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/model_deployers/kserve_model_deployer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">KServeModelDeployerFlavor</span><span class="p">(</span><span class="n">BaseModelDeployerFlavor</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Flavor for the KServe model deployer.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Name of the flavor.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Name of the flavor.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">KSERVE_MODEL_DEPLOYER_FLAVOR</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">service_connector_requirements</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ServiceConnectorRequirements</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Service connector resource requirements for service connectors.</span>

<span class="sd">        Specifies resource requirements that are used to filter the available</span>
<span class="sd">        service connector types that are compatible with this flavor.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Requirements for compatible service connectors, if a service</span>
<span class="sd">            connector is required for this flavor.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">ServiceConnectorRequirements</span><span class="p">(</span>
            <span class="n">resource_type</span><span class="o">=</span><span class="n">KUBERNETES_CLUSTER_RESOURCE_TYPE</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">docs_url</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A url to point at docs explaining this flavor.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A flavor docs url.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_default_docs_url</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sdk_docs_url</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A url to point at SDK docs explaining this flavor.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A flavor SDK docs url.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_default_sdk_docs_url</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">logo_url</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A url to represent the flavor in the dashboard.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The flavor logo.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;https://public-flavor-logos.s3.eu-central-1.amazonaws.com/model_deployer/kserve.png&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">config_class</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">KServeModelDeployerConfig</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns `KServeModelDeployerConfig` config class.</span>

<span class="sd">        Returns:</span>
<span class="sd">                The config class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">KServeModelDeployerConfig</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">implementation_class</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="s2">&quot;KServeModelDeployer&quot;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Implementation class for this flavor.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The implementation class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">zenml.integrations.kserve.model_deployers</span> <span class="kn">import</span> <span class="p">(</span>
            <span class="n">KServeModelDeployer</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">KServeModelDeployer</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h7 id="zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.FLAVOR.config_class" class="doc doc-heading">
<code class="highlight language-python"><span class="n">config_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">zenml</span><span class="o">.</span><span class="n">integrations</span><span class="o">.</span><span class="n">kserve</span><span class="o">.</span><span class="n">flavors</span><span class="o">.</span><span class="n">kserve_model_deployer_flavor</span><span class="o">.</span><span class="n">KServeModelDeployerConfig</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>Returns <code>KServeModelDeployerConfig</code> config class.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Type[zenml.integrations.kserve.flavors.kserve_model_deployer_flavor.KServeModelDeployerConfig]</code></td>
      <td><p>The config class.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.FLAVOR.docs_url" class="doc doc-heading">
<code class="highlight language-python"><span class="n">docs_url</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>A url to point at docs explaining this flavor.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[str]</code></td>
      <td><p>A flavor docs url.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.FLAVOR.implementation_class" class="doc doc-heading">
<code class="highlight language-python"><span class="n">implementation_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">KServeModelDeployer</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>Implementation class for this flavor.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Type[KServeModelDeployer]</code></td>
      <td><p>The implementation class.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.FLAVOR.logo_url" class="doc doc-heading">
<code class="highlight language-python"><span class="n">logo_url</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>A url to represent the flavor in the dashboard.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The flavor logo.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.FLAVOR.name" class="doc doc-heading">
<code class="highlight language-python"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>Name of the flavor.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>Name of the flavor.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.FLAVOR.sdk_docs_url" class="doc doc-heading">
<code class="highlight language-python"><span class="n">sdk_docs_url</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>A url to point at SDK docs explaining this flavor.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[str]</code></td>
      <td><p>A flavor SDK docs url.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h7 id="zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.FLAVOR.service_connector_requirements" class="doc doc-heading">
<code class="highlight language-python"><span class="n">service_connector_requirements</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">zenml</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">service_connector_models</span><span class="o">.</span><span class="n">ServiceConnectorRequirements</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h7>

    <div class="doc doc-contents ">

      <p>Service connector resource requirements for service connectors.</p>
<p>Specifies resource requirements that are used to filter the available
service connector types that are compatible with this flavor.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[zenml.models.service_connector_models.ServiceConnectorRequirements]</code></td>
      <td><p>Requirements for compatible service connectors, if a service
connector is required for this flavor.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>








  </div>

    </div>

  </div>





  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.create_or_update_k8s_secret" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_or_update_k8s_secret</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">secret_values</span><span class="o">=</span><span class="p">{},</span> <span class="n">annotations</span><span class="o">=</span><span class="p">{})</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Create or update a Kubernetes Secret resource.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>name</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>the name of the Secret resource to create. If not
specified, a random name will be generated.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>secret_values</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>secret key-values that should be
stored in the Secret resource.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>annotations</code></td>
        <td><code>Dict[str, str]</code></td>
        <td><p>optional annotations to add to the Secret resource.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The name of the created Secret resource.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>RuntimeError</code></td>
        <td><p>if an unknown error occurs during the creation of
the secret.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/model_deployers/kserve_model_deployer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_or_update_k8s_secret</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">secret_values</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span>
    <span class="n">annotations</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create or update a Kubernetes Secret resource.</span>

<span class="sd">    Args:</span>
<span class="sd">        name: the name of the Secret resource to create. If not</span>
<span class="sd">            specified, a random name will be generated.</span>
<span class="sd">        secret_values: secret key-values that should be</span>
<span class="sd">            stored in the Secret resource.</span>
<span class="sd">        annotations: optional annotations to add to the Secret resource.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The name of the created Secret resource.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: if an unknown error occurs during the creation of</span>
<span class="sd">            the secret.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="sa">f</span><span class="s2">&quot;zenml-kserve-</span><span class="si">{</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating Secret resource: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">core_api</span> <span class="o">=</span> <span class="n">k8s_client</span><span class="o">.</span><span class="n">CoreV1Api</span><span class="p">()</span>

        <span class="n">secret_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">k</span><span class="p">:</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;ascii&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">secret_values</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="p">}</span>

        <span class="n">secret</span> <span class="o">=</span> <span class="n">k8s_client</span><span class="o">.</span><span class="n">V1Secret</span><span class="p">(</span>
            <span class="n">metadata</span><span class="o">=</span><span class="n">k8s_client</span><span class="o">.</span><span class="n">V1ObjectMeta</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;app&quot;</span><span class="p">:</span> <span class="s2">&quot;zenml&quot;</span><span class="p">},</span>
                <span class="n">annotations</span><span class="o">=</span><span class="n">annotations</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;Opaque&quot;</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">secret_data</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># check if the secret is already present</span>
            <span class="n">core_api</span><span class="o">.</span><span class="n">read_namespaced_secret</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">kubernetes_namespace</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="c1"># if we got this far, the secret is already present, update it</span>
            <span class="c1"># in place</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">core_api</span><span class="o">.</span><span class="n">replace_namespaced_secret</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">kubernetes_namespace</span><span class="p">,</span>
                <span class="n">body</span><span class="o">=</span><span class="n">secret</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="n">k8s_client</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">ApiException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">404</span><span class="p">:</span>
                <span class="c1"># if an error other than 404 is raised here, treat it</span>
                <span class="c1"># as an unexpected error</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="s2">&quot;Exception when reading Secret resource: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">core_api</span><span class="o">.</span><span class="n">create_namespaced_secret</span><span class="p">(</span>
                <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">kubernetes_namespace</span><span class="p">,</span>
                <span class="n">body</span><span class="o">=</span><span class="n">secret</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Kubernetes API response: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">k8s_client</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">ApiException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="s2">&quot;Exception when creating Secret resource </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">name</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.create_or_update_k8s_service_account" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_or_update_k8s_service_account</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">secret_name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Create or update a Kubernetes ServiceAccount resource with a secret managed by ZenML.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>name</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>the name of the ServiceAccount resource to create. If not
specified, a random name will be generated.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>secret_name</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>the name of a secret to attach to the ServiceAccount.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The name of the created ServiceAccount resource.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>RuntimeError</code></td>
        <td><p>if an unknown error occurs during the creation of
the service account.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/model_deployers/kserve_model_deployer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">create_or_update_k8s_service_account</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">secret_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create or update a Kubernetes ServiceAccount resource with a secret managed by ZenML.</span>

<span class="sd">    Args:</span>
<span class="sd">        name: the name of the ServiceAccount resource to create. If not</span>
<span class="sd">            specified, a random name will be generated.</span>
<span class="sd">        secret_name: the name of a secret to attach to the ServiceAccount.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The name of the created ServiceAccount resource.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: if an unknown error occurs during the creation of</span>
<span class="sd">            the service account.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="sa">f</span><span class="s2">&quot;zenml-kserve-</span><span class="si">{</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="n">service_account</span> <span class="o">=</span> <span class="n">k8s_client</span><span class="o">.</span><span class="n">V1ServiceAccount</span><span class="p">(</span>
        <span class="n">metadata</span><span class="o">=</span><span class="n">k8s_client</span><span class="o">.</span><span class="n">V1ObjectMeta</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">secret_name</span><span class="p">:</span>
        <span class="n">service_account</span><span class="o">.</span><span class="n">secrets</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">k8s_client</span><span class="o">.</span><span class="n">V1ObjectReference</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;Secret&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">secret_name</span><span class="p">)</span>
        <span class="p">]</span>

    <span class="n">core_api</span> <span class="o">=</span> <span class="n">k8s_client</span><span class="o">.</span><span class="n">CoreV1Api</span><span class="p">()</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># check if the service account is already present</span>
        <span class="n">core_api</span><span class="o">.</span><span class="n">read_namespaced_service_account</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">kubernetes_namespace</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="c1"># if we got this far, the service account is already present, update</span>
        <span class="c1"># it in place</span>
        <span class="n">core_api</span><span class="o">.</span><span class="n">replace_namespaced_service_account</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">kubernetes_namespace</span><span class="p">,</span>
            <span class="n">body</span><span class="o">=</span><span class="n">service_account</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="n">k8s_client</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">ApiException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">404</span><span class="p">:</span>
            <span class="c1"># if an error other than 404 is raised here, treat it</span>
            <span class="c1"># as an unexpected error</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;Exception when reading ServiceAccount resource: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="n">core_api</span><span class="o">.</span><span class="n">create_namespaced_service_account</span><span class="p">(</span>
            <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">kubernetes_namespace</span><span class="p">,</span>
            <span class="n">body</span><span class="o">=</span><span class="n">service_account</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">name</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.delete_k8s_secret" class="doc doc-heading">
<code class="highlight language-python"><span class="n">delete_k8s_secret</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Delete a Kubernetes Secret resource managed by ZenML.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>name</code></td>
        <td><code>str</code></td>
        <td><p>the name of the Kubernetes Secret resource to delete.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>RuntimeError</code></td>
        <td><p>if an unknown error occurs during the removal
of the secret.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/model_deployers/kserve_model_deployer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">delete_k8s_secret</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete a Kubernetes Secret resource managed by ZenML.</span>

<span class="sd">    Args:</span>
<span class="sd">        name: the name of the Kubernetes Secret resource to delete.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: if an unknown error occurs during the removal</span>
<span class="sd">            of the secret.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Deleting Secret resource: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">core_api</span> <span class="o">=</span> <span class="n">k8s_client</span><span class="o">.</span><span class="n">CoreV1Api</span><span class="p">()</span>

        <span class="n">response</span> <span class="o">=</span> <span class="n">core_api</span><span class="o">.</span><span class="n">delete_namespaced_secret</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">kubernetes_namespace</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Kubernetes API response: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">k8s_client</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">ApiException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
            <span class="c1"># the secret is no longer present, nothing to do</span>
            <span class="k">return</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Exception when deleting Secret resource </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.delete_k8s_service_account" class="doc doc-heading">
<code class="highlight language-python"><span class="n">delete_k8s_service_account</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Delete a Kubernetes ServiceAccount resource managed by ZenML.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>name</code></td>
        <td><code>str</code></td>
        <td><p>the name of the Kubernetes ServiceAccount resource to delete.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>RuntimeError</code></td>
        <td><p>if an unknown error occurs during the removal
of the service account.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/model_deployers/kserve_model_deployer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">delete_k8s_service_account</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete a Kubernetes ServiceAccount resource managed by ZenML.</span>

<span class="sd">    Args:</span>
<span class="sd">        name: the name of the Kubernetes ServiceAccount resource to delete.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: if an unknown error occurs during the removal</span>
<span class="sd">            of the service account.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Deleting ServiceAccount resource: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">core_api</span> <span class="o">=</span> <span class="n">k8s_client</span><span class="o">.</span><span class="n">CoreV1Api</span><span class="p">()</span>

        <span class="n">response</span> <span class="o">=</span> <span class="n">core_api</span><span class="o">.</span><span class="n">delete_namespaced_service_account</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">namespace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">kubernetes_namespace</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Kubernetes API response: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">k8s_client</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">ApiException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
            <span class="c1"># the service account is no longer present, nothing to do</span>
            <span class="k">return</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Exception when deleting ServiceAccount resource </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.delete_model_server" class="doc doc-heading">
<code class="highlight language-python"><span class="n">delete_model_server</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uuid</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Delete a KServe model deployment server.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>uuid</code></td>
        <td><code>UUID</code></td>
        <td><p>UUID of the model server to delete.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>timeout</code></td>
        <td><code>int</code></td>
        <td><p>timeout in seconds to wait for the service to stop. If
set to 0, the method will return immediately after
deprovisioning the service, without waiting for it to stop.</p></td>
        <td><code>300</code></td>
      </tr>
      <tr>
        <td><code>force</code></td>
        <td><code>bool</code></td>
        <td><p>if True, force the service to stop.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/model_deployers/kserve_model_deployer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">delete_model_server</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">uuid</span><span class="p">:</span> <span class="n">UUID</span><span class="p">,</span>
    <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">DEFAULT_KSERVE_DEPLOYMENT_START_STOP_TIMEOUT</span><span class="p">,</span>
    <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete a KServe model deployment server.</span>

<span class="sd">    Args:</span>
<span class="sd">        uuid: UUID of the model server to delete.</span>
<span class="sd">        timeout: timeout in seconds to wait for the service to stop. If</span>
<span class="sd">            set to 0, the method will return immediately after</span>
<span class="sd">            deprovisioning the service, without waiting for it to stop.</span>
<span class="sd">        force: if True, force the service to stop.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">services</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_model_server</span><span class="p">(</span><span class="n">service_uuid</span><span class="o">=</span><span class="n">uuid</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">services</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="n">service</span> <span class="o">=</span> <span class="n">services</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">service</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="n">force</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">service</span><span class="p">,</span> <span class="n">KServeDeploymentService</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">service</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">k8s_service_account</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delete_k8s_service_account</span><span class="p">(</span><span class="n">service</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">k8s_service_account</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">service</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">k8s_secret</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delete_k8s_secret</span><span class="p">(</span><span class="n">service</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">k8s_secret</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.deploy_model" class="doc doc-heading">
<code class="highlight language-python"><span class="n">deploy_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Create a new KServe deployment or update an existing one.</p>
<p>This method has two modes of operation, depending on the <code>replace</code>
argument value:</p>
<ul>
<li>
<p>if <code>replace</code> is False, calling this method will create a new KServe
    deployment server to reflect the model and other configuration
    parameters specified in the supplied KServe deployment <code>config</code>.</p>
</li>
<li>
<p>if <code>replace</code> is True, this method will first attempt to find an
    existing KServe deployment that is <em>equivalent</em> to the supplied
    configuration parameters. Two or more KServe deployments are
    considered equivalent if they have the same <code>pipeline_name</code>,
    <code>pipeline_step_name</code> and <code>model_name</code> configuration parameters. To
    put it differently, two KServe deployments are equivalent if
    they serve versions of the same model deployed by the same pipeline
    step. If an equivalent KServe deployment is found, it will be
    updated in place to reflect the new configuration parameters. This
    allows an existing KServe deployment to retain its prediction
    URL while performing a rolling update to serve a new model version.</p>
</li>
</ul>
<p>Callers should set <code>replace</code> to True if they want a continuous model
deployment workflow that doesn't spin up a new KServe deployment
server for each new model version. If multiple equivalent KServe
deployments are found, the most recently created deployment is selected
to be updated and the others are deleted.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>config</code></td>
        <td><code>ServiceConfig</code></td>
        <td><p>the configuration of the model to be deployed with KServe.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>replace</code></td>
        <td><code>bool</code></td>
        <td><p>set this flag to True to find and update an equivalent
KServeDeployment server with the new model instead of
starting a new deployment server.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>timeout</code></td>
        <td><code>int</code></td>
        <td><p>the timeout in seconds to wait for the KServe server
to be provisioned and successfully started or updated. If set
to 0, the method will return immediately after the KServe
server is provisioned, without waiting for it to fully start.</p></td>
        <td><code>300</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>BaseService</code></td>
      <td><p>The ZenML KServe deployment service object that can be used to
interact with the remote KServe server.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>RuntimeError</code></td>
        <td><p>if the KServe deployment server could not be stopped.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/model_deployers/kserve_model_deployer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">deploy_model</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">config</span><span class="p">:</span> <span class="n">ServiceConfig</span><span class="p">,</span>
    <span class="n">replace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">DEFAULT_KSERVE_DEPLOYMENT_START_STOP_TIMEOUT</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaseService</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a new KServe deployment or update an existing one.</span>

<span class="sd">    This method has two modes of operation, depending on the `replace`</span>
<span class="sd">    argument value:</span>

<span class="sd">      * if `replace` is False, calling this method will create a new KServe</span>
<span class="sd">        deployment server to reflect the model and other configuration</span>
<span class="sd">        parameters specified in the supplied KServe deployment `config`.</span>

<span class="sd">      * if `replace` is True, this method will first attempt to find an</span>
<span class="sd">        existing KServe deployment that is *equivalent* to the supplied</span>
<span class="sd">        configuration parameters. Two or more KServe deployments are</span>
<span class="sd">        considered equivalent if they have the same `pipeline_name`,</span>
<span class="sd">        `pipeline_step_name` and `model_name` configuration parameters. To</span>
<span class="sd">        put it differently, two KServe deployments are equivalent if</span>
<span class="sd">        they serve versions of the same model deployed by the same pipeline</span>
<span class="sd">        step. If an equivalent KServe deployment is found, it will be</span>
<span class="sd">        updated in place to reflect the new configuration parameters. This</span>
<span class="sd">        allows an existing KServe deployment to retain its prediction</span>
<span class="sd">        URL while performing a rolling update to serve a new model version.</span>

<span class="sd">    Callers should set `replace` to True if they want a continuous model</span>
<span class="sd">    deployment workflow that doesn&#39;t spin up a new KServe deployment</span>
<span class="sd">    server for each new model version. If multiple equivalent KServe</span>
<span class="sd">    deployments are found, the most recently created deployment is selected</span>
<span class="sd">    to be updated and the others are deleted.</span>

<span class="sd">    Args:</span>
<span class="sd">        config: the configuration of the model to be deployed with KServe.</span>
<span class="sd">        replace: set this flag to True to find and update an equivalent</span>
<span class="sd">            KServeDeployment server with the new model instead of</span>
<span class="sd">            starting a new deployment server.</span>
<span class="sd">        timeout: the timeout in seconds to wait for the KServe server</span>
<span class="sd">            to be provisioned and successfully started or updated. If set</span>
<span class="sd">            to 0, the method will return immediately after the KServe</span>
<span class="sd">            server is provisioned, without waiting for it to fully start.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The ZenML KServe deployment service object that can be used to</span>
<span class="sd">        interact with the remote KServe server.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: if the KServe deployment server could not be stopped.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">event_handler</span><span class="p">(</span>
        <span class="n">event</span><span class="o">=</span><span class="n">AnalyticsEvent</span><span class="o">.</span><span class="n">MODEL_DEPLOYED</span><span class="p">,</span> <span class="n">v2</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">analytics_handler</span><span class="p">:</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">KServeDeploymentConfig</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
        <span class="n">service</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># if replace is True, find equivalent KServe deployments</span>
        <span class="k">if</span> <span class="n">replace</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">equivalent_services</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_model_server</span><span class="p">(</span>
                <span class="n">running</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">pipeline_name</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">pipeline_name</span><span class="p">,</span>
                <span class="n">pipeline_step_name</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">pipeline_step_name</span><span class="p">,</span>
                <span class="n">model_name</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">model_name</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">for</span> <span class="n">equivalent_service</span> <span class="ow">in</span> <span class="n">equivalent_services</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">service</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="c1"># keep the most recently created service</span>
                    <span class="n">service</span> <span class="o">=</span> <span class="n">equivalent_service</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="c1"># delete the older services and don&#39;t wait for</span>
                        <span class="c1"># them to be deprovisioned</span>
                        <span class="n">service</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
                    <span class="k">except</span> <span class="ne">RuntimeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                            <span class="s2">&quot;Failed to stop the KServe deployment &quot;</span>
                            <span class="s2">&quot;server:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
                            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;Please stop it manually and try again.&quot;</span><span class="p">,</span>
                        <span class="p">)</span>

        <span class="k">if</span> <span class="n">service</span><span class="p">:</span>
            <span class="c1"># Reuse the service account and secret from the existing</span>
            <span class="c1"># service.</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">service</span><span class="p">,</span> <span class="n">KServeDeploymentService</span><span class="p">)</span>
            <span class="n">config</span><span class="o">.</span><span class="n">k8s_service_account</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">k8s_service_account</span>
            <span class="n">config</span><span class="o">.</span><span class="n">k8s_secret</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">k8s_secret</span>

        <span class="c1"># configure the credentials for the KServe model server</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_create_or_update_kserve_credentials</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">service</span><span class="p">:</span>
            <span class="c1"># update an equivalent service in place</span>
            <span class="n">service</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Updating an existing KServe deployment service: </span><span class="si">{</span><span class="n">service</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># create a new service</span>
            <span class="n">service</span> <span class="o">=</span> <span class="n">KServeDeploymentService</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Creating a new KServe deployment service: </span><span class="si">{</span><span class="n">service</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="c1"># start the service which in turn provisions the KServe</span>
        <span class="c1"># deployment server and waits for it to reach a ready state</span>
        <span class="n">service</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>

        <span class="c1"># Add telemetry with metadata that gets the stack metadata and</span>
        <span class="c1"># differentiates between pure model and custom code deployments</span>
        <span class="n">stack</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">active_stack</span>
        <span class="n">stack_metadata</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">component_type</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="n">component</span><span class="o">.</span><span class="n">flavor</span>
            <span class="k">for</span> <span class="n">component_type</span><span class="p">,</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">stack</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="n">analytics_handler</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;store_type&quot;</span><span class="p">:</span> <span class="n">Client</span><span class="p">()</span><span class="o">.</span><span class="n">zen_store</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
            <span class="o">**</span><span class="n">stack_metadata</span><span class="p">,</span>
            <span class="s2">&quot;is_custom_code_deployment&quot;</span><span class="p">:</span> <span class="n">config</span><span class="o">.</span><span class="n">container</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="k">return</span> <span class="n">service</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.find_model_server" class="doc doc-heading">
<code class="highlight language-python"><span class="n">find_model_server</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">running</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">service_uuid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pipeline_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">run_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pipeline_step_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">model_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">model_uri</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">predictor</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Find one or more KServe model services that match the given criteria.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>running</code></td>
        <td><code>bool</code></td>
        <td><p>If true, only running services will be returned.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>service_uuid</code></td>
        <td><code>Optional[uuid.UUID]</code></td>
        <td><p>The UUID of the service that was originally used
to deploy the model.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>pipeline_name</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>name of the pipeline that the deployed model was part
of.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>run_name</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>name of the pipeline run which the deployed model was
part of.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>pipeline_step_name</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>the name of the pipeline model deployment step
that deployed the model.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>model_name</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>the name of the deployed model.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>model_uri</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>URI of the deployed model.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>predictor</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>the name of the predictor that was used to deploy the model.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[zenml.services.service.BaseService]</code></td>
      <td><p>One or more Service objects representing model servers that match
the input search criteria.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/model_deployers/kserve_model_deployer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">find_model_server</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">running</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">service_uuid</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">UUID</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">pipeline_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">run_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">pipeline_step_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">model_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">model_uri</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">predictor</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">BaseService</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Find one or more KServe model services that match the given criteria.</span>

<span class="sd">    Args:</span>
<span class="sd">        running: If true, only running services will be returned.</span>
<span class="sd">        service_uuid: The UUID of the service that was originally used</span>
<span class="sd">            to deploy the model.</span>
<span class="sd">        pipeline_name: name of the pipeline that the deployed model was part</span>
<span class="sd">            of.</span>
<span class="sd">        run_name: name of the pipeline run which the deployed model was</span>
<span class="sd">            part of.</span>
<span class="sd">        pipeline_step_name: the name of the pipeline model deployment step</span>
<span class="sd">            that deployed the model.</span>
<span class="sd">        model_name: the name of the deployed model.</span>
<span class="sd">        model_uri: URI of the deployed model.</span>
<span class="sd">        predictor: the name of the predictor that was used to deploy the model.</span>

<span class="sd">    Returns:</span>
<span class="sd">        One or more Service objects representing model servers that match</span>
<span class="sd">        the input search criteria.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">KServeDeploymentConfig</span><span class="p">(</span>
        <span class="n">pipeline_name</span><span class="o">=</span><span class="n">pipeline_name</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">run_name</span><span class="o">=</span><span class="n">run_name</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">pipeline_run_id</span><span class="o">=</span><span class="n">run_name</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">pipeline_step_name</span><span class="o">=</span><span class="n">pipeline_step_name</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">model_uri</span><span class="o">=</span><span class="n">model_uri</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">model_name</span><span class="o">=</span><span class="n">model_name</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">predictor</span><span class="o">=</span><span class="n">predictor</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">resources</span><span class="o">=</span><span class="p">{},</span>
    <span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get_kubernetes_labels</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">service_uuid</span><span class="p">:</span>
        <span class="n">labels</span><span class="p">[</span><span class="s2">&quot;zenml.service_uuid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">service_uuid</span><span class="p">)</span>

    <span class="n">deployments</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_kserve_deployments</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>

    <span class="n">services</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">BaseService</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">deployment</span> <span class="ow">in</span> <span class="n">deployments</span><span class="p">:</span>
        <span class="c1"># recreate the KServe deployment service object from the KServe</span>
        <span class="c1"># deployment resource</span>
        <span class="n">service</span> <span class="o">=</span> <span class="n">KServeDeploymentService</span><span class="o">.</span><span class="n">create_from_deployment</span><span class="p">(</span>
            <span class="n">deployment</span><span class="o">=</span><span class="n">deployment</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">running</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">service</span><span class="o">.</span><span class="n">is_running</span><span class="p">:</span>
            <span class="c1"># skip non-running services</span>
            <span class="k">continue</span>
        <span class="n">services</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">service</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">services</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.get_docker_builds" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_docker_builds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deployment</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Gets the Docker builds required for the component.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>deployment</code></td>
        <td><code>PipelineDeploymentBaseModel</code></td>
        <td><p>The pipeline deployment for which to get the builds.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[BuildConfiguration]</code></td>
      <td><p>The required Docker builds.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/model_deployers/kserve_model_deployer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_docker_builds</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">deployment</span><span class="p">:</span> <span class="s2">&quot;PipelineDeploymentBaseModel&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="s2">&quot;BuildConfiguration&quot;</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the Docker builds required for the component.</span>

<span class="sd">    Args:</span>
<span class="sd">        deployment: The pipeline deployment for which to get the builds.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The required Docker builds.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">builds</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">step_name</span><span class="p">,</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">deployment</span><span class="o">.</span><span class="n">step_configurations</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">step</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">extra</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">KSERVE_CUSTOM_DEPLOYMENT</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">build</span> <span class="o">=</span> <span class="n">BuildConfiguration</span><span class="p">(</span>
                <span class="n">key</span><span class="o">=</span><span class="n">KSERVE_DOCKER_IMAGE_KEY</span><span class="p">,</span>
                <span class="n">settings</span><span class="o">=</span><span class="n">step</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">docker_settings</span><span class="p">,</span>
                <span class="n">step_name</span><span class="o">=</span><span class="n">step_name</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">builds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">build</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">builds</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.get_kserve_deployments" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_kserve_deployments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Get a list of KServe deployments that match the supplied labels.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>labels</code></td>
        <td><code>Dict[str, str]</code></td>
        <td><p>a dictionary of labels to match against KServe deployments.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[kserve.models.v1beta1_inference_service.V1beta1InferenceService]</code></td>
      <td><p>A list of KServe deployments that match the supplied labels.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>RuntimeError</code></td>
        <td><p>if an operational failure is encountered while</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/model_deployers/kserve_model_deployer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_kserve_deployments</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">labels</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">V1beta1InferenceService</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a list of KServe deployments that match the supplied labels.</span>

<span class="sd">    Args:</span>
<span class="sd">        labels: a dictionary of labels to match against KServe deployments.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of KServe deployments that match the supplied labels.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: if an operational failure is encountered while</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">label_selector</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">())</span> <span class="k">if</span> <span class="n">labels</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="p">)</span>

    <span class="n">namespace</span> <span class="o">=</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">kubernetes_namespace</span>
        <span class="ow">or</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_default_target_namespace</span><span class="p">()</span>
    <span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kserve_client</span><span class="o">.</span><span class="n">api_instance</span><span class="o">.</span><span class="n">list_namespaced_custom_object</span><span class="p">(</span>
                <span class="n">constants</span><span class="o">.</span><span class="n">KSERVE_GROUP</span><span class="p">,</span>
                <span class="n">constants</span><span class="o">.</span><span class="n">KSERVE_V1BETA1_VERSION</span><span class="p">,</span>
                <span class="n">namespace</span><span class="p">,</span>
                <span class="n">constants</span><span class="o">.</span><span class="n">KSERVE_PLURAL</span><span class="p">,</span>
                <span class="n">label_selector</span><span class="o">=</span><span class="n">label_selector</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="n">k8s_client</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">ApiException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="s2">&quot;Exception when retrieving KServe inference services</span><span class="se">\</span>
<span class="s2">            </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="o">%</span> <span class="n">e</span>
        <span class="p">)</span>

    <span class="c1"># TODO[CRITICAL]: de-serialize each item into a complete</span>
    <span class="c1">#   V1beta1InferenceService object recursively using the OpenApi</span>
    <span class="c1">#   schema (this doesn&#39;t work right now)</span>
    <span class="n">inference_services</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">V1beta1InferenceService</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;items&quot;</span><span class="p">,</span> <span class="p">[]):</span>
        <span class="n">snake_case_item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_camel_to_snake</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">inference_service</span> <span class="o">=</span> <span class="n">V1beta1InferenceService</span><span class="p">(</span><span class="o">**</span><span class="n">snake_case_item</span><span class="p">)</span>
        <span class="n">inference_services</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inference_service</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">inference_services</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.get_model_server_info" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_model_server_info</span><span class="p">(</span><span class="n">service_instance</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Return implementation specific information on the model server.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>service_instance</code></td>
        <td><code>KServeDeploymentService</code></td>
        <td><p>KServe deployment service object</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Dict[str, Optional[str]]</code></td>
      <td><p>A dictionary containing the model server information.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/model_deployers/kserve_model_deployer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">get_model_server_info</span><span class="p">(</span>  <span class="c1"># type: ignore[override]</span>
    <span class="n">service_instance</span><span class="p">:</span> <span class="s2">&quot;KServeDeploymentService&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return implementation specific information on the model server.</span>

<span class="sd">    Args:</span>
<span class="sd">        service_instance: KServe deployment service object</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dictionary containing the model server information.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;PREDICTION_URL&quot;</span><span class="p">:</span> <span class="n">service_instance</span><span class="o">.</span><span class="n">prediction_url</span><span class="p">,</span>
        <span class="s2">&quot;PREDICTION_HOSTNAME&quot;</span><span class="p">:</span> <span class="n">service_instance</span><span class="o">.</span><span class="n">prediction_hostname</span><span class="p">,</span>
        <span class="s2">&quot;MODEL_URI&quot;</span><span class="p">:</span> <span class="n">service_instance</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">model_uri</span><span class="p">,</span>
        <span class="s2">&quot;MODEL_NAME&quot;</span><span class="p">:</span> <span class="n">service_instance</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">model_name</span><span class="p">,</span>
        <span class="s2">&quot;KSERVE_INFERENCE_SERVICE&quot;</span><span class="p">:</span> <span class="n">service_instance</span><span class="o">.</span><span class="n">crd_name</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.start_model_server" class="doc doc-heading">
<code class="highlight language-python"><span class="n">start_model_server</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uuid</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Start a KServe model deployment server.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>uuid</code></td>
        <td><code>UUID</code></td>
        <td><p>UUID of the model server to start.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>timeout</code></td>
        <td><code>int</code></td>
        <td><p>timeout in seconds to wait for the service to become
active. . If set to 0, the method will return immediately after
provisioning the service, without waiting for it to become
active.</p></td>
        <td><code>300</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>NotImplementedError</code></td>
        <td><p>since we don't support starting KServe
model servers</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/model_deployers/kserve_model_deployer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">start_model_server</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">uuid</span><span class="p">:</span> <span class="n">UUID</span><span class="p">,</span>
    <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">DEFAULT_KSERVE_DEPLOYMENT_START_STOP_TIMEOUT</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Start a KServe model deployment server.</span>

<span class="sd">    Args:</span>
<span class="sd">        uuid: UUID of the model server to start.</span>
<span class="sd">        timeout: timeout in seconds to wait for the service to become</span>
<span class="sd">            active. . If set to 0, the method will return immediately after</span>
<span class="sd">            provisioning the service, without waiting for it to become</span>
<span class="sd">            active.</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotImplementedError: since we don&#39;t support starting KServe</span>
<span class="sd">            model servers</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
        <span class="s2">&quot;Starting KServe model servers is not implemented&quot;</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.kserve.model_deployers.kserve_model_deployer.KServeModelDeployer.stop_model_server" class="doc doc-heading">
<code class="highlight language-python"><span class="n">stop_model_server</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uuid</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Stop a KServe model server.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>uuid</code></td>
        <td><code>UUID</code></td>
        <td><p>UUID of the model server to stop.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>timeout</code></td>
        <td><code>int</code></td>
        <td><p>timeout in seconds to wait for the service to stop.</p></td>
        <td><code>300</code></td>
      </tr>
      <tr>
        <td><code>force</code></td>
        <td><code>bool</code></td>
        <td><p>if True, force the service to stop.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>NotImplementedError</code></td>
        <td><p>stopping on KServe model servers is not
supported.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/model_deployers/kserve_model_deployer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">stop_model_server</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">uuid</span><span class="p">:</span> <span class="n">UUID</span><span class="p">,</span>
    <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">DEFAULT_KSERVE_DEPLOYMENT_START_STOP_TIMEOUT</span><span class="p">,</span>
    <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Stop a KServe model server.</span>

<span class="sd">    Args:</span>
<span class="sd">        uuid: UUID of the model server to stop.</span>
<span class="sd">        timeout: timeout in seconds to wait for the service to stop.</span>
<span class="sd">        force: if True, force the service to stop.</span>

<span class="sd">    Raises:</span>
<span class="sd">        NotImplementedError: stopping on KServe model servers is not</span>
<span class="sd">            supported.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
        <span class="s2">&quot;Stopping KServe model servers is not implemented. Try &quot;</span>
        <span class="s2">&quot;deleting the KServe model server instead.&quot;</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="zenml.integrations.kserve.model_deployers.kserve_model_deployer.KubeClientKServeClient" class="doc doc-heading">
        <code>
KubeClientKServeClient            (<span title="kserve.api.kserve_client.KServeClient">KServeClient</span>)
        </code>



</h5>

    <div class="doc doc-contents ">

      <p>KServe client initialized from a Kubernetes client.</p>
<p>This is a workaround for the fact that the native KServe client does not
support initialization from an existing Kubernetes client.</p>

        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/model_deployers/kserve_model_deployer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">KubeClientKServeClient</span><span class="p">(</span><span class="n">KServeClient</span><span class="p">):</span>  <span class="c1"># type: ignore[misc]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;KServe client initialized from a Kubernetes client.</span>

<span class="sd">    This is a workaround for the fact that the native KServe client does not</span>
<span class="sd">    support initialization from an existing Kubernetes client.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">kube_client</span><span class="p">:</span> <span class="n">k8s_client</span><span class="o">.</span><span class="n">ApiClient</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes the KServe client from a Kubernetes client.</span>

<span class="sd">        Args:</span>
<span class="sd">            kube_client: pre-configured Kubernetes client.</span>
<span class="sd">            *args: standard KServe client positional arguments.</span>
<span class="sd">            **kwargs: standard KServe client keyword arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">kubernetes</span> <span class="kn">import</span> <span class="n">client</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">core_api</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">CoreV1Api</span><span class="p">(</span><span class="n">kube_client</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app_api</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">AppsV1Api</span><span class="p">(</span><span class="n">kube_client</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_instance</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">CustomObjectsApi</span><span class="p">(</span><span class="n">kube_client</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.kserve.model_deployers.kserve_model_deployer.KubeClientKServeClient.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kube_client</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Initializes the KServe client from a Kubernetes client.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>kube_client</code></td>
        <td><code>ApiClient</code></td>
        <td><p>pre-configured Kubernetes client.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>*args</code></td>
        <td><code>Any</code></td>
        <td><p>standard KServe client positional arguments.</p></td>
        <td><code>()</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td><code>Any</code></td>
        <td><p>standard KServe client keyword arguments.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/model_deployers/kserve_model_deployer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">kube_client</span><span class="p">:</span> <span class="n">k8s_client</span><span class="o">.</span><span class="n">ApiClient</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the KServe client from a Kubernetes client.</span>

<span class="sd">    Args:</span>
<span class="sd">        kube_client: pre-configured Kubernetes client.</span>
<span class="sd">        *args: standard KServe client positional arguments.</span>
<span class="sd">        **kwargs: standard KServe client keyword arguments.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">kubernetes</span> <span class="kn">import</span> <span class="n">client</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">core_api</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">CoreV1Api</span><span class="p">(</span><span class="n">kube_client</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_api</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">AppsV1Api</span><span class="p">(</span><span class="n">kube_client</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">api_instance</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">CustomObjectsApi</span><span class="p">(</span><span class="n">kube_client</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>







  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="zenml.integrations.kserve.secret_schemas" class="doc doc-heading">
        <code>secret_schemas</code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Initialization of Kserve Secret Schemas.</p>
<p>These are secret schemas that can be used to authenticate Kserve to the
Artifact Store used to store served ML models.</p>



  <div class="doc doc-children">











  <div class="doc doc-object doc-module">



<h4 id="zenml.integrations.kserve.secret_schemas.secret_schemas" class="doc doc-heading">
        <code>secret_schemas</code>



</h4>

    <div class="doc doc-contents ">

      <p>Implementation for KServe secret schemas.</p>



  <div class="doc doc-children">










  <div class="doc doc-object doc-class">



<h5 id="zenml.integrations.kserve.secret_schemas.secret_schemas.KServeAzureSecretSchema" class="doc doc-heading">
        <code>
KServeAzureSecretSchema            (<a class="autorefs autorefs-internal" title="zenml.secret.base_secret.BaseSecretSchema" href="../../core_code_docs/core-secret/#zenml.secret.base_secret.BaseSecretSchema">BaseSecretSchema</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-model"><code>pydantic-model</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>KServe Azure Blob Storage credentials.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>azure_client_id</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>the Azure client ID.</p></td>
      </tr>
      <tr>
        <td><code>azure_client_secret</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>the Azure client secret.</p></td>
      </tr>
      <tr>
        <td><code>azure_tenant_id</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>the Azure tenant ID.</p></td>
      </tr>
      <tr>
        <td><code>azure_subscription_id</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>the Azure subscription ID.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/secret_schemas/secret_schemas.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">KServeAzureSecretSchema</span><span class="p">(</span><span class="n">BaseSecretSchema</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;KServe Azure Blob Storage credentials.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        azure_client_id: the Azure client ID.</span>
<span class="sd">        azure_client_secret: the Azure client secret.</span>
<span class="sd">        azure_tenant_id: the Azure tenant ID.</span>
<span class="sd">        azure_subscription_id: the Azure subscription ID.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">TYPE</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">KSERVE_AZUREBLOB_SECRET_SCHEMA_TYPE</span>

    <span class="n">azure_client_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">azure_client_secret</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">azure_tenant_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">azure_subscription_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">



















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="zenml.integrations.kserve.secret_schemas.secret_schemas.KServeGSSecretSchema" class="doc doc-heading">
        <code>
KServeGSSecretSchema            (<a class="autorefs autorefs-internal" title="zenml.secret.base_secret.BaseSecretSchema" href="../../core_code_docs/core-secret/#zenml.secret.base_secret.BaseSecretSchema">BaseSecretSchema</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-model"><code>pydantic-model</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>KServe GCS credentials.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>google_application_credentials</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>the GCP application credentials to use,
in JSON format.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/secret_schemas/secret_schemas.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">KServeGSSecretSchema</span><span class="p">(</span><span class="n">BaseSecretSchema</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;KServe GCS credentials.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        google_application_credentials: the GCP application credentials to use,</span>
<span class="sd">            in JSON format.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">TYPE</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">KSERVE_GS_SECRET_SCHEMA_TYPE</span>

    <span class="n">google_application_credentials</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">
















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="zenml.integrations.kserve.secret_schemas.secret_schemas.KServeS3SecretSchema" class="doc doc-heading">
        <code>
KServeS3SecretSchema            (<a class="autorefs autorefs-internal" title="zenml.secret.base_secret.BaseSecretSchema" href="../../core_code_docs/core-secret/#zenml.secret.base_secret.BaseSecretSchema">BaseSecretSchema</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-model"><code>pydantic-model</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>KServe S3 credentials.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>aws_access_key_id</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>the AWS access key ID.</p></td>
      </tr>
      <tr>
        <td><code>aws_secret_access_key</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>the AWS secret access key.</p></td>
      </tr>
      <tr>
        <td><code>s3_endpoint</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>the S3 endpoint.</p></td>
      </tr>
      <tr>
        <td><code>s3_region</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>the S3 region.</p></td>
      </tr>
      <tr>
        <td><code>s3_use_https</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>whether to use HTTPS.</p></td>
      </tr>
      <tr>
        <td><code>s3_verify_ssl</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>whether to verify SSL.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/secret_schemas/secret_schemas.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">KServeS3SecretSchema</span><span class="p">(</span><span class="n">BaseSecretSchema</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;KServe S3 credentials.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        aws_access_key_id: the AWS access key ID.</span>
<span class="sd">        aws_secret_access_key: the AWS secret access key.</span>
<span class="sd">        s3_endpoint: the S3 endpoint.</span>
<span class="sd">        s3_region: the S3 region.</span>
<span class="sd">        s3_use_https: whether to use HTTPS.</span>
<span class="sd">        s3_verify_ssl: whether to verify SSL.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">TYPE</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">KSERVE_S3_SECRET_SCHEMA_TYPE</span>

    <span class="n">aws_access_key_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">aws_secret_access_key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">s3_endpoint</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">s3_region</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">s3_use_https</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">s3_verify_ssl</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">





















  </div>

    </div>

  </div>







  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="zenml.integrations.kserve.services" class="doc doc-heading">
        <code>services</code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Initialization for KServe services.</p>



  <div class="doc doc-children">










  <div class="doc doc-object doc-module">



<h4 id="zenml.integrations.kserve.services.kserve_deployment" class="doc doc-heading">
        <code>kserve_deployment</code>



</h4>

    <div class="doc doc-contents ">

      <p>Implementation for the KServe inference service.</p>



  <div class="doc doc-children">








  <div class="doc doc-object doc-class">



<h5 id="zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentConfig" class="doc doc-heading">
        <code>
KServeDeploymentConfig            (<a class="autorefs autorefs-internal" title="zenml.services.service.ServiceConfig" href="../../core_code_docs/core-services/#zenml.services.service.ServiceConfig">ServiceConfig</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-model"><code>pydantic-model</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>KServe deployment service configuration.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>model_uri</code></td>
        <td><code>str</code></td>
        <td><p>URI of the model (or models) to serve.</p></td>
      </tr>
      <tr>
        <td><code>model_name</code></td>
        <td><code>str</code></td>
        <td><p>the name of the model. Multiple versions of the same model
should use the same model name. Model name must use only lowercase
alphanumeric characters and dashes.</p></td>
      </tr>
      <tr>
        <td><code>secret_name</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>the name of the ZenML secret containing credentials
required to authenticate to the artifact store.</p></td>
      </tr>
      <tr>
        <td><code>k8s_secret</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>the name of the Kubernetes secret to use for the prediction
service.</p></td>
      </tr>
      <tr>
        <td><code>k8s_service_account</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>the name of the Kubernetes service account to use
for the prediction service.</p></td>
      </tr>
      <tr>
        <td><code>predictor</code></td>
        <td><code>str</code></td>
        <td><p>the KServe predictor used to serve the model. The</p></td>
      </tr>
      <tr>
        <td><code>predictor</code></td>
        <td><code>type can be one of the following</code></td>
        <td><p><code>tensorflow</code>, <code>pytorch</code>,</p></td>
      </tr>
      <tr>
        <td><code>replicas</code></td>
        <td><code>int</code></td>
        <td><p>number of replicas to use for the prediction service.</p></td>
      </tr>
      <tr>
        <td><code>resources</code></td>
        <td><code>Optional[Dict[str, Any]]</code></td>
        <td><p>the Kubernetes resources to allocate for the prediction service.</p></td>
      </tr>
      <tr>
        <td><code>container</code></td>
        <td><code>Optional[Dict[str, Any]]</code></td>
        <td><p>the container to use for the custom prediction services.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/services/kserve_deployment.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">KServeDeploymentConfig</span><span class="p">(</span><span class="n">ServiceConfig</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;KServe deployment service configuration.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        model_uri: URI of the model (or models) to serve.</span>
<span class="sd">        model_name: the name of the model. Multiple versions of the same model</span>
<span class="sd">            should use the same model name. Model name must use only lowercase</span>
<span class="sd">            alphanumeric characters and dashes.</span>
<span class="sd">        secret_name: the name of the ZenML secret containing credentials</span>
<span class="sd">            required to authenticate to the artifact store.</span>
<span class="sd">        k8s_secret: the name of the Kubernetes secret to use for the prediction</span>
<span class="sd">            service.</span>
<span class="sd">        k8s_service_account: the name of the Kubernetes service account to use</span>
<span class="sd">            for the prediction service.</span>
<span class="sd">        predictor: the KServe predictor used to serve the model. The</span>
<span class="sd">        predictor type can be one of the following: `tensorflow`, `pytorch`,</span>
<span class="sd">        `sklearn`, `xgboost`, `custom`.</span>
<span class="sd">        replicas: number of replicas to use for the prediction service.</span>
<span class="sd">        resources: the Kubernetes resources to allocate for the prediction service.</span>
<span class="sd">        container: the container to use for the custom prediction services.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">model_uri</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">secret_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">k8s_secret</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">k8s_service_account</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">predictor</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">replicas</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">container</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">resources</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">sanitize_labels</span><span class="p">(</span><span class="n">labels</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the label values to be valid Kubernetes labels.</span>

<span class="sd">        See: https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/#syntax-and-character-set</span>

<span class="sd">        Args:</span>
<span class="sd">            labels: The labels to sanitize.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO[MEDIUM]: Move k8s label sanitization to a common module with all K8s utils.</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># Kubernetes labels must be alphanumeric, no longer than</span>
            <span class="c1"># 63 characters, and must begin and end with an alphanumeric</span>
            <span class="c1"># character ([a-z0-9A-Z])</span>
            <span class="n">labels</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[^0-9a-zA-Z-_\.]+&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)[:</span><span class="mi">63</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span>
                <span class="s2">&quot;-_.&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_kubernetes_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate the labels for the KServe inference CRD from the service configuration.</span>

<span class="sd">        These labels are attached to the KServe inference service CRD</span>
<span class="sd">        and may be used as label selectors in lookup operations.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The labels for the KServe inference service CRD.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;app&quot;</span><span class="p">:</span> <span class="s2">&quot;zenml&quot;</span><span class="p">}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pipeline_name</span><span class="p">:</span>
            <span class="n">labels</span><span class="p">[</span><span class="s2">&quot;zenml.pipeline_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pipeline_name</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_name</span><span class="p">:</span>
            <span class="n">labels</span><span class="p">[</span><span class="s2">&quot;zenml.run_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_name</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pipeline_step_name</span><span class="p">:</span>
            <span class="n">labels</span><span class="p">[</span><span class="s2">&quot;zenml.pipeline_step_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pipeline_step_name</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_name</span><span class="p">:</span>
            <span class="n">labels</span><span class="p">[</span><span class="s2">&quot;zenml.model_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_name</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_uri</span><span class="p">:</span>
            <span class="n">labels</span><span class="p">[</span><span class="s2">&quot;zenml.model_uri&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_uri</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span><span class="p">:</span>
            <span class="n">labels</span><span class="p">[</span><span class="s2">&quot;zenml.model_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sanitize_labels</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">labels</span>

    <span class="k">def</span> <span class="nf">get_kubernetes_annotations</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate the annotations for the KServe inference CRD the service configuration.</span>

<span class="sd">        The annotations are used to store additional information about the</span>
<span class="sd">        KServe ZenML service associated with the deployment that is</span>
<span class="sd">        not available on the labels. One annotation is particularly important</span>
<span class="sd">        is the serialized Service configuration itself, which is used to</span>
<span class="sd">        recreate the service configuration from a remote KServe inference</span>
<span class="sd">        service CRD.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The annotations for the KServe inference service CRD.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">annotations</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;zenml.service_config&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">json</span><span class="p">(),</span>
            <span class="s2">&quot;zenml.version&quot;</span><span class="p">:</span> <span class="n">__version__</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">annotations</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">create_from_deployment</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">deployment</span><span class="p">:</span> <span class="n">V1beta1InferenceService</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;KServeDeploymentConfig&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Recreate a KServe service from a KServe deployment resource.</span>

<span class="sd">        Args:</span>
<span class="sd">            deployment: the KServe inference service CRD.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The KServe ZenML service configuration corresponding to the given</span>
<span class="sd">            KServe inference service CRD.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if the given deployment resource does not contain</span>
<span class="sd">                the expected annotations or it contains an invalid or</span>
<span class="sd">                incompatible KServe ZenML service configuration.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">config_data</span> <span class="o">=</span> <span class="n">deployment</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;annotations&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s2">&quot;zenml.service_config&quot;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">config_data</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The given deployment resource does not contain a &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;&#39;zenml.service_config&#39; annotation: </span><span class="si">{</span><span class="n">deployment</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">service_config</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">parse_raw</span><span class="p">(</span><span class="n">config_data</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The loaded KServe Inference Service resource contains an &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;invalid or incompatible KServe ZenML service configuration: &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">config_data</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
        <span class="k">return</span> <span class="n">service_config</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">




















  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentConfig.create_from_deployment" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_from_deployment</span><span class="p">(</span><span class="n">deployment</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Recreate a KServe service from a KServe deployment resource.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>deployment</code></td>
        <td><code>V1beta1InferenceService</code></td>
        <td><p>the KServe inference service CRD.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>KServeDeploymentConfig</code></td>
      <td><p>The KServe ZenML service configuration corresponding to the given
KServe inference service CRD.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>if the given deployment resource does not contain
the expected annotations or it contains an invalid or
incompatible KServe ZenML service configuration.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/services/kserve_deployment.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">create_from_deployment</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span> <span class="n">deployment</span><span class="p">:</span> <span class="n">V1beta1InferenceService</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;KServeDeploymentConfig&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Recreate a KServe service from a KServe deployment resource.</span>

<span class="sd">    Args:</span>
<span class="sd">        deployment: the KServe inference service CRD.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The KServe ZenML service configuration corresponding to the given</span>
<span class="sd">        KServe inference service CRD.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: if the given deployment resource does not contain</span>
<span class="sd">            the expected annotations or it contains an invalid or</span>
<span class="sd">            incompatible KServe ZenML service configuration.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config_data</span> <span class="o">=</span> <span class="n">deployment</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;annotations&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="s2">&quot;zenml.service_config&quot;</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">config_data</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The given deployment resource does not contain a &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;&#39;zenml.service_config&#39; annotation: </span><span class="si">{</span><span class="n">deployment</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">service_config</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">parse_raw</span><span class="p">(</span><span class="n">config_data</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The loaded KServe Inference Service resource contains an &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;invalid or incompatible KServe ZenML service configuration: &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">config_data</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
    <span class="k">return</span> <span class="n">service_config</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentConfig.get_kubernetes_annotations" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_kubernetes_annotations</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Generate the annotations for the KServe inference CRD the service configuration.</p>
<p>The annotations are used to store additional information about the
KServe ZenML service associated with the deployment that is
not available on the labels. One annotation is particularly important
is the serialized Service configuration itself, which is used to
recreate the service configuration from a remote KServe inference
service CRD.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Dict[str, str]</code></td>
      <td><p>The annotations for the KServe inference service CRD.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/services/kserve_deployment.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_kubernetes_annotations</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate the annotations for the KServe inference CRD the service configuration.</span>

<span class="sd">    The annotations are used to store additional information about the</span>
<span class="sd">    KServe ZenML service associated with the deployment that is</span>
<span class="sd">    not available on the labels. One annotation is particularly important</span>
<span class="sd">    is the serialized Service configuration itself, which is used to</span>
<span class="sd">    recreate the service configuration from a remote KServe inference</span>
<span class="sd">    service CRD.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The annotations for the KServe inference service CRD.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">annotations</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;zenml.service_config&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">json</span><span class="p">(),</span>
        <span class="s2">&quot;zenml.version&quot;</span><span class="p">:</span> <span class="n">__version__</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">annotations</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentConfig.get_kubernetes_labels" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_kubernetes_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Generate the labels for the KServe inference CRD from the service configuration.</p>
<p>These labels are attached to the KServe inference service CRD
and may be used as label selectors in lookup operations.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Dict[str, str]</code></td>
      <td><p>The labels for the KServe inference service CRD.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/services/kserve_deployment.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_kubernetes_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate the labels for the KServe inference CRD from the service configuration.</span>

<span class="sd">    These labels are attached to the KServe inference service CRD</span>
<span class="sd">    and may be used as label selectors in lookup operations.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The labels for the KServe inference service CRD.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;app&quot;</span><span class="p">:</span> <span class="s2">&quot;zenml&quot;</span><span class="p">}</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pipeline_name</span><span class="p">:</span>
        <span class="n">labels</span><span class="p">[</span><span class="s2">&quot;zenml.pipeline_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pipeline_name</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_name</span><span class="p">:</span>
        <span class="n">labels</span><span class="p">[</span><span class="s2">&quot;zenml.run_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_name</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pipeline_step_name</span><span class="p">:</span>
        <span class="n">labels</span><span class="p">[</span><span class="s2">&quot;zenml.pipeline_step_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pipeline_step_name</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_name</span><span class="p">:</span>
        <span class="n">labels</span><span class="p">[</span><span class="s2">&quot;zenml.model_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_name</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_uri</span><span class="p">:</span>
        <span class="n">labels</span><span class="p">[</span><span class="s2">&quot;zenml.model_uri&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_uri</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span><span class="p">:</span>
        <span class="n">labels</span><span class="p">[</span><span class="s2">&quot;zenml.model_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sanitize_labels</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">labels</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentConfig.sanitize_labels" class="doc doc-heading">
<code class="highlight language-python"><span class="n">sanitize_labels</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Update the label values to be valid Kubernetes labels.</p>
<p>See: https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/#syntax-and-character-set</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>labels</code></td>
        <td><code>Dict[str, str]</code></td>
        <td><p>The labels to sanitize.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/services/kserve_deployment.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">sanitize_labels</span><span class="p">(</span><span class="n">labels</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Update the label values to be valid Kubernetes labels.</span>

<span class="sd">    See: https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/#syntax-and-character-set</span>

<span class="sd">    Args:</span>
<span class="sd">        labels: The labels to sanitize.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO[MEDIUM]: Move k8s label sanitization to a common module with all K8s utils.</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># Kubernetes labels must be alphanumeric, no longer than</span>
        <span class="c1"># 63 characters, and must begin and end with an alphanumeric</span>
        <span class="c1"># character ([a-z0-9A-Z])</span>
        <span class="n">labels</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[^0-9a-zA-Z-_\.]+&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)[:</span><span class="mi">63</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span>
            <span class="s2">&quot;-_.&quot;</span>
        <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentService" class="doc doc-heading">
        <code>
KServeDeploymentService            (<a class="autorefs autorefs-internal" title="zenml.services.service.BaseDeploymentService" href="../../core_code_docs/core-services/#zenml.services.service.BaseDeploymentService">BaseDeploymentService</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-model"><code>pydantic-model</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>A ZenML service that represents a KServe inference service CRD.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>config</code></td>
        <td><code>KServeDeploymentConfig</code></td>
        <td><p>service configuration.</p></td>
      </tr>
      <tr>
        <td><code>status</code></td>
        <td><code>ServiceStatus</code></td>
        <td><p>service status.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/services/kserve_deployment.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">KServeDeploymentService</span><span class="p">(</span><span class="n">BaseDeploymentService</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A ZenML service that represents a KServe inference service CRD.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        config: service configuration.</span>
<span class="sd">        status: service status.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">SERVICE_TYPE</span> <span class="o">=</span> <span class="n">ServiceType</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;kserve-deployment&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;model-serving&quot;</span><span class="p">,</span>
        <span class="n">flavor</span><span class="o">=</span><span class="s2">&quot;kserve&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;KServe inference service&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">config</span><span class="p">:</span> <span class="n">KServeDeploymentConfig</span>
    <span class="n">status</span><span class="p">:</span> <span class="n">ServiceStatus</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">ServiceStatus</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_get_model_deployer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;KServeModelDeployer&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the active KServe model deployer.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The active KServeModelDeployer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">zenml.integrations.kserve.model_deployers.kserve_model_deployer</span> <span class="kn">import</span> <span class="p">(</span>
            <span class="n">KServeModelDeployer</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span>
            <span class="n">KServeModelDeployer</span><span class="p">,</span>
            <span class="n">KServeModelDeployer</span><span class="o">.</span><span class="n">get_active_model_deployer</span><span class="p">(),</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_client</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">KServeClient</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the KServe client from the active KServe model deployer.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The KServe client.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_model_deployer</span><span class="p">()</span><span class="o">.</span><span class="n">kserve_client</span>

    <span class="k">def</span> <span class="nf">_get_namespace</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the Kubernetes namespace from the active KServe model deployer.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The Kubernetes namespace, or None, if the default namespace is</span>
<span class="sd">            used.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_model_deployer</span><span class="p">()</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">kubernetes_namespace</span>

    <span class="k">def</span> <span class="nf">check_status</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">ServiceState</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check the state of the KServe inference service.</span>

<span class="sd">        This method Checks the current operational state of the external KServe</span>
<span class="sd">        inference service and translate it into a `ServiceState` value and a printable message.</span>

<span class="sd">        This method should be overridden by subclasses that implement concrete service tracking functionality.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The operational state of the external service and a message</span>
<span class="sd">            providing additional information about that state (e.g. a</span>
<span class="sd">            description of the error if one is encountered while checking the</span>
<span class="sd">            service status).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_client</span><span class="p">()</span>
        <span class="n">namespace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_namespace</span><span class="p">()</span>

        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crd_name</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">deployment</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">ServiceState</span><span class="o">.</span><span class="n">INACTIVE</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="c1"># TODO[MEDIUM]: Implement better operational status checking that also</span>
        <span class="c1">#   cover errors</span>
        <span class="k">if</span> <span class="s2">&quot;status&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">deployment</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">ServiceState</span><span class="o">.</span><span class="n">INACTIVE</span><span class="p">,</span> <span class="s2">&quot;No operational status available&quot;</span><span class="p">)</span>
        <span class="n">status</span> <span class="o">=</span> <span class="s2">&quot;Unknown&quot;</span>
        <span class="k">for</span> <span class="n">condition</span> <span class="ow">in</span> <span class="n">deployment</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;conditions&quot;</span><span class="p">,</span> <span class="p">{}):</span>
            <span class="k">if</span> <span class="n">condition</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;PredictorReady&quot;</span><span class="p">:</span>
                <span class="n">status</span> <span class="o">=</span> <span class="n">condition</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="s2">&quot;Unknown&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">status</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;true&quot;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="p">(</span>
                        <span class="n">ServiceState</span><span class="o">.</span><span class="n">ACTIVE</span><span class="p">,</span>
                        <span class="sa">f</span><span class="s2">&quot;Inference service &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; is available&quot;</span><span class="p">,</span>
                    <span class="p">)</span>

                <span class="k">elif</span> <span class="n">status</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;false&quot;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="p">(</span>
                        <span class="n">ServiceState</span><span class="o">.</span><span class="n">PENDING_STARTUP</span><span class="p">,</span>
                        <span class="sa">f</span><span class="s2">&quot;Inference service &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; is not available: </span><span class="si">{</span><span class="n">condition</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Unknown&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">ServiceState</span><span class="o">.</span><span class="n">PENDING_STARTUP</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;Inference service &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; still starting up&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">crd_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the name of the KServe inference service CRD that uniquely corresponds to this service instance.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The name of the KServe inference service CRD.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_get_kubernetes_labels</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;zenml.model_name&quot;</span><span class="p">)</span>
            <span class="ow">or</span> <span class="sa">f</span><span class="s2">&quot;zenml-</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">)[:</span><span class="mi">8</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_kubernetes_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate the labels for the KServe inference service CRD from the service configuration.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The labels for the KServe inference service.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get_kubernetes_labels</span><span class="p">()</span>
        <span class="n">labels</span><span class="p">[</span><span class="s2">&quot;zenml.service_uuid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="p">)</span>
        <span class="n">KServeDeploymentConfig</span><span class="o">.</span><span class="n">sanitize_labels</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">labels</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">create_from_deployment</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">deployment</span><span class="p">:</span> <span class="n">V1beta1InferenceService</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;KServeDeploymentService&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Recreate the configuration of a KServe Service from a deployed instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            deployment: the KServe deployment resource.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The KServe service configuration corresponding to the given</span>
<span class="sd">            KServe deployment resource.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if the given deployment resource does not contain</span>
<span class="sd">                the expected annotations or it contains an invalid or</span>
<span class="sd">                incompatible KServe service configuration.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">KServeDeploymentConfig</span><span class="o">.</span><span class="n">create_from_deployment</span><span class="p">(</span><span class="n">deployment</span><span class="p">)</span>
        <span class="n">uuid</span> <span class="o">=</span> <span class="n">deployment</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;labels&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;zenml.service_uuid&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">uuid</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The given deployment resource does not contain a valid &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;&#39;zenml.service_uuid&#39; label: </span><span class="si">{</span><span class="n">deployment</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="n">service</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">uuid</span><span class="o">=</span><span class="n">UUID</span><span class="p">(</span><span class="n">uuid</span><span class="p">),</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>
        <span class="n">service</span><span class="o">.</span><span class="n">update_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">service</span>

    <span class="k">def</span> <span class="nf">provision</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Provision or update remote KServe deployment instance.</span>

<span class="sd">        This should then match the current configuration.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_client</span><span class="p">()</span>
        <span class="n">namespace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_namespace</span><span class="p">()</span>

        <span class="n">api_version</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">KSERVE_GROUP</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="s2">&quot;v1beta1&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crd_name</span>

        <span class="c1"># All supported model specs seem to have the same fields</span>
        <span class="c1"># so we can use any one of them (see https://kserve.github.io/website/0.8/reference/api/#serving.kserve.io/v1beta1.PredictorExtensionSpec)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">container</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">predictor_kwargs</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;containers&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="n">k8s_client</span><span class="o">.</span><span class="n">V1Container</span><span class="p">(</span>
                        <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">),</span>
                        <span class="n">image</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;image&quot;</span><span class="p">),</span>
                        <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;command&quot;</span><span class="p">),</span>
                        <span class="n">args</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;args&quot;</span><span class="p">),</span>
                        <span class="n">env</span><span class="o">=</span><span class="p">[</span>
                            <span class="n">k8s_client</span><span class="o">.</span><span class="n">V1EnvVar</span><span class="p">(</span>
                                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;STORAGE_URI&quot;</span><span class="p">,</span>
                                <span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;storage_uri&quot;</span><span class="p">),</span>
                            <span class="p">)</span>
                        <span class="p">],</span>
                    <span class="p">)</span>
                <span class="p">],</span>
                <span class="s2">&quot;service_account_name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">k8s_service_account</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">predictor_kwargs</span> <span class="o">=</span> <span class="p">{</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">predictor</span><span class="p">:</span> <span class="n">V1beta1PredictorExtensionSpec</span><span class="p">(</span>
                    <span class="n">storage_uri</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">model_uri</span><span class="p">,</span>
                    <span class="n">resources</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">resources</span><span class="p">,</span>
                <span class="p">),</span>
                <span class="s2">&quot;service_account_name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">k8s_service_account</span><span class="p">,</span>
            <span class="p">}</span>

        <span class="n">isvc</span> <span class="o">=</span> <span class="n">V1beta1InferenceService</span><span class="p">(</span>
            <span class="n">api_version</span><span class="o">=</span><span class="n">api_version</span><span class="p">,</span>
            <span class="n">kind</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">KSERVE_KIND</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="n">k8s_client</span><span class="o">.</span><span class="n">V1ObjectMeta</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span>
                <span class="n">labels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_kubernetes_labels</span><span class="p">(),</span>
                <span class="n">annotations</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get_kubernetes_annotations</span><span class="p">(),</span>
            <span class="p">),</span>
            <span class="n">spec</span><span class="o">=</span><span class="n">V1beta1InferenceServiceSpec</span><span class="p">(</span>
                <span class="n">predictor</span><span class="o">=</span><span class="n">V1beta1PredictorSpec</span><span class="p">(</span><span class="o">**</span><span class="n">predictor_kwargs</span><span class="p">)</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># TODO[HIGH]: better error handling when provisioning KServe instances</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">)</span>
            <span class="c1"># update the existing deployment</span>
            <span class="n">client</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">isvc</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
            <span class="n">client</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">isvc</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">deprovision</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Deprovisions all resources used by the service.</span>

<span class="sd">        Args:</span>
<span class="sd">            force: if True, the service will be deprovisioned even if it is</span>
<span class="sd">                still in use.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if the service is still in use and force is False.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_client</span><span class="p">()</span>
        <span class="n">namespace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_namespace</span><span class="p">()</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crd_name</span>

        <span class="c1"># TODO[HIGH]: catch errors if deleting a KServe instance that is no</span>
        <span class="c1">#   longer available</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">client</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Could not delete KServe instance &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; from namespace: &#39;</span><span class="si">{</span><span class="n">namespace</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_deployment_logs</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">follow</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">tail</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the logs of a KServe deployment resource.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: the name of the KServe deployment to get logs for.</span>
<span class="sd">            follow: if True, the logs will be streamed as they are written</span>
<span class="sd">            tail: only retrieve the last NUM lines of log output.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A generator that can be accessed to get the service logs.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: if an unknown error occurs while fetching the logs.</span>

<span class="sd">        Yields:</span>
<span class="sd">            The logs of the given deployment.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_client</span><span class="p">()</span>
        <span class="n">namespace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_namespace</span><span class="p">()</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Retrieving logs for InferenceService resource: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">core_api</span><span class="o">.</span><span class="n">list_namespaced_pod</span><span class="p">(</span>
                <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span>
                <span class="n">label_selector</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;zenml.service_uuid=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Kubernetes API response: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
            <span class="n">pods</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">items</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">pods</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;The KServe deployment </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> is not currently &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;running: no Kubernetes pods associated with it were found&quot;</span>
                <span class="p">)</span>
            <span class="n">pod</span> <span class="o">=</span> <span class="n">pods</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">pod_name</span> <span class="o">=</span> <span class="n">pod</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">name</span>

            <span class="n">containers</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">pod</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">containers</span><span class="p">]</span>
            <span class="n">init_containers</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">pod</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">init_containers</span><span class="p">]</span>
            <span class="n">container_statuses</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">started</span> <span class="ow">or</span> <span class="n">c</span><span class="o">.</span><span class="n">restart_count</span>
                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">pod</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">container_statuses</span>
            <span class="p">}</span>

            <span class="n">container</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span>
            <span class="k">if</span> <span class="n">container</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">containers</span><span class="p">:</span>
                <span class="n">container</span> <span class="o">=</span> <span class="n">containers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">container_statuses</span><span class="p">[</span><span class="n">container</span><span class="p">]:</span>
                <span class="n">container</span> <span class="o">=</span> <span class="n">init_containers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Retrieving logs for pod: `</span><span class="si">{</span><span class="n">pod_name</span><span class="si">}</span><span class="s2">` and container &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="n">container</span><span class="si">}</span><span class="s2">` in namespace `</span><span class="si">{</span><span class="n">namespace</span><span class="si">}</span><span class="s2">`&quot;</span>
            <span class="p">)</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">core_api</span><span class="o">.</span><span class="n">read_namespaced_pod_log</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="n">pod_name</span><span class="p">,</span>
                <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span>
                <span class="n">container</span><span class="o">=</span><span class="n">container</span><span class="p">,</span>
                <span class="n">follow</span><span class="o">=</span><span class="n">follow</span><span class="p">,</span>
                <span class="n">tail_lines</span><span class="o">=</span><span class="n">tail</span><span class="p">,</span>
                <span class="n">_preload_content</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="n">k8s_client</span><span class="o">.</span><span class="n">rest</span><span class="o">.</span><span class="n">ApiException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="s2">&quot;Exception when fetching logs for InferenceService resource &quot;</span>
                <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">name</span><span class="p">,</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Unexpected exception when fetching logs for InferenceService &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;resource: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span>
                    <span class="k">return</span>
                <span class="n">stop</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">line</span>
                <span class="k">if</span> <span class="n">stop</span><span class="p">:</span>
                    <span class="k">return</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">response</span><span class="o">.</span><span class="n">release_conn</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_logs</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">follow</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">tail</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve the logs from the remote KServe inference service instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            follow: if True, the logs will be streamed as they are written.</span>
<span class="sd">            tail: only retrieve the last NUM lines of log output.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A generator that can be accessed to get the service logs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_deployment_logs</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">crd_name</span><span class="p">,</span>
            <span class="n">follow</span><span class="o">=</span><span class="n">follow</span><span class="p">,</span>
            <span class="n">tail</span><span class="o">=</span><span class="n">tail</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">prediction_url</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The prediction URI exposed by the prediction service.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The prediction URI exposed by the prediction service, or None if</span>
<span class="sd">            the service is not yet ready.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_running</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">model_deployer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_model_deployer</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">model_deployer</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">base_url</span><span class="p">,</span>
            <span class="s2">&quot;v1/models&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">crd_name</span><span class="si">}</span><span class="s2">:predict&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">prediction_hostname</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The prediction hostname exposed by the prediction service.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The prediction hostname exposed by the prediction service status</span>
<span class="sd">            that will be used in the headers of the prediction request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_running</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">namespace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_namespace</span><span class="p">()</span>

        <span class="n">model_deployer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_model_deployer</span><span class="p">()</span>
        <span class="n">custom_domain</span> <span class="o">=</span> <span class="n">model_deployer</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">custom_domain</span> <span class="ow">or</span> <span class="s2">&quot;example.com&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">crd_name</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">namespace</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">custom_domain</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Make a prediction using the service.</span>

<span class="sd">        Args:</span>
<span class="sd">            request: a NumPy array representing the request</span>

<span class="sd">        Returns:</span>
<span class="sd">            A NumPy array represents the prediction returned by the service.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: if the service is not yet ready.</span>
<span class="sd">            ValueError: if the prediction_url is not set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_running</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;KServe prediction service is not running. &quot;</span>
                <span class="s2">&quot;Please start the service before making predictions.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">prediction_url</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`self.prediction_url` is not set, cannot post.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">prediction_hostname</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;`self.prediction_hostname` is not set, cannot post.&quot;</span>
            <span class="p">)</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Host&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">prediction_hostname</span><span class="p">}</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">request</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Request must be a json string.&quot;</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">prediction_url</span><span class="p">,</span>
            <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
            <span class="n">json</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;instances&quot;</span><span class="p">:</span> <span class="n">request</span><span class="p">},</span>
        <span class="p">)</span>
        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">







  <div class="doc doc-object doc-attribute">



<h6 id="zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentService.crd_name" class="doc doc-heading">
<code class="highlight language-python"><span class="n">crd_name</span><span class="p">:</span> <span class="nb">str</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Get the name of the KServe inference service CRD that uniquely corresponds to this service instance.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The name of the KServe inference service CRD.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 id="zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentService.prediction_hostname" class="doc doc-heading">
<code class="highlight language-python"><span class="n">prediction_hostname</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>The prediction hostname exposed by the prediction service.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[str]</code></td>
      <td><p>The prediction hostname exposed by the prediction service status
that will be used in the headers of the prediction request.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h6 id="zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentService.prediction_url" class="doc doc-heading">
<code class="highlight language-python"><span class="n">prediction_url</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>The prediction URI exposed by the prediction service.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[str]</code></td>
      <td><p>The prediction URI exposed by the prediction service, or None if
the service is not yet ready.</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>









  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentService.check_status" class="doc doc-heading">
<code class="highlight language-python"><span class="n">check_status</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Check the state of the KServe inference service.</p>
<p>This method Checks the current operational state of the external KServe
inference service and translate it into a <code>ServiceState</code> value and a printable message.</p>
<p>This method should be overridden by subclasses that implement concrete service tracking functionality.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tuple[zenml.services.service_status.ServiceState, str]</code></td>
      <td><p>The operational state of the external service and a message
providing additional information about that state (e.g. a
description of the error if one is encountered while checking the
service status).</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/services/kserve_deployment.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">check_status</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">ServiceState</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check the state of the KServe inference service.</span>

<span class="sd">    This method Checks the current operational state of the external KServe</span>
<span class="sd">    inference service and translate it into a `ServiceState` value and a printable message.</span>

<span class="sd">    This method should be overridden by subclasses that implement concrete service tracking functionality.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The operational state of the external service and a message</span>
<span class="sd">        providing additional information about that state (e.g. a</span>
<span class="sd">        description of the error if one is encountered while checking the</span>
<span class="sd">        service status).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_client</span><span class="p">()</span>
    <span class="n">namespace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_namespace</span><span class="p">()</span>

    <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crd_name</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">deployment</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">ServiceState</span><span class="o">.</span><span class="n">INACTIVE</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="c1"># TODO[MEDIUM]: Implement better operational status checking that also</span>
    <span class="c1">#   cover errors</span>
    <span class="k">if</span> <span class="s2">&quot;status&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">deployment</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">ServiceState</span><span class="o">.</span><span class="n">INACTIVE</span><span class="p">,</span> <span class="s2">&quot;No operational status available&quot;</span><span class="p">)</span>
    <span class="n">status</span> <span class="o">=</span> <span class="s2">&quot;Unknown&quot;</span>
    <span class="k">for</span> <span class="n">condition</span> <span class="ow">in</span> <span class="n">deployment</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;conditions&quot;</span><span class="p">,</span> <span class="p">{}):</span>
        <span class="k">if</span> <span class="n">condition</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;PredictorReady&quot;</span><span class="p">:</span>
            <span class="n">status</span> <span class="o">=</span> <span class="n">condition</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="s2">&quot;Unknown&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">status</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;true&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="n">ServiceState</span><span class="o">.</span><span class="n">ACTIVE</span><span class="p">,</span>
                    <span class="sa">f</span><span class="s2">&quot;Inference service &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; is available&quot;</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">elif</span> <span class="n">status</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;false&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="n">ServiceState</span><span class="o">.</span><span class="n">PENDING_STARTUP</span><span class="p">,</span>
                    <span class="sa">f</span><span class="s2">&quot;Inference service &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; is not available: </span><span class="si">{</span><span class="n">condition</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Unknown&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">ServiceState</span><span class="o">.</span><span class="n">PENDING_STARTUP</span><span class="p">,</span>
        <span class="sa">f</span><span class="s2">&quot;Inference service &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; still starting up&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentService.create_from_deployment" class="doc doc-heading">
<code class="highlight language-python"><span class="n">create_from_deployment</span><span class="p">(</span><span class="n">deployment</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Recreate the configuration of a KServe Service from a deployed instance.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>deployment</code></td>
        <td><code>V1beta1InferenceService</code></td>
        <td><p>the KServe deployment resource.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>KServeDeploymentService</code></td>
      <td><p>The KServe service configuration corresponding to the given
KServe deployment resource.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>if the given deployment resource does not contain
the expected annotations or it contains an invalid or
incompatible KServe service configuration.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/services/kserve_deployment.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">create_from_deployment</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span> <span class="n">deployment</span><span class="p">:</span> <span class="n">V1beta1InferenceService</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;KServeDeploymentService&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Recreate the configuration of a KServe Service from a deployed instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        deployment: the KServe deployment resource.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The KServe service configuration corresponding to the given</span>
<span class="sd">        KServe deployment resource.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: if the given deployment resource does not contain</span>
<span class="sd">            the expected annotations or it contains an invalid or</span>
<span class="sd">            incompatible KServe service configuration.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">KServeDeploymentConfig</span><span class="o">.</span><span class="n">create_from_deployment</span><span class="p">(</span><span class="n">deployment</span><span class="p">)</span>
    <span class="n">uuid</span> <span class="o">=</span> <span class="n">deployment</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;labels&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;zenml.service_uuid&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">uuid</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The given deployment resource does not contain a valid &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;&#39;zenml.service_uuid&#39; label: </span><span class="si">{</span><span class="n">deployment</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="n">service</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">uuid</span><span class="o">=</span><span class="n">UUID</span><span class="p">(</span><span class="n">uuid</span><span class="p">),</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>
    <span class="n">service</span><span class="o">.</span><span class="n">update_status</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">service</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentService.deprovision" class="doc doc-heading">
<code class="highlight language-python"><span class="n">deprovision</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Deprovisions all resources used by the service.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>force</code></td>
        <td><code>bool</code></td>
        <td><p>if True, the service will be deprovisioned even if it is
still in use.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>if the service is still in use and force is False.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/services/kserve_deployment.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">deprovision</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Deprovisions all resources used by the service.</span>

<span class="sd">    Args:</span>
<span class="sd">        force: if True, the service will be deprovisioned even if it is</span>
<span class="sd">            still in use.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: if the service is still in use and force is False.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_client</span><span class="p">()</span>
    <span class="n">namespace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_namespace</span><span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crd_name</span>

    <span class="c1"># TODO[HIGH]: catch errors if deleting a KServe instance that is no</span>
    <span class="c1">#   longer available</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">client</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Could not delete KServe instance &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; from namespace: &#39;</span><span class="si">{</span><span class="n">namespace</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
        <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentService.get_logs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_logs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">follow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tail</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Retrieve the logs from the remote KServe inference service instance.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>follow</code></td>
        <td><code>bool</code></td>
        <td><p>if True, the logs will be streamed as they are written.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>tail</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>only retrieve the last NUM lines of log output.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Generator[str, bool, NoneType]</code></td>
      <td><p>A generator that can be accessed to get the service logs.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/services/kserve_deployment.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_logs</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">follow</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">tail</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve the logs from the remote KServe inference service instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        follow: if True, the logs will be streamed as they are written.</span>
<span class="sd">        tail: only retrieve the last NUM lines of log output.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A generator that can be accessed to get the service logs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_deployment_logs</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">crd_name</span><span class="p">,</span>
        <span class="n">follow</span><span class="o">=</span><span class="n">follow</span><span class="p">,</span>
        <span class="n">tail</span><span class="o">=</span><span class="n">tail</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentService.predict" class="doc doc-heading">
<code class="highlight language-python"><span class="n">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Make a prediction using the service.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>request</code></td>
        <td><code>str</code></td>
        <td><p>a NumPy array representing the request</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Any</code></td>
      <td><p>A NumPy array represents the prediction returned by the service.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>Exception</code></td>
        <td><p>if the service is not yet ready.</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>if the prediction_url is not set.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/services/kserve_deployment.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Make a prediction using the service.</span>

<span class="sd">    Args:</span>
<span class="sd">        request: a NumPy array representing the request</span>

<span class="sd">    Returns:</span>
<span class="sd">        A NumPy array represents the prediction returned by the service.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: if the service is not yet ready.</span>
<span class="sd">        ValueError: if the prediction_url is not set.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_running</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="s2">&quot;KServe prediction service is not running. &quot;</span>
            <span class="s2">&quot;Please start the service before making predictions.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">prediction_url</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`self.prediction_url` is not set, cannot post.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">prediction_hostname</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;`self.prediction_hostname` is not set, cannot post.&quot;</span>
        <span class="p">)</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Host&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">prediction_hostname</span><span class="p">}</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">request</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Request must be a json string.&quot;</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prediction_url</span><span class="p">,</span>
        <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
        <span class="n">json</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;instances&quot;</span><span class="p">:</span> <span class="n">request</span><span class="p">},</span>
    <span class="p">)</span>
    <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.kserve.services.kserve_deployment.KServeDeploymentService.provision" class="doc doc-heading">
<code class="highlight language-python"><span class="n">provision</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h6>

    <div class="doc doc-contents ">

      <p>Provision or update remote KServe deployment instance.</p>
<p>This should then match the current configuration.</p>

        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/services/kserve_deployment.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">provision</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Provision or update remote KServe deployment instance.</span>

<span class="sd">    This should then match the current configuration.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">client</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_client</span><span class="p">()</span>
    <span class="n">namespace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_namespace</span><span class="p">()</span>

    <span class="n">api_version</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">KSERVE_GROUP</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="s2">&quot;v1beta1&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crd_name</span>

    <span class="c1"># All supported model specs seem to have the same fields</span>
    <span class="c1"># so we can use any one of them (see https://kserve.github.io/website/0.8/reference/api/#serving.kserve.io/v1beta1.PredictorExtensionSpec)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">container</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">predictor_kwargs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;containers&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">k8s_client</span><span class="o">.</span><span class="n">V1Container</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">),</span>
                    <span class="n">image</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;image&quot;</span><span class="p">),</span>
                    <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;command&quot;</span><span class="p">),</span>
                    <span class="n">args</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;args&quot;</span><span class="p">),</span>
                    <span class="n">env</span><span class="o">=</span><span class="p">[</span>
                        <span class="n">k8s_client</span><span class="o">.</span><span class="n">V1EnvVar</span><span class="p">(</span>
                            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;STORAGE_URI&quot;</span><span class="p">,</span>
                            <span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">container</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;storage_uri&quot;</span><span class="p">),</span>
                        <span class="p">)</span>
                    <span class="p">],</span>
                <span class="p">)</span>
            <span class="p">],</span>
            <span class="s2">&quot;service_account_name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">k8s_service_account</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">predictor_kwargs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">predictor</span><span class="p">:</span> <span class="n">V1beta1PredictorExtensionSpec</span><span class="p">(</span>
                <span class="n">storage_uri</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">model_uri</span><span class="p">,</span>
                <span class="n">resources</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">resources</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="s2">&quot;service_account_name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">k8s_service_account</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="n">isvc</span> <span class="o">=</span> <span class="n">V1beta1InferenceService</span><span class="p">(</span>
        <span class="n">api_version</span><span class="o">=</span><span class="n">api_version</span><span class="p">,</span>
        <span class="n">kind</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">KSERVE_KIND</span><span class="p">,</span>
        <span class="n">metadata</span><span class="o">=</span><span class="n">k8s_client</span><span class="o">.</span><span class="n">V1ObjectMeta</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">,</span>
            <span class="n">labels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_kubernetes_labels</span><span class="p">(),</span>
            <span class="n">annotations</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get_kubernetes_annotations</span><span class="p">(),</span>
        <span class="p">),</span>
        <span class="n">spec</span><span class="o">=</span><span class="n">V1beta1InferenceServiceSpec</span><span class="p">(</span>
            <span class="n">predictor</span><span class="o">=</span><span class="n">V1beta1PredictorSpec</span><span class="p">(</span><span class="o">**</span><span class="n">predictor_kwargs</span><span class="p">)</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="c1"># TODO[HIGH]: better error handling when provisioning KServe instances</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">)</span>
        <span class="c1"># update the existing deployment</span>
        <span class="n">client</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">isvc</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="n">namespace</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
        <span class="n">client</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">isvc</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>







  </div>

    </div>

  </div>




  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h3 id="zenml.integrations.kserve.steps" class="doc doc-heading">
        <code>steps</code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Initialization for KServe steps.</p>



  <div class="doc doc-children">










  <div class="doc doc-object doc-module">



<h4 id="zenml.integrations.kserve.steps.kserve_deployer" class="doc doc-heading">
        <code>kserve_deployer</code>



</h4>

    <div class="doc doc-contents ">

      <p>Implementation of the KServe Deployer step.</p>



  <div class="doc doc-children">









  <div class="doc doc-object doc-class">



<h5 id="zenml.integrations.kserve.steps.kserve_deployer.CustomDeployParameters" class="doc doc-heading">
        <code>
CustomDeployParameters            (<span title="pydantic.main.BaseModel">BaseModel</span>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-model"><code>pydantic-model</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Custom model deployer step extra parameters.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>predict_function</code></td>
        <td><code>str</code></td>
        <td><p>Path to Python file containing predict function.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/steps/kserve_deployer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">CustomDeployParameters</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Custom model deployer step extra parameters.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        predict_function: Path to Python file containing predict function.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">predict_function</span><span class="p">:</span> <span class="nb">str</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;predict_function&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">predict_function_validate</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">predict_func_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate predict function.</span>

<span class="sd">        Args:</span>
<span class="sd">            predict_func_path: predict function path</span>

<span class="sd">        Returns:</span>
<span class="sd">            predict function path</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if predict function path is not valid</span>
<span class="sd">            TypeError: if predict function path is not a callable function</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">predict_function</span> <span class="o">=</span> <span class="n">source_utils</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">predict_func_path</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Predict function can&#39;t be found.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="n">predict_function</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Predict function must be callable.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">predict_func_path</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">












  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.kserve.steps.kserve_deployer.CustomDeployParameters.predict_function_validate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">predict_function_validate</span><span class="p">(</span><span class="n">predict_func_path</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Validate predict function.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>predict_func_path</code></td>
        <td><code>str</code></td>
        <td><p>predict function path</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>predict function path</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>if predict function path is not valid</p></td>
      </tr>
      <tr>
        <td><code>TypeError</code></td>
        <td><p>if predict function path is not a callable function</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/steps/kserve_deployer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;predict_function&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">predict_function_validate</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">predict_func_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate predict function.</span>

<span class="sd">    Args:</span>
<span class="sd">        predict_func_path: predict function path</span>

<span class="sd">    Returns:</span>
<span class="sd">        predict function path</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: if predict function path is not valid</span>
<span class="sd">        TypeError: if predict function path is not a callable function</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">predict_function</span> <span class="o">=</span> <span class="n">source_utils</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">predict_func_path</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Predict function can&#39;t be found.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="n">predict_function</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Predict function must be callable.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">predict_func_path</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="zenml.integrations.kserve.steps.kserve_deployer.KServeDeployerStepParameters" class="doc doc-heading">
        <code>
KServeDeployerStepParameters            (<a class="autorefs autorefs-internal" title="zenml.steps.base_parameters.BaseParameters" href="../../core_code_docs/core-steps/#zenml.steps.base_parameters.BaseParameters">BaseParameters</a>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-model"><code>pydantic-model</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>KServe model deployer step parameters.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>service_config</code></td>
        <td><code>KServeDeploymentConfig</code></td>
        <td><p>KServe deployment service configuration.</p></td>
      </tr>
      <tr>
        <td><code>torch_serve_params</code></td>
        <td></td>
        <td><p>TorchServe set of parameters to deploy model.</p></td>
      </tr>
      <tr>
        <td><code>timeout</code></td>
        <td><code>int</code></td>
        <td><p>Timeout for model deployment.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/steps/kserve_deployer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">KServeDeployerStepParameters</span><span class="p">(</span><span class="n">BaseParameters</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;KServe model deployer step parameters.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        service_config: KServe deployment service configuration.</span>
<span class="sd">        torch_serve_params: TorchServe set of parameters to deploy model.</span>
<span class="sd">        timeout: Timeout for model deployment.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">service_config</span><span class="p">:</span> <span class="n">KServeDeploymentConfig</span>
    <span class="n">custom_deploy_parameters</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">CustomDeployParameters</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">torch_serve_parameters</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">TorchServeParameters</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">DEFAULT_KSERVE_DEPLOYMENT_START_STOP_TIMEOUT</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">

















  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="zenml.integrations.kserve.steps.kserve_deployer.TorchServeParameters" class="doc doc-heading">
        <code>
TorchServeParameters            (<span title="pydantic.main.BaseModel">BaseModel</span>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-model"><code>pydantic-model</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>KServe PyTorch model deployer step configuration.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>model_class</code></td>
        <td><code>str</code></td>
        <td><p>Path to Python file containing model architecture.</p></td>
      </tr>
      <tr>
        <td><code>handler</code></td>
        <td><code>str</code></td>
        <td><p>TorchServe's handler file to handle custom TorchServe inference
logic.</p></td>
      </tr>
      <tr>
        <td><code>extra_files</code></td>
        <td><code>Optional[List[str]]</code></td>
        <td><p>Comma separated path to extra dependency files.</p></td>
      </tr>
      <tr>
        <td><code>model_version</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Model version.</p></td>
      </tr>
      <tr>
        <td><code>requirements_file</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Path to requirements file.</p></td>
      </tr>
      <tr>
        <td><code>torch_config</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>TorchServe configuration file path.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/steps/kserve_deployer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">TorchServeParameters</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;KServe PyTorch model deployer step configuration.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        model_class: Path to Python file containing model architecture.</span>
<span class="sd">        handler: TorchServe&#39;s handler file to handle custom TorchServe inference</span>
<span class="sd">            logic.</span>
<span class="sd">        extra_files: Comma separated path to extra dependency files.</span>
<span class="sd">        model_version: Model version.</span>
<span class="sd">        requirements_file: Path to requirements file.</span>
<span class="sd">        torch_config: TorchServe configuration file path.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">handler</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">extra_files</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">requirements_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">model_version</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;1.0&quot;</span>
    <span class="n">torch_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;model_class&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">model_class_validate</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate model class file path.</span>

<span class="sd">        Args:</span>
<span class="sd">            v: model class file path</span>

<span class="sd">        Returns:</span>
<span class="sd">            model class file path</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if model class file path is not valid</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Model class file path is required.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">Client</span><span class="o">.</span><span class="n">is_inside_repository</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Model class file path must be inside the repository.&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;handler&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">handler_validate</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate handler.</span>

<span class="sd">        Args:</span>
<span class="sd">            v: handler file path</span>

<span class="sd">        Returns:</span>
<span class="sd">            handler file path</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if handler file path is not valid</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">TORCH_HANDLERS</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">v</span>
            <span class="k">elif</span> <span class="n">Client</span><span class="o">.</span><span class="n">is_inside_repository</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">v</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Handler must be one of the TorchServe handlers&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;or a file that exists inside the repository.&quot;</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Handler is required.&quot;</span><span class="p">)</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;extra_files&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">extra_files_validate</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate extra files.</span>

<span class="sd">        Args:</span>
<span class="sd">            v: extra files path</span>

<span class="sd">        Returns:</span>
<span class="sd">            extra files path</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if the extra files path is not valid</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">extra_files</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">Client</span><span class="o">.</span><span class="n">is_inside_repository</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
                    <span class="n">extra_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s2">&quot;Extra file path must be inside the repository.&quot;</span>
                    <span class="p">)</span>
            <span class="k">return</span> <span class="n">extra_files</span>
        <span class="k">return</span> <span class="n">v</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;torch_config&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">torch_config_validate</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate torch config file.</span>

<span class="sd">        Args:</span>
<span class="sd">            v: torch config file path</span>

<span class="sd">        Returns:</span>
<span class="sd">            torch config file path</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if torch config file path is not valid.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Client</span><span class="o">.</span><span class="n">is_inside_repository</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">v</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Torch config file path must be inside the repository.&quot;</span>
                <span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">

















  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.kserve.steps.kserve_deployer.TorchServeParameters.extra_files_validate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">extra_files_validate</span><span class="p">(</span><span class="n">v</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Validate extra files.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>v</code></td>
        <td><code>Optional[List[str]]</code></td>
        <td><p>extra files path</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[List[str]]</code></td>
      <td><p>extra files path</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>if the extra files path is not valid</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/steps/kserve_deployer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;extra_files&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">extra_files_validate</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate extra files.</span>

<span class="sd">    Args:</span>
<span class="sd">        v: extra files path</span>

<span class="sd">    Returns:</span>
<span class="sd">        extra files path</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: if the extra files path is not valid</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">extra_files</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Client</span><span class="o">.</span><span class="n">is_inside_repository</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
                <span class="n">extra_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Extra file path must be inside the repository.&quot;</span>
                <span class="p">)</span>
        <span class="k">return</span> <span class="n">extra_files</span>
    <span class="k">return</span> <span class="n">v</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.kserve.steps.kserve_deployer.TorchServeParameters.handler_validate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">handler_validate</span><span class="p">(</span><span class="n">v</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Validate handler.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>v</code></td>
        <td><code>str</code></td>
        <td><p>handler file path</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>handler file path</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>if handler file path is not valid</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/steps/kserve_deployer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;handler&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">handler_validate</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate handler.</span>

<span class="sd">    Args:</span>
<span class="sd">        v: handler file path</span>

<span class="sd">    Returns:</span>
<span class="sd">        handler file path</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: if handler file path is not valid</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">TORCH_HANDLERS</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">v</span>
        <span class="k">elif</span> <span class="n">Client</span><span class="o">.</span><span class="n">is_inside_repository</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">v</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Handler must be one of the TorchServe handlers&quot;</span><span class="p">,</span>
                <span class="s2">&quot;or a file that exists inside the repository.&quot;</span><span class="p">,</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Handler is required.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.kserve.steps.kserve_deployer.TorchServeParameters.model_class_validate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">model_class_validate</span><span class="p">(</span><span class="n">v</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Validate model class file path.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>v</code></td>
        <td><code>str</code></td>
        <td><p>model class file path</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>model class file path</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>if model class file path is not valid</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/steps/kserve_deployer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;model_class&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">model_class_validate</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate model class file path.</span>

<span class="sd">    Args:</span>
<span class="sd">        v: model class file path</span>

<span class="sd">    Returns:</span>
<span class="sd">        model class file path</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: if model class file path is not valid</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Model class file path is required.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">Client</span><span class="o">.</span><span class="n">is_inside_repository</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Model class file path must be inside the repository.&quot;</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">v</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.kserve.steps.kserve_deployer.TorchServeParameters.torch_config_validate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">torch_config_validate</span><span class="p">(</span><span class="n">v</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>Validate torch config file.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>v</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>torch config file path</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[str]</code></td>
      <td><p>torch config file path</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>if torch config file path is not valid.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/steps/kserve_deployer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;torch_config&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">torch_config_validate</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate torch config file.</span>

<span class="sd">    Args:</span>
<span class="sd">        v: torch config file path</span>

<span class="sd">    Returns:</span>
<span class="sd">        torch config file path</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: if torch config file path is not valid.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">Client</span><span class="o">.</span><span class="n">is_inside_repository</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">v</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Torch config file path must be inside the repository.&quot;</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">v</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="zenml.integrations.kserve.steps.kserve_deployer.kserve_custom_model_deployer_step" class="doc doc-heading">
        <code>
kserve_custom_model_deployer_step            (<span title="zenml.steps.step_decorator._DecoratedStep">_DecoratedStep</span>)
        </code>



</h5>

    <div class="doc doc-contents ">

      <p>KServe custom model deployer pipeline step.</p>
<p>This step can be used in a pipeline to implement the
process required to deploy a custom model with KServe.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>deploy_decision</code></td>
        <td></td>
        <td><p>whether to deploy the model or not</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>params</code></td>
        <td></td>
        <td><p>parameters for the deployer step</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>model</code></td>
        <td></td>
        <td><p>the model artifact to deploy</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>context</code></td>
        <td></td>
        <td><p>the step context</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>if the custom deployer parameters is not defined</p></td>
      </tr>
      <tr>
        <td><code>DoesNotExistException</code></td>
        <td><p>if no active stack is found</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td></td>
      <td><p>KServe deployment service</p></td>
    </tr>
  </tbody>
</table>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.kserve.steps.kserve_deployer.kserve_custom_model_deployer_step.entrypoint" class="doc doc-heading">
<code class="highlight language-python"><span class="n">entrypoint</span><span class="p">(</span><span class="n">deploy_decision</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>KServe custom model deployer pipeline step.</p>
<p>This step can be used in a pipeline to implement the
process required to deploy a custom model with KServe.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>deploy_decision</code></td>
        <td><code>bool</code></td>
        <td><p>whether to deploy the model or not</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>params</code></td>
        <td><code>KServeDeployerStepParameters</code></td>
        <td><p>parameters for the deployer step</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>model</code></td>
        <td><code>UnmaterializedArtifact</code></td>
        <td><p>the model artifact to deploy</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>context</code></td>
        <td><code>StepContext</code></td>
        <td><p>the step context</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>if the custom deployer parameters is not defined</p></td>
      </tr>
      <tr>
        <td><code>DoesNotExistException</code></td>
        <td><p>if no active stack is found</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>KServeDeploymentService</code></td>
      <td><p>KServe deployment service</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/steps/kserve_deployer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@step</span><span class="p">(</span><span class="n">enable_cache</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">extra</span><span class="o">=</span><span class="p">{</span><span class="n">KSERVE_CUSTOM_DEPLOYMENT</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="k">def</span> <span class="nf">kserve_custom_model_deployer_step</span><span class="p">(</span>
    <span class="n">deploy_decision</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">KServeDeployerStepParameters</span><span class="p">,</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">StepContext</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">UnmaterializedArtifact</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">KServeDeploymentService</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;KServe custom model deployer pipeline step.</span>

<span class="sd">    This step can be used in a pipeline to implement the</span>
<span class="sd">    process required to deploy a custom model with KServe.</span>

<span class="sd">    Args:</span>
<span class="sd">        deploy_decision: whether to deploy the model or not</span>
<span class="sd">        params: parameters for the deployer step</span>
<span class="sd">        model: the model artifact to deploy</span>
<span class="sd">        context: the step context</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: if the custom deployer parameters is not defined</span>
<span class="sd">        DoesNotExistException: if no active stack is found</span>


<span class="sd">    Returns:</span>
<span class="sd">        KServe deployment service</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># verify that a custom deployer is defined</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">params</span><span class="o">.</span><span class="n">custom_deploy_parameters</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Custom deploy parameter which contains the path of the&quot;</span><span class="p">,</span>
            <span class="s2">&quot;custom predict function is required for custom model deployment.&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># get the active model deployer</span>
    <span class="n">model_deployer</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
        <span class="n">KServeModelDeployer</span><span class="p">,</span> <span class="n">KServeModelDeployer</span><span class="o">.</span><span class="n">get_active_model_deployer</span><span class="p">()</span>
    <span class="p">)</span>

    <span class="c1"># get pipeline name, step name, run id</span>
    <span class="n">step_env</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">StepEnvironment</span><span class="p">,</span> <span class="n">Environment</span><span class="p">()[</span><span class="n">STEP_ENVIRONMENT_NAME</span><span class="p">])</span>
    <span class="n">pipeline_name</span> <span class="o">=</span> <span class="n">step_env</span><span class="o">.</span><span class="n">pipeline_name</span>
    <span class="n">run_name</span> <span class="o">=</span> <span class="n">step_env</span><span class="o">.</span><span class="n">run_name</span>
    <span class="n">step_name</span> <span class="o">=</span> <span class="n">step_env</span><span class="o">.</span><span class="n">step_name</span>

    <span class="c1"># update the step configuration with the real pipeline runtime information</span>
    <span class="n">params</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">pipeline_name</span> <span class="o">=</span> <span class="n">pipeline_name</span>
    <span class="n">params</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">run_name</span> <span class="o">=</span> <span class="n">run_name</span>
    <span class="n">params</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">pipeline_step_name</span> <span class="o">=</span> <span class="n">step_name</span>

    <span class="c1"># fetch existing services with same pipeline name, step name and</span>
    <span class="c1"># model name</span>
    <span class="n">existing_services</span> <span class="o">=</span> <span class="n">model_deployer</span><span class="o">.</span><span class="n">find_model_server</span><span class="p">(</span>
        <span class="n">pipeline_name</span><span class="o">=</span><span class="n">pipeline_name</span><span class="p">,</span>
        <span class="n">pipeline_step_name</span><span class="o">=</span><span class="n">step_name</span><span class="p">,</span>
        <span class="n">model_name</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">model_name</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># even when the deploy decision is negative if an existing model server</span>
    <span class="c1"># is not running for this pipeline/step, we still have to serve the</span>
    <span class="c1"># current model, to ensure that a model server is available at all times</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">deploy_decision</span> <span class="ow">and</span> <span class="n">existing_services</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Skipping model deployment because the model quality does not &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;meet the criteria. Reusing the last model server deployed by step &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">step_name</span><span class="si">}</span><span class="s2">&#39; and pipeline &#39;</span><span class="si">{</span><span class="n">pipeline_name</span><span class="si">}</span><span class="s2">&#39; for model &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">params</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">model_name</span><span class="si">}</span><span class="s2">&#39;...&quot;</span>
        <span class="p">)</span>
        <span class="n">service</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">KServeDeploymentService</span><span class="p">,</span> <span class="n">existing_services</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="c1"># even when the deploy decision is negative, we still need to start</span>
        <span class="c1"># the previous model server if it is no longer running, to ensure that</span>
        <span class="c1"># a model server is available at all times</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">service</span><span class="o">.</span><span class="n">is_running</span><span class="p">:</span>
            <span class="n">service</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">timeout</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">service</span>

    <span class="c1"># entrypoint for starting KServe server deployment for custom model</span>
    <span class="n">entrypoint_command</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;python&quot;</span><span class="p">,</span>
        <span class="s2">&quot;-m&quot;</span><span class="p">,</span>
        <span class="s2">&quot;zenml.integrations.kserve.custom_deployer.zenml_custom_model&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--model_name&quot;</span><span class="p">,</span>
        <span class="n">params</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">model_name</span><span class="p">,</span>
        <span class="s2">&quot;--predict_func&quot;</span><span class="p">,</span>
        <span class="n">params</span><span class="o">.</span><span class="n">custom_deploy_parameters</span><span class="o">.</span><span class="n">predict_function</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="c1"># verify if there is an active stack before starting the service</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">context</span><span class="o">.</span><span class="n">stack</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DoesNotExistException</span><span class="p">(</span>
            <span class="s2">&quot;No active stack is available. &quot;</span>
            <span class="s2">&quot;Please make sure that you have registered and set a stack.&quot;</span>
        <span class="p">)</span>

    <span class="n">image_name</span> <span class="o">=</span> <span class="n">step_env</span><span class="o">.</span><span class="n">step_run_info</span><span class="o">.</span><span class="n">get_image</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">KSERVE_DOCKER_IMAGE_KEY</span><span class="p">)</span>

    <span class="c1"># copy the model files to a new specific directory for the deployment</span>
    <span class="n">served_model_uri</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">context</span><span class="o">.</span><span class="n">get_output_artifact_uri</span><span class="p">(),</span> <span class="s2">&quot;kserve&quot;</span>
    <span class="p">)</span>
    <span class="n">fileio</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">served_model_uri</span><span class="p">)</span>
    <span class="n">io_utils</span><span class="o">.</span><span class="n">copy_dir</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">uri</span><span class="p">,</span> <span class="n">served_model_uri</span><span class="p">)</span>

    <span class="c1"># save the model artifact metadata to the YAML file and copy it to the</span>
    <span class="c1"># deployment directory</span>
    <span class="n">model_metadata_file</span> <span class="o">=</span> <span class="n">save_model_metadata</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">fileio</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span>
        <span class="n">model_metadata_file</span><span class="p">,</span>
        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">served_model_uri</span><span class="p">,</span> <span class="n">MODEL_METADATA_YAML_FILE_NAME</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="c1"># prepare the service configuration for the deployment</span>
    <span class="n">service_config</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">service_config</span><span class="o">.</span><span class="n">model_uri</span> <span class="o">=</span> <span class="n">served_model_uri</span>

    <span class="c1"># Prepare container config for custom model deployment</span>
    <span class="n">service_config</span><span class="o">.</span><span class="n">container</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">service_config</span><span class="o">.</span><span class="n">model_name</span><span class="p">,</span>
        <span class="s2">&quot;image&quot;</span><span class="p">:</span> <span class="n">image_name</span><span class="p">,</span>
        <span class="s2">&quot;command&quot;</span><span class="p">:</span> <span class="n">entrypoint_command</span><span class="p">,</span>
        <span class="s2">&quot;storage_uri&quot;</span><span class="p">:</span> <span class="n">service_config</span><span class="o">.</span><span class="n">model_uri</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="c1"># deploy the service</span>
    <span class="n">service</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
        <span class="n">KServeDeploymentService</span><span class="p">,</span>
        <span class="n">model_deployer</span><span class="o">.</span><span class="n">deploy_model</span><span class="p">(</span>
            <span class="n">service_config</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">timeout</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;KServe deployment service started and reachable at:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;    </span><span class="si">{</span><span class="n">service</span><span class="o">.</span><span class="n">prediction_url</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;    With the hostname: </span><span class="si">{</span><span class="n">service</span><span class="o">.</span><span class="n">prediction_hostname</span><span class="si">}</span><span class="s2">.&quot;</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">service</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h5 id="zenml.integrations.kserve.steps.kserve_deployer.kserve_model_deployer_step" class="doc doc-heading">
        <code>
kserve_model_deployer_step            (<span title="zenml.steps.step_decorator._DecoratedStep">_DecoratedStep</span>)
        </code>



</h5>

    <div class="doc doc-contents ">

      <p>KServe model deployer pipeline step.</p>
<p>This step can be used in a pipeline to implement continuous
deployment for an ML model with KServe.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>deploy_decision</code></td>
        <td></td>
        <td><p>whether to deploy the model or not</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>params</code></td>
        <td></td>
        <td><p>parameters for the deployer step</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>model</code></td>
        <td></td>
        <td><p>the model artifact to deploy</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>context</code></td>
        <td></td>
        <td><p>the step context</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td></td>
      <td><p>KServe deployment service</p></td>
    </tr>
  </tbody>
</table>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h6 id="zenml.integrations.kserve.steps.kserve_deployer.kserve_model_deployer_step.entrypoint" class="doc doc-heading">
<code class="highlight language-python"><span class="n">entrypoint</span><span class="p">(</span><span class="n">deploy_decision</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

</h6>

    <div class="doc doc-contents ">

      <p>KServe model deployer pipeline step.</p>
<p>This step can be used in a pipeline to implement continuous
deployment for an ML model with KServe.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>deploy_decision</code></td>
        <td><code>bool</code></td>
        <td><p>whether to deploy the model or not</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>params</code></td>
        <td><code>KServeDeployerStepParameters</code></td>
        <td><p>parameters for the deployer step</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>model</code></td>
        <td><code>UnmaterializedArtifact</code></td>
        <td><p>the model artifact to deploy</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>context</code></td>
        <td><code>StepContext</code></td>
        <td><p>the step context</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>KServeDeploymentService</code></td>
      <td><p>KServe deployment service</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/steps/kserve_deployer.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@step</span><span class="p">(</span><span class="n">enable_cache</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">kserve_model_deployer_step</span><span class="p">(</span>
    <span class="n">deploy_decision</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">KServeDeployerStepParameters</span><span class="p">,</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">StepContext</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">UnmaterializedArtifact</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">KServeDeploymentService</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;KServe model deployer pipeline step.</span>

<span class="sd">    This step can be used in a pipeline to implement continuous</span>
<span class="sd">    deployment for an ML model with KServe.</span>

<span class="sd">    Args:</span>
<span class="sd">        deploy_decision: whether to deploy the model or not</span>
<span class="sd">        params: parameters for the deployer step</span>
<span class="sd">        model: the model artifact to deploy</span>
<span class="sd">        context: the step context</span>

<span class="sd">    Returns:</span>
<span class="sd">        KServe deployment service</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">model_deployer</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
        <span class="n">KServeModelDeployer</span><span class="p">,</span> <span class="n">KServeModelDeployer</span><span class="o">.</span><span class="n">get_active_model_deployer</span><span class="p">()</span>
    <span class="p">)</span>

    <span class="c1"># get pipeline name, step name and run id</span>
    <span class="n">step_env</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">StepEnvironment</span><span class="p">,</span> <span class="n">Environment</span><span class="p">()[</span><span class="n">STEP_ENVIRONMENT_NAME</span><span class="p">])</span>
    <span class="n">pipeline_name</span> <span class="o">=</span> <span class="n">step_env</span><span class="o">.</span><span class="n">pipeline_name</span>
    <span class="n">run_name</span> <span class="o">=</span> <span class="n">step_env</span><span class="o">.</span><span class="n">run_name</span>
    <span class="n">step_name</span> <span class="o">=</span> <span class="n">step_env</span><span class="o">.</span><span class="n">step_name</span>

    <span class="c1"># update the step configuration with the real pipeline runtime information</span>
    <span class="n">params</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">pipeline_name</span> <span class="o">=</span> <span class="n">pipeline_name</span>
    <span class="n">params</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">run_name</span> <span class="o">=</span> <span class="n">run_name</span>
    <span class="n">params</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">pipeline_step_name</span> <span class="o">=</span> <span class="n">step_name</span>

    <span class="c1"># fetch existing services with same pipeline name, step name and</span>
    <span class="c1"># model name</span>
    <span class="n">existing_services</span> <span class="o">=</span> <span class="n">model_deployer</span><span class="o">.</span><span class="n">find_model_server</span><span class="p">(</span>
        <span class="n">pipeline_name</span><span class="o">=</span><span class="n">pipeline_name</span><span class="p">,</span>
        <span class="n">pipeline_step_name</span><span class="o">=</span><span class="n">step_name</span><span class="p">,</span>
        <span class="n">model_name</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">model_name</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># even when the deploy decision is negative if an existing model server</span>
    <span class="c1"># is not running for this pipeline/step, we still have to serve the</span>
    <span class="c1"># current model, to ensure that a model server is available at all times</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">deploy_decision</span> <span class="ow">and</span> <span class="n">existing_services</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Skipping model deployment because the model quality does not &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;meet the criteria. Reusing the last model server deployed by step &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">step_name</span><span class="si">}</span><span class="s2">&#39; and pipeline &#39;</span><span class="si">{</span><span class="n">pipeline_name</span><span class="si">}</span><span class="s2">&#39; for model &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">params</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">model_name</span><span class="si">}</span><span class="s2">&#39;...&quot;</span>
        <span class="p">)</span>
        <span class="n">service</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">KServeDeploymentService</span><span class="p">,</span> <span class="n">existing_services</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="c1"># even when the deploy decision is negative, we still need to start</span>
        <span class="c1"># the previous model server if it is no longer running, to ensure that</span>
        <span class="c1"># a model server is available at all times</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">service</span><span class="o">.</span><span class="n">is_running</span><span class="p">:</span>
            <span class="n">service</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">timeout</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">service</span>

    <span class="c1"># invoke the KServe model deployer to create a new service</span>
    <span class="c1"># or update an existing one that was previously deployed for the same</span>
    <span class="c1"># model</span>
    <span class="k">if</span> <span class="n">params</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">predictor</span> <span class="o">==</span> <span class="s2">&quot;pytorch&quot;</span><span class="p">:</span>
        <span class="c1"># import the prepare function from the step utils</span>
        <span class="kn">from</span> <span class="nn">zenml.integrations.kserve.steps.kserve_step_utils</span> <span class="kn">import</span> <span class="p">(</span>
            <span class="n">prepare_torch_service_config</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># prepare the service config</span>
        <span class="n">service_config</span> <span class="o">=</span> <span class="n">prepare_torch_service_config</span><span class="p">(</span>
            <span class="n">model_uri</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">uri</span><span class="p">,</span>
            <span class="n">output_artifact_uri</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">get_output_artifact_uri</span><span class="p">(),</span>
            <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># import the prepare function from the step utils</span>
        <span class="kn">from</span> <span class="nn">zenml.integrations.kserve.steps.kserve_step_utils</span> <span class="kn">import</span> <span class="p">(</span>
            <span class="n">prepare_service_config</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># prepare the service config</span>
        <span class="n">service_config</span> <span class="o">=</span> <span class="n">prepare_service_config</span><span class="p">(</span>
            <span class="n">model_uri</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">uri</span><span class="p">,</span>
            <span class="n">output_artifact_uri</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">get_output_artifact_uri</span><span class="p">(),</span>
            <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="n">service</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
        <span class="n">KServeDeploymentService</span><span class="p">,</span>
        <span class="n">model_deployer</span><span class="o">.</span><span class="n">deploy_model</span><span class="p">(</span>
            <span class="n">service_config</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">timeout</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;KServe deployment service started and reachable at:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;    </span><span class="si">{</span><span class="n">service</span><span class="o">.</span><span class="n">prediction_url</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;    With the hostname: </span><span class="si">{</span><span class="n">service</span><span class="o">.</span><span class="n">prediction_hostname</span><span class="si">}</span><span class="s2">.&quot;</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">service</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>







  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h4 id="zenml.integrations.kserve.steps.kserve_step_utils" class="doc doc-heading">
        <code>kserve_step_utils</code>



</h4>

    <div class="doc doc-contents ">

      <p>Utility functions used by the KServe deployer step.</p>



  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h5 id="zenml.integrations.kserve.steps.kserve_step_utils.TorchModelArchiver" class="doc doc-heading">
        <code>
TorchModelArchiver            (<span title="pydantic.main.BaseModel">BaseModel</span>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-model"><code>pydantic-model</code></small>
  </span>

</h5>

    <div class="doc doc-contents ">

      <p>Model Archiver for PyTorch models.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>model_name</code></td>
        <td><code>str</code></td>
        <td><p>Model name.</p></td>
      </tr>
      <tr>
        <td><code>model_version</code></td>
        <td></td>
        <td><p>Model version.</p></td>
      </tr>
      <tr>
        <td><code>serialized_file</code></td>
        <td><code>str</code></td>
        <td><p>Serialized model file.</p></td>
      </tr>
      <tr>
        <td><code>handler</code></td>
        <td><code>str</code></td>
        <td><p>TorchServe's handler file to handle custom TorchServe inference logic.</p></td>
      </tr>
      <tr>
        <td><code>extra_files</code></td>
        <td><code>Optional[List[str]]</code></td>
        <td><p>Comma separated path to extra dependency files.</p></td>
      </tr>
      <tr>
        <td><code>requirements_file</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Path to requirements file.</p></td>
      </tr>
      <tr>
        <td><code>export_path</code></td>
        <td><code>str</code></td>
        <td><p>Path to export model.</p></td>
      </tr>
      <tr>
        <td><code>runtime</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Runtime of the model.</p></td>
      </tr>
      <tr>
        <td><code>force</code></td>
        <td><code>Optional[bool]</code></td>
        <td><p>Force export of the model.</p></td>
      </tr>
      <tr>
        <td><code>archive_format</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Archive format.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/steps/kserve_step_utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">TorchModelArchiver</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Model Archiver for PyTorch models.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        model_name: Model name.</span>
<span class="sd">        model_version: Model version.</span>
<span class="sd">        serialized_file: Serialized model file.</span>
<span class="sd">        handler: TorchServe&#39;s handler file to handle custom TorchServe inference logic.</span>
<span class="sd">        extra_files: Comma separated path to extra dependency files.</span>
<span class="sd">        requirements_file: Path to requirements file.</span>
<span class="sd">        export_path: Path to export model.</span>
<span class="sd">        runtime: Runtime of the model.</span>
<span class="sd">        force: Force export of the model.</span>
<span class="sd">        archive_format: Archive format.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">serialized_file</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">model_file</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">handler</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">export_path</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">extra_files</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">version</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">requirements_file</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">runtime</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;python&quot;</span>
    <span class="n">force</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">archive_format</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">
























  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h5 id="zenml.integrations.kserve.steps.kserve_step_utils.generate_model_deployer_config" class="doc doc-heading">
<code class="highlight language-python"><span class="n">generate_model_deployer_config</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="n">directory</span><span class="p">)</span></code>


</h5>

    <div class="doc doc-contents ">

      <p>Generate a model deployer config.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>model_name</code></td>
        <td><code>str</code></td>
        <td><p>the name of the model</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>directory</code></td>
        <td><code>str</code></td>
        <td><p>the directory where the model is stored</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>None</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/steps/kserve_step_utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">generate_model_deployer_config</span><span class="p">(</span>
    <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate a model deployer config.</span>

<span class="sd">    Args:</span>
<span class="sd">        model_name: the name of the model</span>
<span class="sd">        directory: the directory where the model is stored</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config_lines</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;inference_address=http://0.0.0.0:8085&quot;</span><span class="p">,</span>
        <span class="s2">&quot;management_address=http://0.0.0.0:8085&quot;</span><span class="p">,</span>
        <span class="s2">&quot;metrics_address=http://0.0.0.0:8082&quot;</span><span class="p">,</span>
        <span class="s2">&quot;grpc_inference_port=7070&quot;</span><span class="p">,</span>
        <span class="s2">&quot;grpc_management_port=7071&quot;</span><span class="p">,</span>
        <span class="s2">&quot;enable_metrics_api=true&quot;</span><span class="p">,</span>
        <span class="s2">&quot;metrics_format=prometheus&quot;</span><span class="p">,</span>
        <span class="s2">&quot;number_of_netty_threads=4&quot;</span><span class="p">,</span>
        <span class="s2">&quot;job_queue_size=10&quot;</span><span class="p">,</span>
        <span class="s2">&quot;enable_envvars_config=true&quot;</span><span class="p">,</span>
        <span class="s2">&quot;install_py_dep_per_model=true&quot;</span><span class="p">,</span>
        <span class="s2">&quot;model_store=/mnt/models/model-store&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">(</span>
        <span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;.properties&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;w+&quot;</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="n">directory</span><span class="p">,</span> <span class="n">delete</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">config_lines</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;model_snapshot=</span><span class="se">{{</span><span class="s1">&quot;name&quot;:&quot;startup.cfg&quot;,&quot;modelCount&quot;:1,&quot;models&quot;:</span><span class="se">{{</span><span class="s1">&quot;</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s1">&quot;:</span><span class="se">{{</span><span class="s1">&quot;1.0&quot;:</span><span class="se">{{</span><span class="s1">&quot;defaultVersion&quot;:true,&quot;marName&quot;:&quot;</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s1">.mar&quot;,&quot;minWorkers&quot;:1,&quot;maxWorkers&quot;:5,&quot;batchSize&quot;:1,&quot;maxBatchDelay&quot;:10,&quot;responseTimeout&quot;:120</span><span class="se">}}}}}}}}</span><span class="s1">&#39;</span>
        <span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="zenml.integrations.kserve.steps.kserve_step_utils.is_valid_model_name" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_valid_model_name</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span></code>


</h5>

    <div class="doc doc-contents ">

      <p>Checks if the model name is valid.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>model_name</code></td>
        <td><code>str</code></td>
        <td><p>the model name to check</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>bool</code></td>
      <td><p>True if the model name is valid, False otherwise.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/steps/kserve_step_utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">is_valid_model_name</span><span class="p">(</span><span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks if the model name is valid.</span>

<span class="sd">    Args:</span>
<span class="sd">        model_name: the model name to check</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if the model name is valid, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;^[a-z0-9-]+$&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pattern</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="zenml.integrations.kserve.steps.kserve_step_utils.prepare_service_config" class="doc doc-heading">
<code class="highlight language-python"><span class="n">prepare_service_config</span><span class="p">(</span><span class="n">model_uri</span><span class="p">,</span> <span class="n">output_artifact_uri</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></code>


</h5>

    <div class="doc doc-contents ">

      <p>Prepare the model files for model serving.</p>
<p>This function ensures that the model files are in the correct format
and file structure required by the KServe server implementation
used for model serving.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>model_uri</code></td>
        <td><code>str</code></td>
        <td><p>the URI of the model artifact being served</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>output_artifact_uri</code></td>
        <td><code>str</code></td>
        <td><p>the URI of the output artifact</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>params</code></td>
        <td><code>KServeDeployerStepParameters</code></td>
        <td><p>the KServe deployer step parameters</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>KServeDeploymentConfig</code></td>
      <td><p>The URL to the model is ready for serving.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>RuntimeError</code></td>
        <td><p>if the model files cannot be prepared.</p></td>
      </tr>
      <tr>
        <td><code>ValidationError</code></td>
        <td><p>if the model name is invalid.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/steps/kserve_step_utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">prepare_service_config</span><span class="p">(</span>
    <span class="n">model_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">output_artifact_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">KServeDeployerStepParameters</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">KServeDeploymentConfig</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prepare the model files for model serving.</span>

<span class="sd">    This function ensures that the model files are in the correct format</span>
<span class="sd">    and file structure required by the KServe server implementation</span>
<span class="sd">    used for model serving.</span>

<span class="sd">    Args:</span>
<span class="sd">        model_uri: the URI of the model artifact being served</span>
<span class="sd">        output_artifact_uri: the URI of the output artifact</span>
<span class="sd">        params: the KServe deployer step parameters</span>

<span class="sd">    Returns:</span>
<span class="sd">        The URL to the model is ready for serving.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: if the model files cannot be prepared.</span>
<span class="sd">        ValidationError: if the model name is invalid.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">served_model_uri</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_artifact_uri</span><span class="p">,</span> <span class="s2">&quot;kserve&quot;</span><span class="p">)</span>
    <span class="n">fileio</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">served_model_uri</span><span class="p">)</span>

    <span class="c1"># TODO [ENG-773]: determine how to formalize how models are organized into</span>
    <span class="c1">#   folders and sub-folders depending on the model type/format and the</span>
    <span class="c1">#   KServe protocol used to serve the model.</span>

    <span class="c1"># TODO [ENG-791]: an auto-detect built-in KServe server implementation</span>
    <span class="c1">#   from the model artifact type</span>

    <span class="c1"># TODO [ENG-792]: validate the model artifact type against the</span>
    <span class="c1">#   supported built-in KServe server implementations</span>
    <span class="k">if</span> <span class="n">params</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">predictor</span> <span class="o">==</span> <span class="s2">&quot;tensorflow&quot;</span><span class="p">:</span>
        <span class="c1"># the TensorFlow server expects model artifacts to be</span>
        <span class="c1"># stored in numbered subdirectories, each representing a model</span>
        <span class="c1"># version</span>
        <span class="n">served_model_uri</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">served_model_uri</span><span class="p">,</span>
            <span class="n">params</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">predictor</span><span class="p">,</span>
            <span class="n">params</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">model_name</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">fileio</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">served_model_uri</span><span class="p">)</span>
        <span class="n">io_utils</span><span class="o">.</span><span class="n">copy_dir</span><span class="p">(</span><span class="n">model_uri</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">served_model_uri</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">params</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">predictor</span> <span class="o">==</span> <span class="s2">&quot;sklearn&quot;</span><span class="p">:</span>
        <span class="c1"># the sklearn server expects model artifacts to be</span>
        <span class="c1"># stored in a file called model.joblib</span>
        <span class="n">model_uri</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">model_uri</span><span class="p">,</span> <span class="s2">&quot;model&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileio</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">model_uri</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Expected sklearn model artifact was not found at &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model_uri</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="n">served_model_uri</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">served_model_uri</span><span class="p">,</span>
            <span class="n">params</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">predictor</span><span class="p">,</span>
            <span class="n">params</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">model_name</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">fileio</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">served_model_uri</span><span class="p">)</span>
        <span class="n">fileio</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">model_uri</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">served_model_uri</span><span class="p">,</span> <span class="s2">&quot;model.joblib&quot;</span><span class="p">))</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">is_valid_model_name</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">model_name</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Model name &#39;</span><span class="si">{</span><span class="n">params</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">model_name</span><span class="si">}</span><span class="s2">&#39; is invalid. &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;The model name can only include lowercase alphanumeric &quot;</span>
            <span class="s2">&quot;characters and hyphens. Please rename your model and try again.&quot;</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># default treatment for all other server implementations is to</span>
        <span class="c1"># simply reuse the model from the artifact store path where it</span>
        <span class="c1"># is originally stored</span>
        <span class="n">served_model_uri</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">served_model_uri</span><span class="p">,</span>
            <span class="n">params</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">predictor</span><span class="p">,</span>
            <span class="n">params</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">model_name</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">fileio</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">served_model_uri</span><span class="p">)</span>
        <span class="n">fileio</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">model_uri</span><span class="p">,</span> <span class="n">served_model_uri</span><span class="p">)</span>

    <span class="n">service_config</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">service_config</span><span class="o">.</span><span class="n">model_uri</span> <span class="o">=</span> <span class="n">served_model_uri</span>
    <span class="k">return</span> <span class="n">service_config</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h5 id="zenml.integrations.kserve.steps.kserve_step_utils.prepare_torch_service_config" class="doc doc-heading">
<code class="highlight language-python"><span class="n">prepare_torch_service_config</span><span class="p">(</span><span class="n">model_uri</span><span class="p">,</span> <span class="n">output_artifact_uri</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></code>


</h5>

    <div class="doc doc-contents ">

      <p>Prepare the PyTorch model files for model serving.</p>
<p>This function ensures that the model files are in the correct format
and file structure required by the KServe server implementation
used for model serving.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>model_uri</code></td>
        <td><code>str</code></td>
        <td><p>the URI of the model artifact being served</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>output_artifact_uri</code></td>
        <td><code>str</code></td>
        <td><p>the URI of the output artifact</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>params</code></td>
        <td><code>KServeDeployerStepParameters</code></td>
        <td><p>the KServe deployer step parameters</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>KServeDeploymentConfig</code></td>
      <td><p>The URL to the model is ready for serving.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>RuntimeError</code></td>
        <td><p>if the model files cannot be prepared.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>zenml/integrations/kserve/steps/kserve_step_utils.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">prepare_torch_service_config</span><span class="p">(</span>
    <span class="n">model_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">output_artifact_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">KServeDeployerStepParameters</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">KServeDeploymentConfig</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prepare the PyTorch model files for model serving.</span>

<span class="sd">    This function ensures that the model files are in the correct format</span>
<span class="sd">    and file structure required by the KServe server implementation</span>
<span class="sd">    used for model serving.</span>

<span class="sd">    Args:</span>
<span class="sd">        model_uri: the URI of the model artifact being served</span>
<span class="sd">        output_artifact_uri: the URI of the output artifact</span>
<span class="sd">        params: the KServe deployer step parameters</span>

<span class="sd">    Returns:</span>
<span class="sd">        The URL to the model is ready for serving.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: if the model files cannot be prepared.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">deployment_folder_uri</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_artifact_uri</span><span class="p">,</span> <span class="s2">&quot;kserve&quot;</span><span class="p">)</span>
    <span class="n">served_model_uri</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">deployment_folder_uri</span><span class="p">,</span> <span class="s2">&quot;model-store&quot;</span><span class="p">)</span>
    <span class="n">config_properties_uri</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">deployment_folder_uri</span><span class="p">,</span> <span class="s2">&quot;config&quot;</span><span class="p">)</span>
    <span class="n">fileio</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">served_model_uri</span><span class="p">)</span>
    <span class="n">fileio</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">config_properties_uri</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">params</span><span class="o">.</span><span class="n">torch_serve_parameters</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;No torch serve parameters provided&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Create a temporary folder</span>
        <span class="n">temp_dir</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;zenml-pytorch-temp-&quot;</span><span class="p">)</span>
        <span class="n">tmp_model_uri</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">temp_dir</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">params</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">model_name</span><span class="si">}</span><span class="s2">.pt&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Copy from artifact store to temporary file</span>
        <span class="n">fileio</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model_uri</span><span class="si">}</span><span class="s2">/checkpoint.pt&quot;</span><span class="p">,</span> <span class="n">tmp_model_uri</span><span class="p">)</span>

        <span class="n">torch_archiver_args</span> <span class="o">=</span> <span class="n">TorchModelArchiver</span><span class="p">(</span>
            <span class="n">model_name</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">model_name</span><span class="p">,</span>
            <span class="n">serialized_file</span><span class="o">=</span><span class="n">tmp_model_uri</span><span class="p">,</span>
            <span class="n">model_file</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">torch_serve_parameters</span><span class="o">.</span><span class="n">model_class</span><span class="p">,</span>
            <span class="n">handler</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">torch_serve_parameters</span><span class="o">.</span><span class="n">handler</span><span class="p">,</span>
            <span class="n">export_path</span><span class="o">=</span><span class="n">temp_dir</span><span class="p">,</span>
            <span class="n">version</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">torch_serve_parameters</span><span class="o">.</span><span class="n">model_version</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">manifest</span> <span class="o">=</span> <span class="n">ModelExportUtils</span><span class="o">.</span><span class="n">generate_manifest_json</span><span class="p">(</span><span class="n">torch_archiver_args</span><span class="p">)</span>
        <span class="n">package_model</span><span class="p">(</span><span class="n">torch_archiver_args</span><span class="p">,</span> <span class="n">manifest</span><span class="o">=</span><span class="n">manifest</span><span class="p">)</span>

        <span class="c1"># Copy from temporary file to artifact store</span>
        <span class="n">archived_model_uri</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">temp_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">params</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">model_name</span><span class="si">}</span><span class="s2">.mar&quot;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">fileio</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">archived_model_uri</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Expected torch archived model artifact was not found at &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">archived_model_uri</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Copy the torch model archive artifact to the model store</span>
        <span class="n">fileio</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span>
            <span class="n">archived_model_uri</span><span class="p">,</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">served_model_uri</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">params</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">model_name</span><span class="si">}</span><span class="s2">.mar&quot;</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># Get or Generate the config file</span>
        <span class="k">if</span> <span class="n">params</span><span class="o">.</span><span class="n">torch_serve_parameters</span><span class="o">.</span><span class="n">torch_config</span><span class="p">:</span>
            <span class="c1"># Copy the torch model config to the model store</span>
            <span class="n">fileio</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span>
                <span class="n">params</span><span class="o">.</span><span class="n">torch_serve_parameters</span><span class="o">.</span><span class="n">torch_config</span><span class="p">,</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">config_properties_uri</span><span class="p">,</span> <span class="s2">&quot;config.properties&quot;</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Generate the config file</span>
            <span class="n">config_file_uri</span> <span class="o">=</span> <span class="n">generate_model_deployer_config</span><span class="p">(</span>
                <span class="n">model_name</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">model_name</span><span class="p">,</span>
                <span class="n">directory</span><span class="o">=</span><span class="n">temp_dir</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="c1"># Copy the torch model config to the model store</span>
            <span class="n">fileio</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span>
                <span class="n">config_file_uri</span><span class="p">,</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">config_properties_uri</span><span class="p">,</span> <span class="s2">&quot;config.properties&quot;</span><span class="p">),</span>
            <span class="p">)</span>

    <span class="n">service_config</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">service_config</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">service_config</span><span class="o">.</span><span class="n">model_uri</span> <span class="o">=</span> <span class="n">deployment_folder_uri</span>
    <span class="k">return</span> <span class="n">service_config</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>




  </div>

    </div>

  </div>




  </div>

    </div>

  </div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../integrations-kaniko/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Kaniko" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Kaniko
            </div>
          </div>
        </a>
      
      
        
        <a href="../integrations-kubeflow/" class="md-footer__link md-footer__link--next" aria-label="Next: Kubeflow" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Kubeflow
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022 ZenML GmbH – <a href="#__consent">Change cookie settings</a>

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            


  
    
  




<h4>This website uses cookies</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="github" checked>
          <span class="task-list-indicator"></span>
          GitHub
        <label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
      <button type="reset" class="md-button md-button--primary">Reject</button>
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.5a2dcb6a.min.js"></script>
      
    
    
  </body>
</html>